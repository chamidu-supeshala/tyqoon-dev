"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[2495],{35482:(U,P,t)=>{t.d(P,{s:()=>M});var p=t(92340),e=t(39646),g=t(54004),O=t(24056),E=t(94650),T=t(80529),b=t(94830);let M=(()=>{class c{constructor(i,s){this.http=i,this.productsQueryStorage={},s.loginStateChange.subscribe(()=>{this.productsQueryStorage={}})}getProductsByMetaParams(i){const s=JSON.stringify(i);return this.productsQueryStorage[s]?(0,e.of)(this.productsQueryStorage[s]):this.http.get(`${p.N.BASE_URL}/shop/product/query`,{params:{...i}}).pipe((0,g.U)(({data:r})=>{const f={...r,rows:r.rows.map(h=>({...h,productImages:(0,O.x5)(h.productImages)})),total:r.rows.length?r.total:0};return this.productsQueryStorage[s]=f,f}))}getProductsByMetaParamsV2(i){const s=JSON.stringify(i);return this.productsQueryStorage[s]?(0,e.of)(this.productsQueryStorage[s]):this.http.get(`${p.N.BASE_URL}/shop/product/queryESV2`,{params:{...i}}).pipe((0,g.U)(({data:r})=>{const f=r?.rows||[],h={...r,rows:f.map(C=>({...C,productImages:(0,O.x5)(C.productImages)})),total:f.length?r.total:0};return this.productsQueryStorage[s]=h,h}))}getProductById(i){return this.http.get(`${p.N.BASE_URL}/shop/product/queryESV2`,{params:{rows:1,page:0,productId:i}}).pipe((0,g.U)(({data:s})=>({...s.rows[0],productImages:(0,O.x5)(s.rows[0]?.productImages||"[]")})))}getProductReview(i,s,r=0,f=3){return this.http.get(`${p.N.BASE_URL}/shop/product/queryReview`,{params:{rows:f,page:r,productId:i,scoreType:s}}).pipe((0,g.U)(h=>h.data))}getSkusByProductId(i){return this.http.get(`${p.N.BASE_URL}/shop/product/querySkuByProductId`,{params:{productId:i}}).pipe((0,g.U)(({data:s})=>s.map(r=>({...r,specifications:JSON.parse(r.specificationValues||"[]")}))))}getSkuById(i){return this.http.get(`${p.N.BASE_URL}/shop/product/querySkuById`,{params:{skuId:i.join(",")}}).pipe((0,g.U)(({data:s})=>s.map(r=>({...r,specifications:JSON.parse(r.specificationValues||"[]")}))))}getBrandById(i){return this.http.get(`${p.N.BASE_URL}/shop/brand/queryById`,{params:{id:i}}).pipe((0,g.U)(s=>s.data))}}return c.\u0275fac=function(i){return new(i||c)(E.LFG(T.eN),E.LFG(b.K))},c.\u0275prov=E.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},81189:(U,P,t)=>{t.d(P,{N:()=>Z});var p=t(15861),e=t(94650),g=t(5565),O=t(87692),E=t(94830),T=t(13055),b=t(24006),M=t(95133),c=t(36895),y=t(99605),i=t(71034),s=t(14903),r=t(54463);function f(_,v){if(1&_&&(e.TgZ(0,"div",30)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&_){const o=v.ngIf;e.xp6(2),e.hij(" ",e.lcZ(3,2,"available-balance")," "),e.xp6(3),e.hij(" \uffe5",e.xi3(6,4,(null==o.user?null:o.user.balance)||0,"1.2-2")," ")}}const h=function(_){return{user:_}};function C(_,v){if(1&_){const o=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e._UZ(2,"img",8),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"button",9),e.NdJ("click",function(){e.CHM(o),e.oxw();const d=e.MAs(1);return e.KtG(d.dismiss())}),e.O4$(),e.TgZ(7,"svg",10),e._UZ(8,"path",11),e.qZA()()(),e.kcU(),e.TgZ(9,"div",12)(10,"div",13),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",14)(14,"div",15)(15,"div",16),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",17),e._UZ(19,"img",18),e.TgZ(20,"ion-input",19),e.NdJ("ngModelChange",function(d){e.CHM(o);const u=e.oxw();return e.KtG(u.amount=d)})("ionChange",function(d){e.CHM(o);const u=e.oxw();return e.KtG(u.handleChange(d))}),e.qZA()(),e.YNc(21,f,7,7,"div",20),e.ALo(22,"async"),e.qZA(),e.TgZ(23,"div",21)(24,"div",22)(25,"app-send-assets",23),e.NdJ("onCloseAllModals",function(){e.CHM(o),e.oxw();const d=e.MAs(1);return e.KtG(d.dismiss())}),e.qZA()(),e.TgZ(26,"button",24),e.NdJ("click",function(){e.CHM(o);const d=e.oxw(),u=e.MAs(1);return e.KtG(d.handleOpenPaymentModal(u))}),e._UZ(27,"app-download-icon",25),e.TgZ(28,"span",26),e._uU(29),e.ALo(30,"translate"),e.qZA()()()(),e.TgZ(31,"div",27)(32,"button",28),e.NdJ("click",function(){e.CHM(o),e.oxw();const d=e.MAs(1);return e.KtG(d.dismiss())}),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.TgZ(35,"button",29),e.NdJ("click",function(){e.CHM(o);const d=e.oxw(),u=e.MAs(1);return e.KtG(d.handleOpenRedeemModal(u))}),e._uU(36),e.ALo(37,"translate"),e.qZA()()()}if(2&_){const o=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,11,"store-credits-title")),e.xp6(7),e.hij(" ",e.lcZ(12,13,"deposit-store-credit-to-use-on-the-tyqoon-shop")," "),e.xp6(5),e.hij(" ",e.lcZ(17,15,"deposit-amount")," "),e.xp6(4),e.Q6J("ngModel",o.amount)("min",0),e.xp6(1),e.Q6J("ngIf",e.VKq(25,h,e.lcZ(22,17,o.userService.userInfo$))),e.xp6(4),e.Q6J("assetType",o.sendAssetsType),e.xp6(1),e.Q6J("disabled",o.amount<=0),e.xp6(3),e.hij(" ",e.lcZ(30,19,"deposit")," "),e.xp6(4),e.hij(" ",e.lcZ(34,21,"close")," "),e.xp6(3),e.hij(" ",e.lcZ(37,23,"store-credit-redeem-code-modal-button")," ")}}let Z=(()=>{class _ extends g.V{constructor(o){super(),this.userService=o,this.isOpenChange=new e.vpe,this.amount=0,this.amountChange=new e.vpe,this.isOpenPaymentMethodModal=!1,this.isOpenRedeemModal=!1,this.availableBalance=0,this.sendAssetsType=O.pz.Credits}handleChange(o){this.amountChange.emit(parseFloat(o.target.value))}handleBack(){this.isOpen=!0,this.isOpenChange.emit(!0)}handleOpenPaymentModal(o){var a=this;return(0,p.Z)(function*(){a.amount<=0||(yield o.dismiss(),a.isOpenPaymentMethodModal=!0)})()}handleOpenRedeemModal(o){var a=this;return(0,p.Z)(function*(){yield o.dismiss(),a.isOpenRedeemModal=!0})()}}return _.\u0275fac=function(o){return new(o||_)(e.Y36(E.K))},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-deposit-credit-modal"]],inputs:{isOpen:"isOpen",amount:"amount"},outputs:{isOpenChange:"isOpenChange",amountChange:"amountChange"},features:[e.qOj],decls:12,vars:10,consts:[[3,"isOpen","didDismiss"],["modal",""],[3,"amount","isOpen","back","isOpenChange"],["total","",1,"flex","justify-between","font-bold","text-2xl"],[1,"mr-2"],[3,"isOpen","isOpenChange"],[1,"flex","bg-[#f4f4f4]","items-center","p-2"],[1,"fade-in-from-right","flex-1","font-bold","text-3xl","flex",2,"--duration","200ms"],["src","assets/images/cny-inverted.png","alt","Store Credits",1,"h-6","sm:h-8","mr-1","mt-[3px]","sm:mt-0.5"],[1,"w-8","p-1","rounded","cursor-pointer","bg-[#ff2145]","text-white",3,"click"],["version","1.1","viewBox","0 0 100 100","overflow","visible","enable-background","new 0 0 100 100"],["stroke","currentColor","stroke-width","12","stroke-linecap","square","d","M 10,10 90,90 M 10,90 90,10"],[1,"p-4"],[1,"font-medium"],[1,"w-full","px-1","sm:px-4","sm:w-4/5","mx-auto","mt-4","sm:mt-9"],[1,"fade-in-from-right","flex","w-full","flex-col",2,"--duration","200ms","--delay","150ms"],[1,"font-medium","mb-1"],[1,"border","border-[#dddddd]","flex","items-center","px-2","py-1","rounded-md"],["src","assets/images/cny-inverted.png","alt","",1,"h-8"],["type","number",1,"flex-1","h-10","font-bold","text-3xl","text-right",3,"ngModel","min","ngModelChange","ionChange"],["class","mt-1.5 flex w-full justify-between font-medium text-gray-500",4,"ngIf"],[1,"mt-4","flex","w-full","space-x-2"],[1,"block","fade-in-from-top","w-full",2,"--duration","200ms","--delay","150ms"],[3,"assetType","onCloseAllModals"],["appRippleEffect","",1,"fade-in-from-top","deposit-button","relative","font-medium","m-0","h-14","border-2","border-solid","rounded-md","w-full","text-white",2,"--duration","200ms","--delay","150ms",3,"disabled","click"],[1,"absolute","left-2","sm:left-6","w-6","sm:w-7","mt-1","sm:mt-0"],[1,"text-xl","xs:text-2xl","ml-5","sm:ml-7"],[1,"flex","flex-col-reverse","xs:flex-row","gap-2","xs:gap-0","justify-between","px-1","sm:px-2","mt-8","sm:mt-12","sm:mb-2"],["appRippleEffect","",1,"fade-in-from-right","close-button","px-5","w-auto","sm:w-44","font-medium","border","border-solid","rounded-md","h-14",2,"--duration","300ms","--delay","200ms",3,"click"],["appRippleEffect","",1,"fade-in-from-left","redeem-button","ml-2","flex-1","text-black","font-medium","flex","items-center","justify-center","px-4","rounded-md","h-14","capitalize",2,"--duration","300ms","--delay","300ms",3,"click"],[1,"mt-1.5","flex","w-full","justify-between","font-medium","text-gray-500"]],template:function(o,a){1&o&&(e.TgZ(0,"ion-modal",0,1),e.NdJ("didDismiss",function(){return a.isOpenChange.emit(!1)}),e.YNc(2,C,38,27,"ng-template"),e.qZA(),e.TgZ(3,"app-payment-method-modal",2),e.NdJ("back",function(){return a.handleBack()})("isOpenChange",function(u){return a.isOpenPaymentMethodModal=u}),e.TgZ(4,"div",3)(5,"div",4),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div"),e._uU(9),e.ALo(10,"currency"),e.qZA()()(),e.TgZ(11,"app-redeem-code-modal",5),e.NdJ("isOpenChange",function(u){return a.isOpenRedeemModal=u}),e.qZA()),2&o&&(e.Q6J("isOpen",a.isOpen),e.xp6(3),e.Q6J("amount",a.amount)("isOpen",a.isOpenPaymentMethodModal),e.xp6(3),e.Oqu(e.lcZ(7,6,"total")),e.xp6(3),e.Oqu(e.lcZ(10,8,a.amount)),e.xp6(2),e.Q6J("isOpen",a.isOpenRedeemModal))},dependencies:[T.U,b.JJ,b.On,M.pK,M.ki,M.as,c.O5,y.T,i.x,s.x,c.Ov,c.JJ,c.H9,r.X$],styles:["ion-modal[_ngcontent-%COMP%]{--width: 610px;--background: white;--border-radius: 15px}ion-input[_ngcontent-%COMP%]{--padding-bottom: 0px;--padding-top: 0px}ion-input[_ngcontent-%COMP%]     input{border-radius:0!important}ion-input[_ngcontent-%COMP%]     input::-webkit-outer-spin-button, ion-input[_ngcontent-%COMP%]     input::-webkit-inner-spin-button{margin-left:10px}ion-input[_ngcontent-%COMP%]     input[type=number]{-moz-appearance:textfield}app-send-assets[_ngcontent-%COMP%]     .send-button{width:100%}.deposit-button[_ngcontent-%COMP%]{border:1px solid #37ff73;background:#12c792}.redeem-button[_ngcontent-%COMP%]{background:#fbbd01;max-width:220px}@media (min-width: 640px){.redeem-button[_ngcontent-%COMP%]{max-width:260px}}.close-button[_ngcontent-%COMP%]{background-color:#d6d6eb;border-color:#b1b1c9}.close-button[_ngcontent-%COMP%], .redeem-button[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem}@media (min-width: 640px){.close-button[_ngcontent-%COMP%], .redeem-button[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem}}button[disabled][_ngcontent-%COMP%]{color:#8d8d8d;background:rgba(237,235,235,.5);border-color:#ddd;cursor:default!important}"]}),_})()},71034:(U,P,t)=>{t.d(P,{x:()=>u});var p=t(15861),e=t(94650),g=t(77579),O=t(5565),E=t(78372),T=t(71884),b=t(63900),M=t(82722),c=t(87692),y=t(80164),i=t(94830),s=t(95133),r=t(7507),f=t(59980),h=t(38461),C=t(24006),Z=t(36895),_=t(65433),v=t(54463);function o(m,D){if(1&m&&e._UZ(0,"img",24),2&m){const n=e.oxw(2);e.Q6J("src",n.giftIcon,e.LSH)}}function a(m,D){if(1&m&&e._UZ(0,"img",25),2&m){const n=e.oxw(2);e.Q6J("src",n.giftIcon,e.LSH)}}function d(m,D){if(1&m){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"img",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){e.CHM(n);const x=e.oxw();return e.KtG(x.isOpenChange.emit(!1))}),e._UZ(7,"app-close-icon",6),e.qZA()(),e.TgZ(8,"ng-scrollbar",7)(9,"div",8)(10,"p",9),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"input",10,11),e.NdJ("ngModelChange",function(x){e.CHM(n);const A=e.oxw();return e.KtG(A.inputValue=x)})("ngModelChange",function(x){e.CHM(n);const A=e.oxw();return e.KtG(A.validateCode.next(x))}),e.qZA(),e.TgZ(15,"div",12)(16,"p",13),e._uU(17),e.ALo(18,"translate"),e.qZA(),e._UZ(19,"hr",14),e.qZA(),e.TgZ(20,"div",15)(21,"p",16),e.YNc(22,o,1,1,"img",17),e._uU(23),e.qZA(),e.TgZ(24,"p",18),e._uU(25),e.ALo(26,"translate"),e.qZA()(),e.TgZ(27,"div",19)(28,"p",20),e._uU(29," TOTAL: "),e.qZA(),e.TgZ(30,"p",21),e.YNc(31,a,1,1,"img",22),e._uU(32),e.qZA()(),e.TgZ(33,"button",23),e.NdJ("click",function(){e.CHM(n);const x=e.oxw();return e.KtG(x.sendData())}),e._uU(34),e.ALo(35,"translate"),e.qZA()()()()}if(2&m){const n=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,12,"store-credit-redeem-code-modal-heading")," "),e.xp6(4),e.Q6J("autoHeightDisabled",!1),e.xp6(3),e.hij(" ",e.lcZ(12,14,"store-credit-redeem-code")," "),e.xp6(2),e.Q6J("ngModel",n.inputValue),e.xp6(4),e.hij(" ",e.lcZ(18,16,"details")," "),e.xp6(5),e.Q6J("ngIf",n.giftCodeType&&n.inputValue),e.xp6(1),e.hij(" ",n.amount||0," "),e.xp6(2),e.hij(" ",e.lcZ(26,18,"store-credit-redeem-code-modal-amount")," "),e.xp6(6),e.Q6J("ngIf",n.giftCodeType&&n.inputValue),e.xp6(1),e.hij(" ",n.amount||0," "),e.xp6(1),e.Q6J("disabled",0==n.amount||!n.amount||!n.inputValue),e.xp6(1),e.hij(" ",e.lcZ(35,20,"store-credit-redeem-code-modal-button")," ")}}let u=(()=>{class m extends O.V{constructor(n,l,x,A,R){super(),this.checkoutService=n,this.userService=l,this.toast=x,this.router=A,this.walletService=R,this.isOpenChange=new e.vpe,this.amount=0,this.loading={exchangeCode:!1},this.giftCodeType=null,this.validateCode=new g.x}get giftIcon(){return this.giftCodeType===c.pJ.Tickets?"assets/images/ticket.png":"/assets/images/cny-250px-min.png"}ngOnInit(){this.validateCode.pipe((0,E.b)(1e3),(0,T.x)(),(0,b.w)(n=>this.checkoutService.queryExchangeCodeAmount(n).pipe((0,M.R)(this.validateCode))),(0,M.R)(this.destroyStream$)).subscribe(n=>{0==n.code?(this.amount=n.data,this.giftCodeType=c.pJ.Credits):(this.giftCodeType=null,this.amount=0,this.toastError(n.message))})}toastSuccess(n){var l=this;return(0,p.Z)(function*(){yield l.presentToast({position:"bottom",message:n,duration:1e3,icon:"checkmark-circle-outline",color:"success"})})()}toastError(n){var l=this;return(0,p.Z)(function*(){yield l.presentToast({position:"bottom",message:n,icon:"alert-circle-outline",duration:1e3,color:"danger"})})()}presentToast(n){var l=this;return(0,p.Z)(function*(){yield(yield l.toast.create(n)).present()})()}sendData(){this.inputValue&&(this.loading.exchangeCode=!0,this.checkoutService.exchangeCode({code:this.inputValue}).pipe((0,M.R)(this.destroyStream$)).subscribe({next:l=>{0===l.code?(this.userService.updateUserInfo(),this.walletService.onWalletUpdate.next(!0),this.toastSuccess("\u5151\u6362\u6210\u529f"),this.isOpenChange.emit(!1)):this.toastError(l.message)},error:l=>{console.error(l)}}).add(()=>this.loading.exchangeCode=!1))}}return m.\u0275fac=function(n){return new(n||m)(e.Y36(y.Z),e.Y36(i.K),e.Y36(s.yF),e.Y36(r.F0),e.Y36(f.X))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-redeem-code-modal"]],inputs:{isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange"},features:[e.qOj],decls:2,vars:1,consts:[[3,"isOpen","didDismiss"],[1,"redeem-code-modal","flex","flex-col","rounded-[12px]","overflow-hidden"],["id","modal-header",1,"flex","items-center","bg-[#f4f4f4]","p-2","rounded-t-[12px]","w-full"],[1,"fade-in-from-right","flex-1","font-bold","text-2xl","md:text-3xl","flex","items-center",2,"--duration","200ms"],["src","assets/images/gift-new.png","alt","Gift Codes",1,"h-9","mr-2","mt-0.5","ticket-img"],[1,"rounded-[5px]","bg-[#ff2145]","p-1","ml-auto","w-[36px]","h-[36px]","flex","items-center","justify-center","outline-none",3,"click"],[1,"w-[24px]","text-white"],["visibility","hover",2,"max-height","85vh",3,"autoHeightDisabled"],["id","modal-body",1,"bg-white","w-full","h-full","px-4","pt-3","pb-5"],[1,"fade-in-from-left","font-medium","text-base","lg:text-lg","text-[#1c1c1c]",2,"--duration","200ms","--delay","100ms"],[1,"fade-in-from-top","pl-2","border","border-[#D4D4D4]","w-full","outline-none","rounded-[15px]","bg-transparent","font-bold","text-bold","h-[50px]","placeholder:text-[#1c1c1c]","text-[30px]","mb-4",2,"--duration","200ms","--delay","150ms","--distance","-50px",3,"ngModel","ngModelChange"],["redeemCodeInput",""],[1,"fade-in","flex","items-center","gap-8",2,"--duration","200ms","--delay","200ms"],[1,"font-medium","text-[14px]","lg:text-[16px]","text-[#c8c8c8]"],[1,"border-1","border-t","w-full","border-[#c8c8c8]"],[1,"fade-in","flex","items-center","justify-between","mb-2",2,"--duration","200ms","--delay","150ms"],[1,"font-bold","flex","items-center","text-[28px]","text-[#1c1c1c]"],["class","h-5 mb-px",3,"src",4,"ngIf"],[1,"font-medium","text-[14px]","lg:text-[16px]","text-[#414141]"],[1,"fade-in","flex","items-center","justify-between","mb-2","border-y","w-full","border-[#c8c8c8]","py-3",2,"--duration","200ms","--delay","100ms"],[1,"fade-in-from-left","font-medium","text-[28px]","text-[#1c1c1c]",2,"--duration","200ms","--delay","200ms"],[1,"fade-in-from-left","font-bold","flex","items-center","text-[28px]","text-[#1c1c1c]",2,"--duration","200ms","--delay","250ms"],["class","h-6 mb-px",3,"src",4,"ngIf"],["appRippleEffect","",1,"redeem-btn","mt-1.5","text-white","fade-in-from-bottom","border","border-solid","rounded-md","text-2xl","h-16","uppercase","font-medium","w-full",2,"--duration","300ms","--delay","250ms","--distance","50px",3,"disabled","click"],[1,"h-5","mb-px",3,"src"],[1,"h-6","mb-px",3,"src"]],template:function(n,l){1&n&&(e.TgZ(0,"ion-modal",0),e.NdJ("didDismiss",function(){return l.isOpenChange.emit(!1)}),e.YNc(1,d,36,22,"ng-template"),e.qZA()),2&n&&e.Q6J("isOpen",l.isOpen)},dependencies:[h.D,C.Fj,C.JJ,C.On,s.ki,Z.O5,_.KC,v.X$],styles:[".redeem-code-modal[_ngcontent-%COMP%]{width:500px;max-width:95vw}ion-button[_ngcontent-%COMP%]{--padding-top: 15px;--padding-bottom: 15px}.redeem-btn[_ngcontent-%COMP%]{background:#ff6410}.redeem-btn[_ngcontent-%COMP%]:disabled{color:#8d8d8d;background:rgba(237,235,235,.5);border-color:#ddd;cursor:default!important}"]}),m})()}}]);