"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[3284],{93379:(R,v,r)=>{r.d(v,{Nj:()=>e,T7:()=>c,j1:()=>b});var c=(()=>{return(p=c||(c={}))[p.OPEN=0]="OPEN",p[p.CLOSED=1]="CLOSED",c;var p})(),e=(()=>{return(p=e||(e={}))[p.POOL_SIZE=0]="POOL_SIZE",p[p.CREATED_DATE=1]="CREATED_DATE",p[p.LAST_MODIFIED_DATE=4]="LAST_MODIFIED_DATE",e;var p})(),b=(()=>{return(p=b||(b={}))[p.OPEN=0]="OPEN",p[p.DRAWN=1]="DRAWN",p[p.DRAWING=2]="DRAWING",p[p.NOT_STARTED=3]="NOT_STARTED",p[p.EXPIRED=4]="EXPIRED",p[p.PAUSED=5]="PAUSED",p[p.WON=6]="WON",p[p.DRAWING_START_SOON=10]="DRAWING_START_SOON",p[p.LOADING_NEXT_POOL=100]="LOADING_NEXT_POOL",p[p.ALL=-1]="ALL",b;var p})()},70325:(R,v,r)=>{r.d(v,{P:()=>tt});var c=r(15861),e=r(94650),b=r(77579),p=r(82722),T=r(78372),O=r(95698),I=r(83905),D=r(5565),A=r(93379),M=r(24837),w=r(18110),u=r(56889),t=r(45329),_=r(81212),m=r(36895),L=r(7228),B=r(54463);const N=["biddingButton"],K=["bidWrapper"];function F(d,P){1&d&&(e.TgZ(0,"div",14),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"my-entries")))}function Q(d,P){1&d&&(e.TgZ(0,"div",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"max")," "))}function Y(d,P){if(1&d&&e._uU(0),2&d){const l=e.oxw(4);e.hij(" ",l.pool.bidAmount," ")}}const j=function(d){return[d]};function J(d,P){if(1&d&&(e.TgZ(0,"div",9,10),e.YNc(2,F,3,3,"div",11),e.YNc(3,Q,3,3,"div",12),e.YNc(4,Y,1,1,"ng-template",null,13,e.W1O),e.qZA()),2&d){const l=e.MAs(5),o=e.oxw(3);e.Q6J("ngClass",e.VKq(4,j,o.pool.bidAmount>0?"font-bold":"font-medium")),e.xp6(2),e.Q6J("ngIf",!o.customBidAmount),e.xp6(1),e.Q6J("ngIf",o.pool.bidAmount>=o.pool.userMaxTickets)("ngIfElse",l)}}function z(d,P){if(1&d&&(e.ynx(0),e.YNc(1,J,6,6,"div",8),e.BQk()),2&d){const l=e.oxw(2),o=e.MAs(7);e.xp6(1),e.Q6J("ngIf",l.pool.bidAmount>0||l.customBidAmount)("ngIfElse",o)}}function $(d,P){if(1&d&&(e.ynx(0),e.YNc(1,z,2,2,"ng-container",3),e.BQk()),2&d){const l=e.oxw(),o=e.MAs(9);e.xp6(1),e.Q6J("ngIf",l.pool.currentPoolPercentage<100||l.customBidAmount)("ngIfElse",o)}}function G(d,P){if(1&d&&(e.TgZ(0,"div",16),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d){const l=e.oxw();e.ekj("closed",l.pool.currentPoolPercentage>=100),e.xp6(1),e.hij(" ",e.lcZ(2,3,l.pool.currentPoolPercentage<100?"login-to-bid":"header-login")," ")}}function q(d,P){1&d&&(e.TgZ(0,"div",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"enter-now")," "))}function H(d,P){1&d&&(e.TgZ(0,"div")(1,"div",14),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",21),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&d&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"my-entries")),e.xp6(3),e.Oqu(e.lcZ(6,4,"max")))}function V(d,P){if(1&d&&(e.TgZ(0,"div",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&d){const l=e.oxw(3);e.xp6(1),e.hij(" ",e.lcZ(2,1,l.pool.bidAmount>0?"entered-pool":"not-entered")," ")}}function X(d,P){if(1&d&&(e.TgZ(0,"div",19),e.YNc(1,H,7,6,"div",3),e.YNc(2,V,3,3,"ng-template",null,20,e.W1O),e.qZA()),2&d){const l=e.MAs(3),o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.pool.bidAmount>=o.pool.userMaxTickets)("ngIfElse",l)}}function Z(d,P){if(1&d&&e.YNc(0,X,4,2,"div",18),2&d){const l=e.oxw(),o=e.MAs(11);e.Q6J("ngIf",!l.pool.finalBidProcessing)("ngIfElse",o)}}function W(d,P){1&d&&(e.TgZ(0,"div",23),e._UZ(1,"app-loading-animation",24),e.qZA())}let tt=(()=>{class d extends D.V{constructor(l,o,i,x){super(),this.biddingService=l,this.userService=o,this.router=i,this.cdr=x,this.biddingButton=null,this.bidWrapper=null,this.isLogin=!0,this.animationTarget=null,this.disableFlyingAnimation=!1,this.isReadOnly=!1,this.customBidAmount=null,this.redirectIfFailed=!1,this.onPoolCompleted=new e.vpe,this.onPoolUpdated=new e.vpe,this.busy=!1,this.biddingClicked$=new b.x,this.bidAmount=0,this.userEnteredBidAmount=0}ngOnInit(){this.biddingClicked$.pipe((0,p.R)(this.destroyStream$),(0,T.b)(1e3)).subscribe(l=>{const o=this.bidAmount,i=this.userEnteredBidAmount;this.bidAmount=0,this.userEnteredBidAmount=0,o>0&&this.pool?.poolId&&"0"!=this.pool.poolId&&(this.biddingService.onUpdateProductCardBidAmount$.next({poolId:this.pool.poolId,bidAmount:this.pool.bidAmount,currentPoolSize:this.pool.currentPoolSize,currentPoolPercentage:this.pool.currentPoolPercentage,status:this.pool.status}),this.biddingService.onBid(o,this.pool.poolId).pipe((0,O.q)(1)).subscribe(x=>{0!==x.code&&(["GroupBuyingTicketsAreFull","CodeFailedGroupBuyingMoreThanMaxTickets"].includes(x.i18nKey)&&this.pool.bidAmount<=o?(this.biddingService.ticketCount$.next(this.biddingService.ticketCount$.getValue()-(i-o)),this.handleFailedBid(i)):(this.refundTickets(o),this.onPoolUpdated.emit(this.pool)),this.pool.bidAmount-=o),this.pool.finalBidProcessing=!1,this.pool.currentPoolPercentage>=100&&(0==x.code||this.pool.bidAmount-o>0)&&this.biddingService.selectedPool$.getValue()?.poolId==this.pool.poolId&&this.biddingService.onChangePoolTab$.next(A.T7.CLOSED)}))})}refundTickets(l){this.biddingService.ticketCount$.next(this.biddingService.ticketCount$.getValue()+l)}onBid(l,o){var i=this;return(0,c.Z)(function*(){if(!i.isLogin)return void i.router.navigateByUrl("auth/login");if(i.isReadOnly||i.busy||o.currentPoolPercentage>=100||o.bidAmount>=o.userMaxTickets)return;if(i.biddingService.ticketCount$.getValue()<=0)return void(i.biddingService.isOpenGetTicketsModal=!0);if(!i.pool.poolId)return void i.biddingService.onLaunchInitialPool$.next(i.product);i.biddingService.onBeforeBid$.next(!0),i.biddingService.setBiddingInProgressTimer(),i.busy=!0;const h=Math.min(o.poolLimit-o.currentPoolSize,o.userMaxTickets-o.bidAmount,i.customBidAmount??i.biddingService.bidAmount,i.biddingService.ticketCount$.getValue());i.userEnteredBidAmount+=Math.min(i.customBidAmount??i.biddingService.bidAmount,i.biddingService.ticketCount$.getValue()),h?(i.biddingService.animationTarget=i.animationTarget,i.biddingService.biddingClicked$.next({event:l,element:i.biddingButton?.nativeElement,offsetY:5,launchDelay:20,disableFlyingAnimation:i.disableFlyingAnimation,targetSelector:"#my-tickets-box"}),i.biddingService.trackingProduct==i.product.id&&i.biddingService.trackingPool==i.pool.poolId?i.biddingService.noOfClicks+=1:(i.biddingService.trackingProduct=i.product.id,i.biddingService.trackingPool=i.pool.poolId,i.biddingService.noOfClicks=1),o.bidAmount+=h,o.currentPoolSize+=h,o.currentPoolPercentage=(0,w.DU)(o.currentPoolSize,o.poolLimit),o.currentPoolPercentage>=100&&(o.finalBidProcessing=!0),i.bidAmount+=h,i.bidAmount>0&&0==o.currentPoolPercentage&&(o.currentPoolPercentage=1),i.biddingService.ticketCount$.next(i.biddingService.ticketCount$.getValue()-h),i.biddingClicked$.next(!0),i.busy=!1,console.log("busy",i.busy),o.currentPoolPercentage>=100&&i.onPoolCompleted.emit(i.pool),i.cdr.detectChanges()):i.busy=!1})()}animateValue(l,o,i,x,E=500){let h=null;const U=k=>{h||(h=k);const S=Math.min((k-h)/E,1);o.innerHTML=Math.floor(S*(x-i)+i),S<1&&window.requestAnimationFrame(U)};window.requestAnimationFrame(U),l.bidAmount=x}handleFailedBid(l){var o=this;l<=0||(console.log("HANDLE FAILED BID",l),this.biddingService.getProductPools({page:0,rows:10,skuId:this.product.productSkuId,status:0,sortType:A.Nj.POOL_SIZE,sortDirection:"desc"}).pipe((0,O.q)(1)).subscribe(function(){var i=(0,c.Z)(function*(x){let E=null;if(x?.rows)for(let h=0;h<x.rows.length;h++){const U=x.rows[h].id;if(0==(yield(0,I.z)(o.biddingService.onBid(l,U))).code){E=U,o.handleMissedPool(E);break}}E||(console.log("TRY 1: OPEN POOL NOT FOUND"),o.biddingService.createPoolIfNotExists({skuId:o.product.productSkuId,ticketsAmount:l}).pipe((0,O.q)(1)).subscribe(h=>{console.log("TRY 2: CREATE NEW POOL",h),0==h.code&&h.data.groupBuyingId?o.handleMissedPool(h.data.groupBuyingId.toString()):o.refundTickets(l)}))});return function(x){return i.apply(this,arguments)}}()))}handleMissedPool(l){this.redirectIfFailed&&this.router.navigate(["/product/detail"],{queryParams:{id:this.product.id,poolId:l,bid:!0}}).then(()=>{this.biddingService.onLaunchFinished$.next(!0)}),this.biddingService.onPoolMissed$.next({newPoolId:l,productId:this.product.id,showRedirectOption:!this.redirectIfFailed}),this.onPoolCompleted.next(this.pool),M.Z.isBrowser&&setTimeout(()=>{this.userService.updateUserInfo()},4e3)}}return d.\u0275fac=function(l){return new(l||d)(e.Y36(u.g),e.Y36(t.K),e.Y36(_.F0),e.Y36(e.sBO))},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-bid-button"]],viewQuery:function(l,o){if(1&l&&(e.Gf(N,5),e.Gf(K,5)),2&l){let i;e.iGM(i=e.CRH())&&(o.biddingButton=i.first),e.iGM(i=e.CRH())&&(o.bidWrapper=i.first)}},inputs:{product:"product",pool:"pool",isLogin:"isLogin",animationTarget:"animationTarget",disableFlyingAnimation:"disableFlyingAnimation",isReadOnly:"isReadOnly",customBidAmount:"customBidAmount",redirectIfFailed:"redirectIfFailed"},outputs:{onPoolCompleted:"onPoolCompleted",onPoolUpdated:"onPoolUpdated"},features:[e.qOj],decls:12,vars:10,consts:[[1,"bidding-bar","overflow-hidden","h-12","relative","z-10","flex","items-center","w-36","rounded-lg",3,"click"],["biddingButton",""],["src","assets/images/ticket.png",1,"mx-1","md:mx-2","absolute","select-none"],[4,"ngIf","ngIfElse"],["noLogin",""],["notEntered",""],["poolCompleted",""],["poolProcessing",""],["class","bid-amount w-full pool-text select-none mt-px md:mt-0 pl-4 text-center",3,"ngClass",4,"ngIf","ngIfElse"],[1,"bid-amount","w-full","pool-text","select-none","mt-px","md:mt-0","pl-4","text-center",3,"ngClass"],["bidWrapper",""],["class","my-entries-label",4,"ngIf"],["class","uppercase max",4,"ngIf","ngIfElse"],["bidAmout",""],[1,"my-entries-label"],[1,"uppercase","max"],[1,"no-login","w-full","font-medium","select-none","mt-px","md:mt-0"],[1,"enter-now","w-full","font-medium","select-none","mt-px","md:mt-0"],["class","enter-now w-full font-medium select-none mt-px md:mt-0 pool-text",4,"ngIf","ngIfElse"],[1,"enter-now","w-full","font-medium","select-none","mt-px","md:mt-0","pool-text"],["notMax",""],[1,"max","uppercase"],[1,"text-lg"],[1,"processing","w-full","pl-2.5"],[1,"w-fit","mx-auto","block"]],template:function(l,o){if(1&l&&(e.TgZ(0,"div",0,1),e.NdJ("click",function(x){return o.onBid(x,o.pool)}),e._UZ(2,"img",2),e.YNc(3,$,2,2,"ng-container",3),e.qZA(),e.YNc(4,G,3,5,"ng-template",null,4,e.W1O),e.YNc(6,q,3,3,"ng-template",null,5,e.W1O),e.YNc(8,Z,1,2,"ng-template",null,6,e.W1O),e.YNc(10,W,2,0,"ng-template",null,7,e.W1O)),2&l){const i=e.MAs(5);e.ekj("disabled",o.pool.currentPoolPercentage>=100||o.pool.bidAmount>=o.pool.userMaxTickets)("read-only",o.isReadOnly)("can-bid",o.isLogin)("not-entered",!(o.pool.bidAmount>0||o.customBidAmount)),e.xp6(3),e.Q6J("ngIf",o.isLogin)("ngIfElse",i)}},dependencies:[m.mk,m.O5,L.r,B.X$],styles:['.bidding-bar[_ngcontent-%COMP%]{background-color:#ffdc40;transition:transform .2s ease-out;transform-origin:bottom;transform:scale(1);overflow:hidden;border:1px solid rgb(255,188,133);cursor:pointer!important}.bidding-bar.disabled[_ngcontent-%COMP%]{color:#686868;background-color:#d9d9d9;border-color:#cacaca}.bidding-bar[_ngcontent-%COMP%]:not(.disabled).not-entered:after{animation:3s shinebg 1.2s forwards infinite!important}.bidding-bar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:19px;transition:transform .2s ease-out}@media (min-width: 768px){.bidding-bar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:25px}}@media (min-width: 1440px){.bidding-bar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px}}.bidding-bar[_ngcontent-%COMP%]   .bid-amount[_ngcontent-%COMP%]{transition:transform .2s ease-out}.bidding-bar[_ngcontent-%COMP%]:after{content:"";top:0;transform:translate(100%);width:100%;height:100%;position:absolute;background:linear-gradient(to right,rgba(255,255,255,0) 0%,rgba(255,255,255,.6) 50%,rgba(128,186,232,0) 99%,rgba(125,185,232,0) 100%)}.bidding-bar[_ngcontent-%COMP%]:not(.disabled):hover:after{animation:shinebg 1.2s forwards}@keyframes shinebg{0%{transform:translate(-100%)}to{transform:translate(100%)}}.pool-text[_ngcontent-%COMP%]{font-size:23px;line-height:23px}.pool-text[_ngcontent-%COMP%]   .my-entries-label[_ngcontent-%COMP%]{font-size:10px;line-height:10px;margin-top:1px}.pool-text[_ngcontent-%COMP%]   .max[_ngcontent-%COMP%]{font-size:20px;line-height:20px}.no-login[_ngcontent-%COMP%]{font-size:13px;line-height:1.1;margin-left:15px;text-align:center!important}.no-login.closed[_ngcontent-%COMP%]{margin-left:30px}@media (min-width: 768px){.no-login[_ngcontent-%COMP%]{font-size:15px;margin-left:15px}}.enter-now[_ngcontent-%COMP%]{font-size:13px;line-height:1.1;margin-left:15px;text-align:center!important;transition:transform .2s ease-out}@media (min-width: 640px){.enter-now[_ngcontent-%COMP%]{font-size:15px}}@media (min-width: 768px){.enter-now[_ngcontent-%COMP%]{font-size:18px;margin-left:15px}}@media (min-width: 1024px){.enter-now[_ngcontent-%COMP%]{margin-left:7px}}app-loading-animation[_ngcontent-%COMP%]     .knight-rider-bar{height:.32em;width:.22em;background-color:#8e8e8e}app-loading-animation[_ngcontent-%COMP%]     .knight-rider-loader{font-size:35px;line-height:35px}']}),d})()},10709:(R,v,r)=>{r.d(v,{u:()=>w});var c=r(93379),e=r(94650),b=r(36895),p=r(1470),T=r(54463);function O(u,t){1&u&&(e.TgZ(0,"div",4),e._UZ(1,"app-text-jumping",5),e.ALo(2,"translate"),e.qZA()),2&u&&(e.xp6(1),e.Q6J("text",e.lcZ(2,1,"you-won")))}function I(u,t){if(1&u&&(e.ynx(0),e.YNc(1,O,3,3,"div",3),e.BQk()),2&u){const _=e.oxw(),m=e.MAs(2);e.xp6(1),e.Q6J("ngIf",_.pool.hasCurrentUserWon)("ngIfElse",m)}}function D(u,t){if(1&u&&(e.TgZ(0,"div",7)(1,"div",8)(2,"div",9),e._UZ(3,"img",10),e.qZA(),e.TgZ(4,"div",11),e._UZ(5,"img",12),e.qZA()(),e.TgZ(6,"div",13),e._UZ(7,"app-text-jumping",5),e.qZA(),e.TgZ(8,"span",14),e._uU(9),e.ALo(10,"translate"),e.qZA()()),2&u){const _=e.oxw(2);e.xp6(5),e.Q6J("src",_.pool.winnerAvatar||"assets/images/sign-up-user.svg",e.LSH),e.xp6(2),e.Q6J("text",_.pool.winnerName),e.xp6(2),e.Oqu(e.lcZ(10,3,"pool-winner"))}}function A(u,t){if(1&u&&e.YNc(0,D,11,5,"div",6),2&u){const _=e.oxw(),m=e.MAs(4);e.Q6J("ngIf",_.finished)("ngIfElse",m)}}function M(u,t){if(1&u&&(e.TgZ(0,"p",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&u){const _=e.oxw();e.ekj("animated-elipsis",2===_.pool.status||100===_.pool.status)("invisible",0==_.pool.status),e.xp6(1),e.hij(" ",e.lcZ(2,5,_.statusMap[_.pool.status])," ")}}let w=(()=>{class u{constructor(){this.showLoadingNextPool=!0,this.statusMap={0:"100%",1:"lottery-drawn",2:"drawing-winner",3:"drawing-start-soon",4:"expired",5:"paused",10:"drawing-start-soon",100:"drawing-start-soon"}}get finished(){return this.pool?.status==c.j1.DRAWN||this.pool?.status==c.j1.EXPIRED}ngOnInit(){this.showLoadingNextPool&&(this.statusMap[100]="loading-next-pool")}}return u.\u0275fac=function(_){return new(_||u)},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-bidding-pool-status"]],inputs:{pool:"pool",showLoadingNextPool:"showLoadingNextPool"},decls:5,vars:1,consts:[[4,"ngIf"],["notWon",""],["notFinished",""],["class","you-won pt-0.5 pb-px px-2 uppercase text-xs font-bold rounded-md text-black",4,"ngIf","ngIfElse"],[1,"you-won","pt-0.5","pb-px","px-2","uppercase","text-xs","font-bold","rounded-md","text-black"],[3,"text"],["class","winner-content font-medium text-base flex flex-nowrap items-center mt-0.5 mb-1",4,"ngIf","ngIfElse"],[1,"winner-content","font-medium","text-base","flex","flex-nowrap","items-center","mt-0.5","mb-1"],[1,"winner-avatar","relative"],[1,"absolute","crown"],["src","assets/images/golden-crown-100px.png","srcset","assets/images/golden-crown-100px.png 1x, assets/images/golden-crown-250px.png 2x",1,"w-full","h-full"],[1,"winner-avatar-img","object-cover","w-8","h-8","rounded-full","overflow-hidden"],[1,"w-full","h-full",3,"src"],[1,"winner-name","truncate","text-black","ml-1"],[1,"tag","capitalize",2,"--color","#FFDC3F"],[1,"pool-status","text-black","text-base","font-bold","text-center","whitespace-nowrap","select-none"]],template:function(_,m){1&_&&(e.YNc(0,I,2,2,"ng-container",0),e.YNc(1,A,1,2,"ng-template",null,1,e.W1O),e.YNc(3,M,3,7,"ng-template",null,2,e.W1O)),2&_&&e.Q6J("ngIf",m.pool)},dependencies:[b.O5,p.P,T.X$],styles:['@charset "UTF-8";.animated-elipsis[_ngcontent-%COMP%]:after{overflow:hidden;display:inline-block;vertical-align:bottom;transform:translate(-2px);animation:ellipsis-animation steps(1,end) 2s infinite;content:"\\2026"}@keyframes ellipsis-animation{0%{clip-path:inset(0 100% 0 0)}25%{clip-path:inset(0 66.6% 0 0)}50%{clip-path:inset(0 33.3% 0 0)}75%{clip-path:inset(0 0 0 0)}}.you-won[_ngcontent-%COMP%]{position:relative;overflow:hidden}.you-won[_ngcontent-%COMP%]:after{content:"";top:0;transform:translate(100%);width:100%;height:100%;position:absolute;background:linear-gradient(to right,rgba(255,255,255,0) 0%,rgba(255,255,255,.6) 50%,rgba(128,186,232,0) 99%,rgba(125,185,232,0) 100%);animation:3s shinebg 1.2s forwards infinite}@keyframes shinebg{0%{transform:translate(-100%)}to{transform:translate(100%)}}.avatar[_ngcontent-%COMP%]{width:20px!important;height:20px;min-width:20px}.tag[_ngcontent-%COMP%]{display:inline-block;z-index:1;text-align:center;color:#000;height:20px;position:relative;border-left:none;background-color:var(--color);min-width:50px;margin-left:12px;padding-left:6px;border-radius:0 4px 4px 0;font-size:14px;line-height:20px;padding-right:6px}.tag[_ngcontent-%COMP%]:before{content:"";z-index:-1;position:absolute;top:3px;left:-7px;width:14px;height:14px;background-color:var(--color);border-right:none;border-top:none;transform:rotate(45deg)}.crown[_ngcontent-%COMP%]{left:0;right:0;margin-left:auto;margin-right:auto;top:-6px;width:23px;z-index:1}.winner-avatar-img[_ngcontent-%COMP%]{position:relative;margin-top:4px}']}),u})()},23284:(R,v,r)=>{r.d(v,{Y:()=>nt});var c=r(15861),e=r(82722),b=r(49808),p=r(5963),T=r(83905),O=r(95698),I=r(70262),D=r(39646),A=r(24837),M=r(18110),w=r(93379),u=r(5565),t=r(94650),_=r(56889),m=r(36895),L=r(95133),B=r(81212),N=r(7858),K=r(63225),F=r(56095),Q=r(60928),Y=r(10709),j=r(70325),J=r(16879),z=r(37978),$=r(54463);const G=["biddingButton"];function q(s,f){1&s&&(t.TgZ(0,"div",13),t._UZ(1,"span"),t.qZA())}function H(s,f){if(1&s&&t.GkF(0,14),2&s){const n=t.oxw(),a=t.MAs(13),g=t.MAs(11);t.Q6J("ngTemplateOutlet",n.isBiddingMode?a:g)}}function V(s,f){if(1&s&&t._UZ(0,"img",15),2&s){const n=t.oxw();t.Q6J("ngClass",n.isBiddingMode?"!w-10 top-0 left-0":"!w-12 bottom-0 right-0")}}function X(s,f){if(1&s){const n=t.EpF();t.TgZ(0,"div",16)(1,"div",17)(2,"app-tooltip",18),t._UZ(3,"img",19),t.TgZ(4,"div",20),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"app-bid-button",21),t.NdJ("onPoolCompleted",function(g){t.CHM(n);const C=t.oxw();return t.KtG(C.onPoolCompleted(g))})("onPoolUpdated",function(g){t.CHM(n);const C=t.oxw();return t.KtG(C.onPoolUpdated(g))}),t.qZA()()}if(2&s){const n=t.oxw();t.xp6(2),t.Q6J("hoverBg",!1),t.xp6(3),t.hij(" ",t.lcZ(6,6,"free-gift-guaranteed-tooltip")," "),t.xp6(2),t.Q6J("product",n.product)("pool",n.pool)("animationTarget",n.animationTarget)("isLogin",n.isLogin)}}const Z=function(){return["/product","detail"]},W=function(s,f){return{id:s,poolId:f}};function tt(s,f){if(1&s&&(t.TgZ(0,"a",2)(1,"p",22),t._uU(2),t.qZA(),t.TgZ(3,"p",23),t._uU(4),t.ALo(5,"currency"),t.qZA(),t.TgZ(6,"p",24),t._uU(7),t.ALo(8,"currency"),t.qZA()()),2&s){const n=t.oxw();t.Q6J("routerLink",t.DdM(9,Z))("queryParams",t.WLB(10,W,n.product.id,n.pool.poolId||null)),t.xp6(2),t.hij(" ",n.product.name," "),t.xp6(2),t.hij(" ",t.lcZ(5,5,n.price)," "),t.xp6(3),t.hij(" ",t.lcZ(8,7,n.realPrice)," ")}}function d(s,f){if(1&s&&t._UZ(0,"img",30),2&s){const n=t.oxw().isBelong;t.Q6J("src",n?"assets/svgs/heart-full.svg":"assets/svgs/heart-empty.svg",t.LSH)}}function P(s,f){if(1&s&&t._UZ(0,"app-heart-animated",32),2&s){const n=t.oxw(2).isBelong;t.Q6J("active",n)}}function l(s,f){1&s&&t.YNc(0,P,1,1,"app-heart-animated",31)}function o(s,f){if(1&s){const n=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(g){const y=t.CHM(n).method,ot=t.oxw(2);return t.KtG(ot.handleClickFavorite(g,y))}),t.YNc(1,d,1,1,"img",28),t.YNc(2,l,1,0,"ng-template",null,29,t.W1O),t.qZA()}if(2&s){const n=f.isDisabled,a=t.MAs(3),g=t.oxw(2);t.Q6J("disabled",n),t.xp6(1),t.Q6J("ngIf",!g.didClicked)("ngIfElse",a)}}function i(s,f){if(1&s){const n=t.EpF();t.TgZ(0,"div",25)(1,"app-product-favorite",26),t.NdJ("isBelongChange",function(){t.CHM(n);const g=t.oxw();return t.KtG(g.triggerChange())}),t.YNc(2,o,4,3,"ng-template"),t.qZA()()}if(2&s){const n=t.oxw();t.xp6(1),t.Q6J("product",n.product)}}function x(s,f){if(1&s){const n=t.EpF();t.TgZ(0,"button",35),t.NdJ("click",function(g){const y=t.CHM(n).method;return g.preventDefault(),g.stopPropagation(),t.KtG(y())}),t.TgZ(1,"div",36),t._UZ(2,"img",37),t.qZA()()}}function E(s,f){if(1&s&&(t.TgZ(0,"div",33)(1,"app-launch-pool",34),t.YNc(2,x,3,0,"ng-template"),t.qZA()()),2&s){const n=t.oxw();t.xp6(1),t.Q6J("product",n.product)}}function h(s,f){if(1&s&&(t.TgZ(0,"p",43),t._uU(1),t.ALo(2,"number"),t.qZA()),2&s){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,n.pool.currentPoolPercentage,"0.0-0"),"% ")}}function U(s,f){if(1&s&&t._UZ(0,"app-bidding-pool-status",44),2&s){const n=t.oxw(2);t.Q6J("pool",n.pool)}}const k=function(s){return{id:s,poolId:null}};function S(s,f){if(1&s&&(t.TgZ(0,"div",38)(1,"a",39),t._uU(2),t.qZA(),t._UZ(3,"app-bidding-progress-bar",40),t.YNc(4,h,3,4,"p",41),t.YNc(5,U,1,1,"ng-template",null,42,t.W1O),t.qZA()),2&s){const n=t.MAs(6),a=t.oxw();t.xp6(1),t.Q6J("routerLink",t.DdM(7,Z))("queryParams",t.VKq(8,k,a.product.id)),t.xp6(1),t.hij(" ",a.product.name," "),t.xp6(1),t.Q6J("currentPoolPercentage",a.pool.currentPoolPercentage)("hasEntered",a.pool.bidAmount>0),t.xp6(1),t.Q6J("ngIf",a.pool.currentPoolPercentage<100)("ngIfElse",n)}}const et=function(s){return{glowing:s}};let nt=(()=>{class s extends u.V{constructor(n,a){super(),this.cdr=n,this.biddingService=a,this.biddingButton=null,this.isBiddingMode=!1,this.identifierPrefix="",this.didClicked=!1,this.hideLoader=!1}ngOnChanges(n){n.product&&this.biddingService.isBiddingMode$.getValue()&&!this.biddingService.isBiddingInProgress&&this.setPoolConfig()}ngOnInit(){this.setPoolConfig(),this.animationTarget=`#${this.identifierPrefix}home-product-${this.product.id}`,this.biddingService.onUpdateProductCardBidAmount$.pipe((0,e.R)(this.destroyStream$)).subscribe(n=>{n.poolId==this.pool?.poolId&&(n.bidAmount!=this.pool.bidAmount||n.currentPoolSize!=this.pool.currentPoolSize||n.status!=this.pool.status)&&(console.log(n),this.pool.bidAmount=n.bidAmount,this.pool.currentPoolSize=n.currentPoolSize,this.pool.currentPoolPercentage=n.currentPoolPercentage,this.pool.status=n.status,this.cdr.detectChanges())})}get realPrice(){let n=0;return this.product.defaultSku&&(n=this.product.defaultSku.cashBack),this.product.defaultSku?.price-(n||0)}get price(){return this.product.defaultSku?.price}handleClickFavorite(n,a){n.preventDefault(),n.stopPropagation(),this.isLogin?(this.didClicked=!0,setTimeout(()=>{a()},100)):a()}triggerChange(){this.cdr.markForCheck()}onPoolCompleted(n){var a=this;return(0,c.Z)(function*(){console.log("Pool completed!"),A.Z.isBrowser&&(a.pool.status=2,a.cdr.detectChanges(),yield(0,b.n)((0,p.H)(3e3)),a.pool.status=100,a.cdr.detectChanges(),yield(0,b.n)((0,p.H)(2e3))),a.getNewProductPool(),a.cdr.detectChanges()})()}onPoolUpdated(n){var a=this;return(0,c.Z)(function*(){const g=yield(0,T.z)(a.biddingService.getProductPools({rows:1,page:0,poolId:n.poolId}).pipe((0,O.q)(1))),C=g?.rows?g.rows.find(y=>y.id==n?.poolId):null;C&&(n.currentPoolSize=C.currentTickets,n.currentPoolPercentage=(0,M.DU)(C.currentTickets,C.maxTickets),n.bidAmount=C.userTotalTickets,console.log("Pool updated!"),a.cdr.detectChanges())})()}setPoolConfig(){this.pool={poolId:this.product.poolId,poolOwner:{id:this.product.sponsorId,userId:this.product.sponsorName,avatar:this.product.sponsorAvatar??"assets/images/sign-up-user.svg"},currentPoolSize:this.product.currentTickets,currentPoolPercentage:(0,M.DU)(this.product.currentTickets,this.product.maxTickets),poolLimit:this.product.maxTickets,userMaxTickets:this.product.userMaxTickets,bidAmount:this.product.userTotalTickets,status:this.product.status}}getNewProductPool(){var n=this;return(0,c.Z)(function*(){const a=yield(0,T.z)(n.biddingService.getProductPools({rows:1,page:0,skuId:n.product.productSkuId,status:0}).pipe((0,I.K)(g=>(0,D.of)({error:g}))));if(a?.rows?.length>0){const g=a.rows[0];n.pool={poolId:g.id,poolOwner:{id:g.sponsorId,userId:g.sponsorName,avatar:g.sponsorAvatar??"/assets/images/sign-up-user.svg"},currentPoolSize:g.currentTickets,currentPoolPercentage:(0,M.DU)(g.currentTickets,g.maxTickets),poolLimit:g.maxTickets,userMaxTickets:n.product.userMaxTickets,bidAmount:g.userTotalTickets,status:g.status}}else n.pool={poolId:"",poolOwner:{id:0,userId:"",avatar:"/assets/images/sign-up-user.svg"},currentPoolSize:0,currentPoolPercentage:0,poolLimit:n.pool.poolLimit,userMaxTickets:n.product.userMaxTickets,bidAmount:0,status:w.j1.OPEN};n.cdr.detectChanges(),n.biddingService.onUpdateProductCardBidAmount$.next({poolId:n.pool.poolId,bidAmount:n.pool.bidAmount,currentPoolSize:n.pool.currentPoolSize,currentPoolPercentage:n.pool.currentPoolPercentage,status:n.pool.status})})()}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(t.sBO),t.Y36(_.g))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-product-card"]],viewQuery:function(n,a){if(1&n&&t.Gf(G,5),2&n){let g;t.iGM(g=t.CRH())&&(a.biddingButton=g.first)}},inputs:{product:"product",isLogin:"isLogin",isBiddingMode:"isBiddingMode",identifierPrefix:"identifierPrefix"},features:[t.qOj,t.TTD],decls:16,vars:17,consts:[["draggable","false",1,"cursor-pointer","flex","flex-col","w-full","max-w-[246px]","lg:max-w-[220px]","xl:max-w-[245px]",3,"id"],[1,"product-image-wraper","rounded-lg","overflow-hidden","mb-2"],[3,"routerLink","queryParams"],[1,"absolute","inset-0","overflow-hidden",3,"ngClass"],[1,"object-cover","object-center","!w-full","!h-full","relative","z-10","product-img",3,"src","alt","load"],["class","loader-container absolute inset-0",4,"ngIf"],[3,"ngTemplateOutlet",4,"isBrowser"],["class","absolute fire-animation z-10","src","assets/svgs/fire-animation.svg","alt","",3,"ngClass",4,"ngIf"],["class","w-full h-full relative",4,"ngIf"],[3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["favoriteBtn",""],["launchBtn",""],["biddingInfo",""],[1,"loader-container","absolute","inset-0"],[3,"ngTemplateOutlet"],["src","assets/svgs/fire-animation.svg","alt","",1,"absolute","fire-animation","z-10",3,"ngClass"],[1,"w-full","h-full","relative"],[1,"absolute","!h-6","!w-6","md:!h-8","md:!w-8","gift-tooltip-wrapper","right-0","fade-in-from-bottom",2,"--duration","400ms","--delay","100ms","--distance","10px"],["side","top",1,"flex",3,"hoverBg"],["tooltipBtn","","src","assets/images/present 250px-min.png",1,"gift-tooltip-btn"],[1,"p-3","font-medium","text-base"],[1,"w-full",3,"product","pool","animationTarget","isLogin","onPoolCompleted","onPoolUpdated"],[1,"product-title","truncate","text-[#333333]","text-center","font-medium","mb-1","text-sm"],[1,"text-[#ff1a44]","leading-3","line-through","text-center","whitespace-nowrap","text-xs"],[1,"text-black","text-base","text-center","whitespace-nowrap","font-bold"],[1,"absolute","top-0","right-0","mr-1.5","mt-1.5","z-10"],[3,"product","isBelongChange"],[1,"rounded-full","border","border-solid","border-[#dddddd]","bg-white","w-full","flex","p-1","justify-center","items-center","text-[#dddddd]",3,"disabled","click"],["class","heart-img","alt","",3,"src",4,"ngIf","ngIfElse"],["haveNotClicked",""],["alt","",1,"heart-img",3,"src"],[3,"active",4,"isBrowser"],[3,"active"],[1,"absolute","top-0","right-0","mr-1.5","mt-1.5","z-10","bg-white","rounded-full"],[3,"product"],[1,"launch-pool","w-full","launch-btn","rounded-full","bg-rainbow-animated","!shadow-none","!p-px",3,"click"],[1,"content","bg-white","p-1","rounded-full","border-2","border-black","w-full","flex","items-center"],["src","assets/images/bidding/star.png",1,"!h-4","2xl:!h-5"],[1,"cursor-default"],[1,"product-title","block","truncate","text-black","text-center","font-medium","mb-2.5","text-sm","select-none",3,"routerLink","queryParams"],[3,"currentPoolPercentage","hasEntered"],["class","invisible leading-4 -mt-1 text-black font-bold mb-px text-center whitespace-nowrap text-sm select-none",4,"ngIf","ngIfElse"],["drawingWinner",""],[1,"invisible","leading-4","-mt-1","text-black","font-bold","mb-px","text-center","whitespace-nowrap","text-sm","select-none"],[3,"pool"]],template:function(n,a){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"div",3)(4,"img",4),t.NdJ("load",function(){return a.hideLoader=!0}),t.qZA(),t.YNc(5,q,2,0,"div",5),t.qZA(),t.YNc(6,H,1,1,"ng-container",6),t.YNc(7,V,1,1,"img",7),t.qZA(),t.YNc(8,X,8,8,"div",8),t.qZA(),t.YNc(9,tt,9,13,"a",9),t.qZA(),t.YNc(10,i,3,1,"ng-template",null,10,t.W1O),t.YNc(12,E,3,1,"ng-template",null,11,t.W1O),t.YNc(14,S,7,10,"ng-template",null,12,t.W1O)),2&n){const g=t.MAs(15);t.s9C("id",a.identifierPrefix+"home-product-"+a.product.id),t.xp6(2),t.Q6J("routerLink",t.DdM(11,Z))("queryParams",t.WLB(12,W,a.product.id,a.isBiddingMode?a.pool.poolId||0:null)),t.xp6(1),t.Q6J("ngClass",t.VKq(15,et,a.product.isSpecialSale&&!a.isBiddingMode)),t.xp6(1),t.Q6J("src",a.product.productImages[0].medium,t.LSH)("alt",a.product.name),t.xp6(1),t.Q6J("ngIf",!a.hideLoader),t.xp6(2),t.Q6J("ngIf",a.product.isSpecialSale),t.xp6(1),t.Q6J("ngIf",a.isBiddingMode),t.xp6(1),t.Q6J("ngIf",!a.isBiddingMode)("ngIfElse",g)}},dependencies:[m.mk,m.O5,m.tP,L.Fo,B.yS,N.j,K.E,F.y,Q.w,Y.u,j.P,J.j,z.u,m.JJ,m.H9,$.X$],styles:['.product-image-wraper[_ngcontent-%COMP%]{position:relative;width:100%;height:unset;padding-top:100%}.product-image-wraper[_ngcontent-%COMP%]   .product-img[_ngcontent-%COMP%]{border-radius:9px}.product-image-wraper[_ngcontent-%COMP%]   .gift-tooltip-wrapper[_ngcontent-%COMP%]{top:-55px;z-index:11}@media (min-width: 768px){.product-image-wraper[_ngcontent-%COMP%]   .gift-tooltip-wrapper[_ngcontent-%COMP%]{display:none;top:-65px}}.product-image-wraper[_ngcontent-%COMP%]:hover     .bidding-bar.can-bid{transform:scaleY(1.3);transform-origin:bottom}.product-image-wraper[_ngcontent-%COMP%]:hover     .bidding-bar.can-bid img, .product-image-wraper[_ngcontent-%COMP%]:hover     .bidding-bar.can-bid .bid-amount, .product-image-wraper[_ngcontent-%COMP%]:hover     .bidding-bar.can-bid .enter-now{transform:scaleY(.76)}.product-image-wraper[_ngcontent-%COMP%]:hover   .gift-tooltip-wrapper[_ngcontent-%COMP%]{display:flex}  .bidding-mode-global app-product-card .product-img{border:1px solid #ebebeb;background-color:#fff}  .bidding-mode-global app-product-card{margin-top:4px;margin-bottom:4px}  .bidding-mode-global app-product-card:hover{border-radius:9px;background:#ECF0F2;box-shadow:0 0 0 4px #ddd}  .bidding-mode-global app-product-card:hover>div{box-shadow:0 0 0 3px #ecf0f2;background:#ECF0F2;border-radius:9px}app-bid-button[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}app-bid-button[_ngcontent-%COMP%]     .bidding-bar{width:100%;border-radius:0;border:none;height:40px}app-bid-button[_ngcontent-%COMP%]     .bidding-bar .bid-amount.large-value{padding-left:3.5rem}app-bid-button[_ngcontent-%COMP%]     .pool-text{font-size:1.5rem;line-height:1.5rem}@media (min-width: 1440px){app-bid-button[_ngcontent-%COMP%]     .no-login{margin-left:20px}}app-heart-animated[_ngcontent-%COMP%], .heart-img[_ngcontent-%COMP%]{height:28px!important;width:28px!important}.glowing[_ngcontent-%COMP%]{border-radius:.5rem;padding:2px;box-shadow:0 0 5px 2px #ffd80099}.glowing[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;border-radius:inherit;border-radius:.5rem;z-index:1;background:linear-gradient(to top,#f68104,#ffd800)}.loader-container[_ngcontent-%COMP%]{z-index:3;margin:2px;border-radius:.5rem;background-color:#e7e8e7}.loader-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;height:32px;width:32px;clip:rect(16px,32px,32px,0);margin:auto;inset:0;animation:loader-2-2 1.5s cubic-bezier(.77,0,.175,1) infinite}@keyframes loader-2-2{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loader-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"";display:block;position:absolute;inset:0;margin:auto;height:32px;width:32px;border:3px solid transparent;border-top:3px solid rgba(0,0,0,.3);border-radius:50%;animation:loader-2-3 1.5s cubic-bezier(.77,0,.175,1) infinite}@keyframes loader-2-3{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loader-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;inset:0;margin:auto;height:32px;width:32px;border:3px solid rgba(0,0,0,.3);border-radius:50%}app-bidding-pool-status[_ngcontent-%COMP%]     .pool-status{margin-bottom:1px;font-size:.875rem;line-height:1.25rem}'],changeDetection:0}),s})()},56095:(R,v,r)=>{r.d(v,{y:()=>w});var c=r(94650),e=r(5565),b=r(45329),p=r(36895),T=r(63225),O=r(60753);function I(u,t){}function D(u,t){if(1&u){const _=c.EpF();c.TgZ(0,"app-require-login-modal",3),c.NdJ("isOpenChange",function(L){c.CHM(_);const B=c.oxw(2);return c.KtG(B.openRequireLoginModal=L)}),c.qZA()}if(2&u){const _=c.oxw(2);c.Q6J("isOpen",_.openRequireLoginModal)}}function A(u,t){if(1&u&&(c.ynx(0),c.YNc(1,D,1,1,"app-require-login-modal",2),c.BQk()),2&u){const _=c.oxw();c.xp6(1),c.Q6J("ngIf",_.openRequireLoginModal)}}const M=function(u,t,_,m){return{method:u,isBelong:t,isLoading:_,isDisabled:m}};let w=(()=>{class u extends e.V{constructor(_){super(),this.userService=_,this.isBelongChange=new c.vpe,this.isBelong=!1,this.isLoading=!1,this.openRequireLoginModal=!1,this.handleClick=()=>{this.userService.isLogin()?this.isBelong?(this.isLoading=!0,this.userService.removeFromWishList(this.product.id).subscribe({next:m=>{this.isBelong=!1,this.isBelongChange.emit(!1),this.isLoading=!1},error:m=>{this.isLoading=!1}})):(this.isLoading=!0,this.userService.addToWishList(this.product.id,this.skuId||this.product.defaultSku?.id).subscribe({next:m=>{this.isBelong=!0,this.isBelongChange.emit(!0),this.isLoading=!1},error:m=>{this.isLoading=!1}})):this.openRequireLoginModal=!0}}ngOnInit(){this.isBelong=this.product.collect}get isDisabled(){return!this.skuId&&!this.product?.defaultSku}}return u.\u0275fac=function(_){return new(_||u)(c.Y36(b.K))},u.\u0275cmp=c.Xpm({type:u,selectors:[["app-product-favorite"]],contentQueries:function(_,m,L){if(1&_&&c.Suo(L,c.Rgc,5),2&_){let B;c.iGM(B=c.CRH())&&(m.templateRef=B.first)}},inputs:{product:"product",skuId:"skuId"},outputs:{isBelongChange:"isBelongChange"},features:[c.qOj],decls:3,vars:7,consts:[[3,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"isBrowser"],[3,"isOpen","isOpenChange",4,"ngIf"],[3,"isOpen","isOpenChange"]],template:function(_,m){1&_&&(c.ynx(0),c.YNc(1,I,0,0,"ng-template",0),c.YNc(2,A,2,1,"ng-container",1),c.BQk()),2&_&&(c.xp6(1),c.Q6J("ngTemplateOutlet",m.templateRef)("ngTemplateOutletContext",c.l5B(2,M,m.handleClick,m.isBelong,m.isLoading,m.isDisabled)))},dependencies:[p.O5,p.tP,T.E,O.C],encapsulation:2}),u})()}}]);