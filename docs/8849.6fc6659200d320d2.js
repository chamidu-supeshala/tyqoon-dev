"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[8849],{88849:(q,v,r)=>{r.r(v),r.d(v,{CheckoutConfirmModule:()=>Je});var d=r(36895),_=r(7507),c=r(95133),h=r(54463),e=r(94650);const g=function(){return["/member","profile"]};function p(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"\u624b\u673a\u53f7\u3001\u90ae\u7bb1\u7ed1\u5b9a"),e.qZA(),e.TgZ(4,"ion-buttons",2)(5,"ion-button",3),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(6,"\u2715"),e.qZA()()()(),e.TgZ(7,"div",4),e._uU(8),e.qZA(),e._UZ(9,"div",5),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(15),e.ALo(16,"translate"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(8),e.hij(" ",t.modalContent," "),e.xp6(4),e.Oqu(e.lcZ(13,4,"cancel")),e.xp6(2),e.Q6J("routerLink",e.DdM(8,g)),e.xp6(1),e.Oqu(e.lcZ(16,6,"ok"))}}let x=(()=>{class o{constructor(t,n){this.translate=t,this.router=n,this.isOpenChange=new e.vpe,this.dismissModal=i=>{this.modal.dismiss(i)},this.handleOk=()=>{this.router.navigate(["/auth/login"],{queryParams:{back:encodeURIComponent(this.router.url)}}),this.dismissModal("ok")}}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.sK),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-bind-email-phone-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(c.ki,5),2&t){let i;e.iGM(i=e.CRH())&&(n.modal=i.first)}},inputs:{isOpen:"isOpen",modalContent:"modalContent"},outputs:{isOpenChange:"isOpenChange"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[[1,"profile-modal",3,"isOpen","didDismiss"],["profileModal",""],["slot","end"],[3,"click"],[1,"p-4"],[1,"border-b","border-[#dddddd]"],[1,"flex","justify-end","p-4"],[1,"border","border-[#dddddd]","py-2","px-4","capitalize",3,"click"],[1,"bg-primary","rounded","text-white","py-2","px-4","capitalize",3,"routerLink","click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0,1),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(2,p,17,9,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.Pc,c.YG,c.Sm,c.Gu,c.wd,c.sr,c.ki,c.YI,d.ez,h.aw,h.X$,_.Bz,_.rH],styles:[".profile-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 8px;--width: 400px}"]}),o})();function k(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"\u4f59\u989d\u4e0d\u8db3"),e.qZA(),e.TgZ(4,"ion-buttons",2)(5,"ion-button",3),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(6,"\u2715"),e.qZA()()()(),e.TgZ(7,"div",4),e._uU(8," \u8bf7\u5148\u5145\u503c\u4f59\u989d\u6216\u9009\u62e9\u5728\u7ebf\u652f\u4ed8 "),e.qZA(),e._UZ(9,"div",5),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){e.CHM(t),e.oxw();const i=e.MAs(1);return e.KtG(i.dismiss())}),e._uU(15),e.ALo(16,"translate"),e.qZA()()}2&o&&(e.xp6(12),e.Oqu(e.lcZ(13,2,"\u4f59\u989d\u5145\u503c")),e.xp6(3),e.Oqu(e.lcZ(16,4,"\u5728\u7ebf\u652f\u4ed8")))}let O=(()=>{class o{constructor(t,n){this.translate=t,this.router=n,this.isOpenChange=new e.vpe}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.sK),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-insufficient-balance-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(c.ki,5),2&t){let i;e.iGM(i=e.CRH())&&(n.modal=i.first)}},inputs:{isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[[1,"profile-modal",3,"isOpen","didDismiss"],["modal",""],["slot","end"],[3,"click"],[1,"p-4"],[1,"border-b","border-[#dddddd]"],[1,"flex","justify-end","p-4"],[1,"border","border-[#dddddd]","py-2","px-4","capitalize",3,"click"],[1,"bg-primary","rounded","text-white","py-2","px-4","capitalize",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0,1),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(2,k,17,6,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.Pc,c.YG,c.Sm,c.Gu,c.wd,c.sr,c.ki,d.ez,h.aw,h.X$,_.Bz],styles:[".profile-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 8px;--width: 400px}"]}),o})();var A=r(16424),T=r(44466),U=r(98389),E=r(48910),m=r(15861),b=r(82722),C=r(49808),J=r(24499),M=r(51304),F=r(24837),l=r(11781),P=r(18110),S=r(94128),B=r(94830),R=r(52186),w=r(80164),j=r(35482),Y=r(46364),Q=r(10216),D=r(5565),G=r(3259),H=r(76172),W=r(86074);function z(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){const a=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.selectPayWay(a.platformCode))}),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"img",8),e.qZA()}if(2&o){const t=s.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,2,t.name)," "),e.xp6(2),e.Q6J("src",t.icon,e.LSH)}}function K(o,s){if(1&o&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",5),e._uU(5),e.ALo(6,"currency"),e.qZA(),e.TgZ(7,"div",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.YNc(10,z,4,4,"button",6),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,4,"checkout-confirm-amount-to-be-paid"),":"),e.xp6(3),e.Oqu(e.lcZ(6,6,t.amount)),e.xp6(3),e.hij("",e.lcZ(9,8,"checkout-confirm-choose-method"),":"),e.xp6(2),e.Q6J("ngForOf",t.payWayList)}}function $(o,s){1&o&&(e.TgZ(0,"p",11),e._uU(1,"\u8bf7\u4f7f\u7528\u5fae\u4fe1\u626b\u7801\u652f\u4ed8"),e.qZA())}function V(o,s){if(1&o&&(e._UZ(0,"img",9),e.YNc(1,$,2,0,"p",10)),2&o){const t=e.oxw();e.Q6J("src",t.qrcode,e.LSH),e.xp6(1),e.Q6J("ngIf",t.selectedPlatformCode===t.paymentPlatformEnum.WECHAT)}}let X=(()=>{class o extends D.V{constructor(t,n,i,a,f){super(),this.checkoutService=t,this.paymentSrv=n,this.CheckoutService=i,this.toast=a,this.router=f,this.select=new e.vpe,this.paymentPlatform=[l.fS.WECHAT,l.fS.ALIPAY],this.paymentPlatformEnum=l.fS,this.payWayList=[],this.selectedPlatformCode="",this.successCallbackUri="",this.loading={createPayOrder:!1,queryPaymentOrder:!1,pay:!1},this.isMobile=!1,this.isWechat=!1,this.qrcode="",this.orderId=""}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.isMobile=(0,P.tq)(),t.isWechat=(0,P.IS)(),t.payWayList=(yield(0,C.n)(t.checkoutService.queryPlatformList()))?.data.filter(n=>t.paymentPlatform.includes(n.platformGroup)&&!Object.is(n.platformCode,t.paymentPlatform)&&(!t.isWechat||!Object.is(n.name,"Alipay")))})()}ngOnDestroy(){this.destroy(),clearInterval(this.payResultSetTimeout)}selectPayWay(t){this.select.emit(),this.selectedPlatformCode=t}confirm(t,n){this.loading.createPayOrder=!0;const i=localStorage.getItem(H.r);this.paymentSrv.payV2({platformCode:this.selectedPlatformCode,paymentType:l.uG.url,businessId:t,businessType:n,equipmentType:this.isMobile?this.isWechat?l.jN.JSAPI:l.jN.H5:l.jN.PC,...this.isWechat?{wechatCode:i}:{}}).pipe((0,b.R)(this.destroyStream$)).subscribe({next:a=>{if(this.payResult=a.data,this.isMobile&&this.isWechat)return WeixinJSBridge.invoke("getBrandWCPayRequest",JSON.parse(this.payResult.paymentUrl),f=>{}),void this.queryPaymentOrder();Object.is(this.selectedPlatformCode,l.fS.ALIPAY)||this.isMobile?window.location.href=a.data.paymentUrl:(G.toDataURL(a.data.paymentUrl).then(f=>{this.qrcode=f}),this.orderId=a.data.id,this.queryPaymentOrder())},error:a=>{console.error(a)}}).add(()=>{this.loading.createPayOrder=!1})}queryPaymentOrder(t){t||(this.loading.queryPaymentOrder=!0),this.CheckoutService.queryPaymentOrder(this.orderId).pipe((0,b.R)(this.destroyStream$)).subscribe({next:n=>{this.payResult={...n.data,expiredTime:1e3*n.data.expiredTime,businessExpired:1e3*n.data.businessExpired},Object.is(this.payResult?.status,l.P1.PENDING)&&(this.payResultSetTimeout=setTimeout(()=>this.queryPaymentOrder(!0),2e3)),Object.is(this.payResult?.status,l.P1.FINISH)&&this.router.navigate(["/order/success"],{replaceUrl:!0})},error:n=>{console.error(n),this.toastError(n.message)}}).add(()=>this.loading.queryPaymentOrder=!1)}toastError(t){var n=this;return(0,m.Z)(function*(){yield n.presentToast({position:"bottom",message:t,icon:"alert-circle-outline",duration:1e3,color:"danger"})})()}presentToast(t){var n=this;return(0,m.Z)(function*(){yield(yield n.toast.create(t)).present()})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(w.Z),e.Y36(W.Z),e.Y36(w.Z),e.Y36(c.yF),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payment-methods-domestic"]],inputs:{amount:"amount"},outputs:{select:"select"},features:[e.qOj],decls:4,vars:2,consts:[[1,"payment-methods-card"],["class","methods",4,"ngIf","ngIfElse"],["paymentElement",""],[1,"methods"],[1,"title"],[1,"amount-value"],["class","btn-payWay","nz-button","","nzBlock","","nzSize","large",3,"click",4,"ngFor","ngForOf"],["nz-button","","nzBlock","","nzSize","large",1,"btn-payWay",3,"click"],["alt","icon",1,"icon",3,"src"],[2,"width","100%",3,"src"],["class","tips",4,"ngIf"],[1,"tips"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,K,11,10,"div",1),e.YNc(2,V,2,2,"ng-template",null,2,e.W1O),e.qZA()),2&t){const i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!n.payResult&&!n.loading.createPayOrder)("ngIfElse",i)}},dependencies:[d.sg,d.O5,d.H9,h.X$],styles:['.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]{background:#fff;border-radius:5px;margin-bottom:4px;text-align:left;display:flex;align-items:center;position:relative;padding:10px 8px 0;border:1px solid #e0e5eb;width:100%}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]:after{display:block;content:">";position:absolute;line-height:40px;right:8px;top:0;color:#ccc}.payment-methods-card[_ngcontent-%COMP%]   .btn-payWay[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:24px;margin-left:12px}.payment-methods-card[_ngcontent-%COMP%]   .btn-pay[_ngcontent-%COMP%]{margin-top:16px;color:#fff;border-color:#fb8811;background:#fb8811;text-shadow:0 -1px 0 rgba(0,0,0,.12);box-shadow:0 2px #0000000b;width:100%;height:40px;padding:6.4px 15px;font-size:16px;border-radius:5px!important}.payment-methods-card[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#858a8e;font-size:20px;margin-top:16px}.payment-methods-card[_ngcontent-%COMP%]   .amount-value[_ngcontent-%COMP%]{font-weight:700;font-size:24px}.tips[_ngcontent-%COMP%]{text-align:center;color:#fb8811}']}),o})();var ee=r(71346),te=r(52313),ne=r(5068),oe=r(70957),ie=r(49127),se=r(74206),re=r(45210),ae=r(18215);function ce(o,s){if(1&o&&(e.TgZ(0,"div")(1,"div",10),e._UZ(2,"img",11),e.TgZ(3,"div",12),e._uU(4),e.qZA()(),e.TgZ(5,"div",13),e._uU(6),e.qZA()()),2&o){const t=s.$implicit;e.xp6(2),e.Q6J("src",null==t?null:t.cover,e.LSH),e.xp6(2),e.Oqu(null==t?null:t.productName),e.xp6(2),e.Oqu(t.message)}}function de(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"div",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"img",5)(7,"img",6),e.qZA(),e.TgZ(8,"div",7),e.YNc(9,ce,7,3,"div",8),e.qZA(),e.TgZ(10,"button",9),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getVouchers())}),e._uU(11),e.ALo(12,"translate"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,3,"tip-sorry-title")),e.xp6(5),e.Q6J("ngForOf",t.dealData),e.xp6(2),e.Oqu(e.lcZ(12,5,"backto-my-cart"))}}new e.OlP("ModalData");let le=(()=>{class o{constructor(t,n){this.cartService=t,this.router=n,this.isOpenChange=new e.vpe,this.confirm=new e.vpe}get dealData(){let t=[];return this.res.forEach(n=>{this.getData.forEach(i=>{n.shop_sku_id==i.skuId&&t.push({cover:i.productImages[0].thumbnail,productName:i.productName,message:n.remarks,code:n.err_code})})}),console.log(this.getData),console.log(t),t}getVoucher(){this.isOpenChange.emit(!1)}getVouchers(){this.isOpenChange.emit(!1),setTimeout(()=>{this.router.navigate(["cart"],{replaceUrl:!0})},800)}handleConfirm(){this.confirm.emit()}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(S.N),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-out-of-stock"]],inputs:{isOpen:"isOpen",getData:"getData",res:"res",realCashback:"realCashback",totalCashback:"totalCashback"},outputs:{isOpenChange:"isOpenChange",confirm:"confirm"},decls:2,vars:1,consts:[[3,"isOpen","didDismiss"],[1,"p-6"],[1,"flex","justify-center","items-center","mb-8","md:mb-10"],["src","assets/images/cart-stop.png","alt","",1,"h-14","md:h-20"],[1,"ml-2","text-4xl","md:text-6xl","font-extrabold","whitespace-nowrap"],["src","assets/images/shape.png","alt","",1,"-ml-10"],["src","assets/images/mascot-stop.png","alt","",1,"h-14","md:h-20"],[1,"content","maxbg"],[4,"ngFor","ngForOf"],[1,"btn-continue","text-white-500","text-xl","md:text-2xl","py-2","font-bold","block","m-auto",2,"color","#FFFFFF!important",3,"click"],[1,"flex"],["alt","shape",2,"width","100px","height","100px",3,"src"],[1,"flex","justify-center","items-center",2,"width","100%"],[1,"text-16px","block","line-clamp-1","font-bold",2,"padding","5px","color","red"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(1,de,13,7,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[d.sg,c.ki,h.X$],styles:["ion-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 15px;--max-width: 550px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f5f5f5;-webkit-box-shadow:inset 0 0 3px rgba(0,0,0,.1);border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-button{background-color:#eee;display:none}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:#000}.content[_ngcontent-%COMP%]{padding:32px 35px;text-align:center;max-height:500px;overflow-x:hidden;overflow-y:scroll}.content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#000;line-height:22px}.content[_ngcontent-%COMP%]   .text.text3[_ngcontent-%COMP%]{margin-top:20px}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:26px;color:#1cb980;padding:12px 0;font-weight:700}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;margin-left:12px}.content[_ngcontent-%COMP%]   .btn-get-vouchers[_ngcontent-%COMP%]{display:block;margin:30px auto 0;width:318px;height:76px;line-height:76px;background:#008AFF;border-radius:16px;font-size:36px;font-weight:700;color:#fff}.content[_ngcontent-%COMP%]   .btn-continue[_ngcontent-%COMP%]{cursor:pointer;font-size:22px;font-weight:700;color:red;line-height:60px;text-align:center}.title[_ngcontent-%COMP%]{font-size:50px}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.btn-get-vouchers[_ngcontent-%COMP%]{background-color:#008aff}.btn-continue[_ngcontent-%COMP%]{border:1px solid #f3f3f3;border-radius:10px;padding:5px 10px;background:linear-gradient(270deg,#ff6009 0%,#ff8340 100%);color:#fff;margin-top:20px}"]}),o})();function pe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"div",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"img",5)(7,"img",6),e.qZA(),e.TgZ(8,"div",7)(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"button",8),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.getVouchers())}),e._uU(13),e.ALo(14,"translate"),e.qZA()()}2&o&&(e.xp6(4),e.Oqu(e.lcZ(5,3,"tip-sorry-title")),e.xp6(6),e.Oqu(e.lcZ(11,5,"verify-name-before-shopping")),e.xp6(3),e.Oqu(e.lcZ(14,7,"Now-certified")))}new e.OlP("ModalData");let ue=(()=>{class o{constructor(t,n){this.cartService=t,this.router=n,this.isOpenChange=new e.vpe,this.confirm=new e.vpe}getVouchers(){this.isOpen=!1,this.isOpenChange.emit(!1)}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(S.N),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-verify-name"]],inputs:{isOpen:"isOpen",getData:"getData",res:"res",realCashback:"realCashback",totalCashback:"totalCashback"},outputs:{isOpenChange:"isOpenChange",confirm:"confirm"},decls:2,vars:1,consts:[[3,"isOpen","didDismiss"],[1,"p-6"],[1,"flex","justify-center","items-center","mb-8","md:mb-10"],["src","assets/images/cart-stop.png","alt","",1,"h-14","md:h-20"],[1,"ml-2","text-4xl","md:text-6xl","font-extrabold","whitespace-nowrap"],["src","assets/images/shape.png","alt","",1,"-ml-10"],["src","assets/images/mascot-stop.png","alt","",1,"h-14","md:h-20"],[1,"content"],[1,"btn-continue","text-white-500","text-xl","md:text-2xl","py-2","font-bold","block","m-auto",2,"color","#FFFFFF!important",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(1,pe,15,9,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.ki,h.X$],styles:["ion-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 15px;--max-width: 550px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f5f5f5;-webkit-box-shadow:inset 0 0 3px rgba(0,0,0,.1);border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-button{background-color:#eee;display:none}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:#000}.content[_ngcontent-%COMP%]{padding:32px 35px;text-align:center;max-height:500px;overflow:hidden}.content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#000;line-height:22px}.content[_ngcontent-%COMP%]   .text.text3[_ngcontent-%COMP%]{margin-top:20px}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:26px;color:#1cb980;padding:12px 0;font-weight:700}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;margin-left:12px}.content[_ngcontent-%COMP%]   .btn-get-vouchers[_ngcontent-%COMP%]{display:block;margin:30px auto 0;width:318px;height:76px;line-height:76px;background:#008AFF;border-radius:16px;font-size:36px;font-weight:700;color:#fff}.content[_ngcontent-%COMP%]   .btn-continue[_ngcontent-%COMP%]{cursor:pointer;font-size:22px;font-weight:700;color:red;line-height:60px;text-align:center}.title[_ngcontent-%COMP%]{font-size:50px}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.btn-get-vouchers[_ngcontent-%COMP%]{background-color:#008aff}.btn-continue[_ngcontent-%COMP%]{border:1px solid #f3f3f3;border-radius:10px;padding:5px 10px;background:linear-gradient(270deg,#ff6009 0%,#ff8340 100%);color:#fff;margin-top:20px}"]}),o})();var me=r(84620),N=r(39172);function he(o,s){1&o&&(e.TgZ(0,"ion-list")(1,"ion-item",2)(2,"ion-label")(3,"h3"),e._UZ(4,"ion-skeleton-text",3)(5,"ion-skeleton-text",4),e.qZA(),e.TgZ(6,"p"),e._UZ(7,"ion-skeleton-text",5),e.qZA(),e.TgZ(8,"p"),e._UZ(9,"ion-skeleton-text",5),e.qZA(),e.TgZ(10,"p"),e._UZ(11,"ion-skeleton-text",5),e.qZA(),e.TgZ(12,"p"),e._UZ(13,"ion-skeleton-text",5),e.qZA()()()()),2&o&&(e.xp6(4),e.Q6J("animated",!0),e.xp6(1),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}function _e(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8)(5,"div",9),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",10),e._uU(9),e.ALo(10,"currency"),e.qZA()(),e.TgZ(11,"div",11),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._UZ(14,"div",12),e.TgZ(15,"div",13)(16,"div",14),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div",15),e._uU(20),e.ALo(21,"currency"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",15),e._uU(27),e.ALo(28,"currency"),e.qZA()(),e._UZ(29,"div",12),e.TgZ(30,"div",13)(31,"div",14),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",16),e._uU(35),e.ALo(36,"currency"),e.qZA()(),e.TgZ(37,"button",17),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.pay())}),e._uU(38),e.ALo(39,"translate"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,11,"store-credit")," "),e.xp6(4),e.hij(" ",e.lcZ(7,13,"store-credit-my-credit")," "),e.xp6(3),e.Oqu(e.lcZ(10,15,null==t.user?null:t.user.balance)),e.xp6(3),e.hij(" ",e.lcZ(13,17,"checkout-payment-methods-balance")," "),e.xp6(5),e.Oqu(e.lcZ(18,19,"balance-details-current-balance")),e.xp6(3),e.Oqu(e.lcZ(21,21,null==t.user?null:t.user.balance)),e.xp6(4),e.Oqu(e.lcZ(25,23,"checkout-balance-use")),e.xp6(3),e.Oqu(e.lcZ(28,25,t.amount)),e.xp6(5),e.Oqu(e.lcZ(33,27,"checkout-balance-remaining")),e.xp6(3),e.Oqu(e.lcZ(36,29,t.remaining)),e.xp6(3),e.Oqu(e.lcZ(39,31,"checkout-balance-confirm"))}}let fe=(()=>{class o extends D.V{constructor(t){super(),this.userService=t,this.confirm=new e.vpe,this.loading={pay:!1}}ngOnInit(){this.userService.userInfo$.pipe((0,b.R)(this.destroyStream$)).subscribe(t=>{this.user=t})}get remaining(){return(this.user?.balance||0)-(this.amount||0)}get cannotPay(){return this.remaining<0}pay(){this.confirm.emit(),this.loading.pay=!0}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(B.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-pay-by-balance"]],inputs:{amount:"amount"},outputs:{confirm:"confirm"},features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["unloading",""],["lines","none"],[2,"width","30%","height","15px",3,"animated"],[2,"width","100%","height","45px",3,"animated"],[2,"width","100%","height","15px",3,"animated"],[1,""],[1,"font-bold","text-3xl"],[1,"border-2","border-black","p-2","rounded-lg","text-center","my-2"],[1,"mb-2","font-bold"],[1,"text-3xl","font-bold"],[1,"text-2xl","font-bold"],[1,"border-b","border-[#dddddd]","my-2"],[1,"flex","justify-between","items-center"],[1,"font-medium","opacity-60","text-base","sm:text-xl","mr-2"],[1,"text-lg","sm:text-2xl","opacity-70","font-bold","whitespace-nowrap"],[1,"text-2xl","sm:text-3xl","font-medium","whitespace-nowrap"],[1,"text-4xl","font-bold","py-4","w-full","text-center","rounded-md","mt-4",3,"click"]],template:function(t,n){if(1&t&&(e.YNc(0,he,14,6,"ion-list",0),e.YNc(1,_e,40,33,"ng-template",null,1,e.W1O)),2&t){const i=e.MAs(2);e.Q6J("ngIf",n.loading.pay)("ngIfElse",i)}},dependencies:[d.O5,c.Ie,c.Q$,c.q_,c.CK,d.H9,h.X$],styles:["button[_ngcontent-%COMP%]{background-color:#fbdf45}button[disabled][_ngcontent-%COMP%]{opacity:.5}"]}),o})();const ge=["methodsCard"],xe=["methodsCrypto"],Ce=["methodsDomestic"];function ye(o,s){if(1&o&&e._UZ(0,"app-cart-item",45),2&o){const t=s.$implicit;e.Q6J("readonly",!0)("cartItem",t)}}function be(o,s){if(1&o&&(e.TgZ(0,"div")(1,"div",46),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div",47),e._uU(8),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.selectedReceiver.consignee," "),e.xp6(2),e.Oqu(t.selectedReceiver.phone),e.xp6(2),e.Oqu(t.selectedReceiver.address),e.xp6(2),e.Oqu(t.selectedReceiver.zipCode)}}function ve(o,s){1&o&&(e.TgZ(0,"div",48),e._UZ(1,"img",49),e.TgZ(2,"div",50),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"checkout-shipping-empty-tips")," "))}function Oe(o,s){1&o&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"checkout-statistics-shipping-free")," "))}function Ze(o,s){if(1&o&&(e.TgZ(0,"div",57),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t.orderSum?null:t.orderSum.totalSumFreight)," ")}}function ke(o,s){1&o&&e._UZ(0,"img",76)}function Ae(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlePayUsingBalanceClick(i.paymentMethodsEnum.CARD))}),e.TgZ(1,"div",66)(2,"div",67),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",72),e.YNc(6,ke,1,0,"img",73),e._UZ(7,"img",74)(8,"img",75),e.qZA()(),e._UZ(9,"div",69),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(3),e.hij(" ",e.lcZ(4,2,"checkout-payment-methods-card")," "),e.xp6(3),e.Q6J("ngIf",!t.isWechat)}}function Te(o,s){1&o&&e._UZ(0,"img",76)}function Me(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.handlePayUsingBalanceClick(i.paymentMethodsEnum.DOMESTIC))}),e.TgZ(1,"div",66)(2,"div",67),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",72),e.YNc(6,Te,1,0,"img",73),e._UZ(7,"img",74),e.qZA()(),e._UZ(8,"div",69),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(3),e.hij(" ",e.lcZ(4,2,"Online Payment")," "),e.xp6(3),e.Q6J("ngIf",!t.isWechat)}}function Pe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",51)(2,"div",52),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",53),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e._UZ(8,"div",54),e.TgZ(9,"div",55)(10,"div",56),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",57),e._uU(14),e.ALo(15,"currency"),e.qZA()(),e.TgZ(16,"div",55)(17,"div",56),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.YNc(20,Oe,3,3,"div",58),e.YNc(21,Ze,3,3,"ng-template",null,59,e.W1O),e.qZA(),e.TgZ(23,"div",55)(24,"div",56),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"div",60)(28,"span"),e._uU(29),e.ALo(30,"currency"),e.qZA(),e._UZ(31,"img",24),e.qZA()(),e.TgZ(32,"div",55)(33,"div",61),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.TgZ(36,"div",62),e._uU(37),e.ALo(38,"currency"),e.qZA()(),e._UZ(39,"div",63),e.TgZ(40,"div",64),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.TgZ(43,"button",65),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.handlePayUsingBalanceClick(i.paymentMethodsEnum.BALANCE))}),e.TgZ(44,"div",66)(45,"div",67),e._uU(46),e.ALo(47,"translate"),e.qZA(),e.TgZ(48,"div",68),e._uU(49),e.ALo(50,"currency"),e.qZA()(),e._UZ(51,"div",69),e.qZA(),e.YNc(52,Ae,10,4,"button",70),e.YNc(53,Me,9,4,"button",70),e.qZA()}if(2&o){const t=e.MAs(22),n=e.oxw(2);e.xp6(3),e.hij(" ",e.lcZ(4,17,"checkout-order-total")," "),e.xp6(3),e.AsE(" ",n.cartList.length||0," ",e.lcZ(7,19,"checkout-items")," "),e.xp6(5),e.hij(" ",e.lcZ(12,21,"checkout-statistics-subtotal")," "),e.xp6(3),e.hij(" ",e.lcZ(15,23,null==n.orderSum?null:n.orderSum.originalPrice)," "),e.xp6(4),e.hij(" ",e.lcZ(19,25,"checkout-statistics-shipping")," "),e.xp6(2),e.Q6J("ngIf",0===(null==n.orderSum?null:n.orderSum.totalSumFreight))("ngIfElse",t),e.xp6(5),e.hij(" ",e.lcZ(26,27,"tqc-discount-credits-v1-1")," "),e.xp6(4),e.hij("-",e.lcZ(30,29,null==n.orderSum?null:n.orderSum.toTalTQC),""),e.xp6(5),e.hij(" ",e.lcZ(35,31,"checkout-statistics-total"),": "),e.xp6(3),e.hij(" ",e.lcZ(38,33,null==n.orderSum?null:n.orderSum.totalSumPrice)," "),e.xp6(4),e.hij(" ",e.lcZ(42,35,"checkout-select-payment-methods")," "),e.xp6(5),e.hij(" ",e.lcZ(47,37,"checkout-payment-methods-balance")," "),e.xp6(3),e.hij(" ",e.lcZ(50,39,null==n.userInfo?null:n.userInfo.balance)," "),e.xp6(3),e.Q6J("ngIf",!n.isShowDomesticPaymentMethods),e.xp6(1),e.Q6J("ngIf",n.isShowDomesticPaymentMethods)}}const Se=function(o){return{"address-btn":o}};function we(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"h1",16),e._UZ(5,"app-top-back-button"),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e._UZ(9,"div",17),e.YNc(10,ye,1,2,"app-cart-item",18),e._UZ(11,"div")(12,"div",19),e.TgZ(13,"div",20)(14,"div",21),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",22)(18,"span",23),e._uU(19),e.ALo(20,"currency"),e.qZA(),e._UZ(21,"img",24),e.qZA()()(),e.TgZ(22,"div",25)(23,"div",26)(24,"div",21),e.O4$(),e.TgZ(25,"svg",27),e._UZ(26,"path",28),e.qZA()(),e.kcU(),e.TgZ(27,"div"),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e._UZ(30,"div",29),e.TgZ(31,"div",30)(32,"div",31),e.YNc(33,be,9,4,"div",32),e.YNc(34,ve,5,3,"ng-template",null,33,e.W1O),e.qZA(),e.TgZ(36,"div",34)(37,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openEditAddressModal())}),e._UZ(38,"img",36),e.TgZ(39,"div",37),e._uU(40),e.ALo(41,"translate"),e.qZA()(),e.TgZ(42,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.isOpenChangeAddressModal=!0)}),e._UZ(43,"img",38),e.TgZ(44,"div",39),e._uU(45),e.ALo(46,"translate"),e.qZA()(),e.TgZ(47,"button",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openCreateAddressModal())}),e.TgZ(48,"div",41),e._uU(49,"+"),e.qZA(),e.TgZ(50,"div",37),e._uU(51),e.ALo(52,"translate"),e.qZA()()()()()(),e.TgZ(53,"div",42)(54,"div",43),e.YNc(55,Pe,54,41,"div",32),e.qZA()()(),e._UZ(56,"div",44),e.qZA()}if(2&o){const t=e.MAs(35),n=e.oxw(),i=e.MAs(9);e.xp6(7),e.Oqu(e.lcZ(8,16,"checkout-page-title")),e.xp6(3),e.Q6J("ngForOf",n.cartList)("ngForTrackBy",n.identify),e.xp6(5),e.hij(" ",e.lcZ(16,18,"tqc-total-discount-credits-v1-1"),": "),e.xp6(4),e.hij("-",e.lcZ(20,20,null==n.orderSum?null:n.orderSum.toTalTQC),""),e.xp6(9),e.hij(" ",e.lcZ(29,22,"checkout-shipping")," "),e.xp6(5),e.Q6J("ngIf",n.selectedReceiver)("ngIfElse",t),e.xp6(4),e.Q6J("disabled",!n.selectedAddress),e.xp6(3),e.hij(" ",e.lcZ(41,24,"checkout-shipping-edit")," "),e.xp6(2),e.Q6J("disabled",!(null!=n.shippingAddrs&&n.shippingAddrs.length)),e.xp6(3),e.hij(" ",e.lcZ(46,26,"checkout-shipping-change")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(30,Se,!n.selectedAddress)),e.xp6(4),e.hij(" ",e.lcZ(52,28,"checkout-shipping-add")," "),e.xp6(4),e.Q6J("ngIf",!n.selectedPaymentMethod)("ngIfElse",i)}}function Le(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-pay-by-balance",82),e.NdJ("confirm",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.confirmOrder())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Ie(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-payment-methods-crypto",83,84),e.NdJ("select",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.payWithCrypto())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function qe(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-payment-methods-card",83,85),e.NdJ("select",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.payWithCard())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Ue(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-payment-methods-domestic",83,86),e.NdJ("select",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.payWithDomestic())}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Ee(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",77)(1,"div",78),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.selectedPaymentMethod=null)}),e._UZ(2,"div",79),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"translate"),e.qZA()()(),e.YNc(6,Le,1,1,"app-pay-by-balance",80),e.YNc(7,Ie,2,1,"app-payment-methods-crypto",81),e.YNc(8,qe,2,1,"app-payment-methods-card",81),e.YNc(9,Ue,2,1,"app-payment-methods-domestic",81)}if(2&o){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,5,"checkout-payment-methods-change")),e.xp6(2),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.BALANCE),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.CRYPTO),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.CARD),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.DOMESTIC)}}function Be(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-edit-address-modal",87),e.NdJ("onSuccess",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.handleSubmitAddressSuccess())})("isOpenChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.isOpenEditAddressModal=i)}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("currAddress",t.currAddress)("isOpen",t.isOpenEditAddressModal)}}function De(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"app-change-address-modal",88),e.NdJ("addNewAddress",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.openCreateAddressModal())})("onSelected",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSelectAddress(i))})("isOpenChange",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.isOpenChangeAddressModal=i)}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("selectedAddress",t.selectedReceiver||null)("addressList",t.shippingAddrs)("isOpen",t.isOpenChangeAddressModal)}}let Ne=(()=>{class o extends J.c{constructor(t,n,i,a,f,u,y,Z,L,I){super(t,n),this.route=i,this.cartService=a,this.userService=f,this.voucherService=u,this.checkoutService=y,this.productService=Z,this.toast=L,this.router=I,this.payMethodId="52",this.isOpenEditAddressModal=!1,this.isOpenBalanceModal=!1,this.isOpenChangeAddressModal=!1,this.isOpenDepositModal=!1,this.selectedItems={},this.pointStatistic=null,this.cartList=[],this.originalCartList=null,this.voucher=null,this.userInfo=null,this.shippingAddrs=null,this.selectedAddress=null,this.currAddress=null,this.orderSum=null,this.paymentType=l.Lt,this.isOpenProfileModal=!1,this.stores=[],this.productList=[],this.paymentMethodsEnum=l.Lt,this.selectedPlatformCode=this.paymentType.BALANCE,this.isOpenOutOfStock=!1,this.isAuthModalShown=!1,this.isShown=!1,this.isShowDomesticPaymentMethods=!1,this.isWechat=!1}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.isWechat=(0,P.IS)(),F.Z.isServer||(t.route.queryParams.pipe((0,b.R)(t.destroyStream$)).subscribe(n=>{t.selectedItems=JSON.parse(decodeURIComponent(atob(n.o))),t.productList=JSON.parse(decodeURIComponent(atob(n.o))),console.log(t.productList),t.productList instanceof Array&&("1"===t.productList[0].skuId||"2"===t.productList[0].skuId)?(t.skuProduct(),t.filterCartList()):t.reorderProduct()}),t.cartService.cartList$.pipe((0,b.R)(t.destroyStream$)).subscribe(n=>{t.originalCartList=n,t.filterCartList()}),t.userService.pointStatistic$.pipe((0,b.R)(t.destroyStream$)).subscribe(n=>{t.pointStatistic=n}),t.userService.userInfo$.pipe((0,b.R)(t.destroyStream$)).subscribe(n=>{t.userInfo=n}),yield t.getShippingAddress())})()}get productOrder(){return this.productList instanceof Array?this.productList.reduce((t,n)=>(t.push(...n.productOrder.map(i=>({skuId:i.skuId,quantity:i.quantity}))),t),[]):[]}get selectedReceiver(){if(this.receiverId)return this.shippingAddrs.find(t=>Object.is(t.id,this.receiverId))}skuProduct(){var t=this;return(0,m.Z)(function*(){t.productService.getSkuById([t.productList[0].skuId]).pipe().subscribe(n=>{t.productList.forEach(i=>{t.productList=i})}),t.cartList=t.productList,t.getOrderSum()})()}reorderProduct(){var t=this;return(0,m.Z)(function*(){t.productService.getSkuById(t.productOrder.map(n=>n.skuId)).pipe().subscribe(n=>{t.productList.forEach(a=>{a.productOrder.forEach(f=>{const u=n.find(Z=>Object.is(Z.id,f.skuId));if(!u)return;const y=JSON.parse(u.specificationValues||"[]");Object.assign(f,{...u,productImages:[{thumbnail:f.cover}],skuPrice:u.price,skuStock:u.stock,skuSpec:y&&y.length>0?y.reduce((Z,L,I)=>`${Z+L.value}${Object.is(y.length-1,I)?"]":","}`,"["):""})})});const i=[];t.productList[0].productOrder.forEach(a=>{i.push(a)}),t.productList=i,t.cartList=t.productList,t.getOrderSum()})})()}getShippingAddress(t){var n=this;return(0,m.Z)(function*(){if(n.shippingAddrs=(yield(0,C.n)(n.checkoutService.getShippingAddress()))?.data?.rows||null,n.shippingAddrs?.length){n.selectedAddress=n.shippingAddrs[n.shippingAddrs.length-1];const i=n.shippingAddrs.find(a=>a.isDefault)||n.shippingAddrs[0];if(t)return void(n.receiverId=n.shippingAddrs[n.shippingAddrs.length-1].id);n.receiverId=n.editAddressId?n.editAddressId:i.id}n.getOrderSum()})()}showVerification(){this.isShown=!0}goCart(){this.isShown=!1,setTimeout(()=>{this.router.navigate(["/cart"])},500)}getOrderSum(){var t=this;return(0,m.Z)(function*(){!t.cartList?.length||!t.selectedReceiver||(t.orderSum=yield(0,C.n)(t.checkoutService.getOrderSum({address:t.selectedReceiver?.address||"",areaId:t.selectedReceiver?.areaId||"0",productOrder:t.cartList?.map(n=>({skuId:n.skuId,quantity:n.quantity}))||[],useBalance:!1,usePoint:!1,receiverId:t.selectedReceiver?.id||"0"})),console.log(t.orderSum),t.orderSum.isIdentify&&(t.isAuthModalShown=!0),t.isShowDomesticPaymentMethods=t.orderSum.isOpenUpDomesticPaymentMethods)})()}filterCartList(){var t=this;return(0,m.Z)(function*(){if("1"===t.productList[0]?.skuId||"2"===t.productList[0]?.skuId)return;if(!t.originalCartList||!t.selectedItems)return t.cartList=[],void(t.voucher=null);const n=t.originalCartList?.filter(u=>t.selectedItems[u.cartItemId])||null;let i=n.map(u=>u.skuId);const f=(yield(0,C.n)(t.productService.getSkuById(i||[]))).reduce((u,y)=>(u[y.id]=y,u),{});t.cartList=n.map(u=>({...u,...f[u.skuId]||{}})),t.voucher=t.cartList?.find(u=>u.skuId===t.voucherService.skuId)||null,t.productList[0]&&t.productList[0].specifications&&(t.cartList=t.productList),t.getOrderSum()})()}identify(t,n){return n.cartItemId}openEditAddressModal(){this.currAddress=this.selectedReceiver,this.isOpenEditAddressModal=!0}openCreateAddressModal(){this.currAddress=null,this.isCreateAddress=!0,this.isOpenEditAddressModal=!0}handleSubmitAddressSuccess(){var t=this;return(0,m.Z)(function*(){if(t.isCreateAddress)return yield t.getShippingAddress(!0),yield t.getOrderSum(),t.isOpenEditAddressModal=!1,void(t.isCreateAddress=!1);t.editAddressId=t.receiverId,yield t.getShippingAddress(),t.isOpenEditAddressModal=!1,t.editAddressId=""})()}handleSelectAddress(t){this.receiverId=t.id,this.getOrderSum()}get showReceiver(){return this.cartList?.some(t=>[M.k.ShopProductTypeByGeneral,M.k.ShopProductTypeByExchange,M.k.ShopProductTypeByGiftP].includes(t.productType))}get productOrderDetail(){return this.stores.reduce((t,n)=>(t.push(...n.productOrder.map(i=>({skuId:i.skuId,quantity:i.quantity,productName:i.productName,cover:i.cover}))),t),[])}handlePayUsingBalanceClick(t){this.userInfo?.email&&this.userInfo?.mobile?!this.showReceiver||this.selectedReceiver?t==this.paymentMethodsEnum.BALANCE&&this.orderSum?.totalSumPrice-(this.userInfo?.balance||0)>0||t==this.paymentMethodsEnum.CRYPTO?this.isOpenDepositModal=!0:this.changePaymentMethods(t):this.toastError((this.shippingAddrs?.length||0)<3?"\u8bf7\u6dfb\u52a0\u6536\u8d27\u5730\u5740":"\u8bf7\u9009\u62e9\u6536\u8d27\u5730\u5740"):this.isOpenProfileModal=!0}changePaymentMethods(t){if(!this.showReceiver||this.selectedReceiver)switch(this.selectedPaymentMethod=t,t){case l.Lt.BALANCE:this.selectedPaymentMethods=l.mJ.BALANCE;break;case l.Lt.CARD:this.selectedPaymentMethods=l.mJ.CARD;break;case l.Lt.CRYPTO:this.selectedPaymentMethods=l.mJ.CRYPTO}else this.openCreateAddressModal()}payWithCard(){this.selectedPlatformCode=this.paymentMethodsEnum.CARD,this.confirmOrder()}payWithCrypto(){this.selectedPlatformCode=this.paymentMethodsEnum.CRYPTO,this.confirmOrder()}payWithDomestic(){this.selectedPlatformCode=this.paymentMethodsEnum.DOMESTIC,this.confirmOrder()}confirmOrder(){var t=this;return(0,m.Z)(function*(){const n=yield(0,C.n)(t.checkoutService.lockOrder({shippingMethodId:"1",receiverId:t.selectedReceiver?.id||"0",payMethodId:t.payMethodId,fapiao:null,productOrder:t.cartList?.map(i=>({skuId:i.skuId,quantity:i.quantity}))||[],usePoint:!1,useBalance:t.selectedPaymentMethod===l.Lt.BALANCE,memo:""}));try{0===n.code?(console.log(n),0===n.code?(t.sn=n.data,t.queryLockOrder()):1001035===n.code||1001036===n.code||1001037===n.code?t.isAuthModalShown=!0:t.toastError(n?.message)):t.toastError(n?.message)}catch{}})()}queryLockOrder(){var t=this;return(0,m.Z)(function*(){clearTimeout(t.queryLockOrderSetTimeout);const n=yield(0,C.n)(t.checkoutService.queryLockOrder(t.sn));try{if(n)switch(console.log(n),n.data.status){case l.g1.Pending:t.queryLockOrderSetTimeout=setTimeout(()=>{t.queryLockOrder()},2e3);break;case l.g1.Success:t.submitLockOrder(n.data.id.toString());break;case l.g1.Fail:t.querysubmitOrder()}}catch(i){t.toastError(i?.message)}})()}querysubmitOrder(){var t=this;return(0,m.Z)(function*(){const n=yield(0,C.n)(t.checkoutService.querySubmitOrder(t.sn));n&&(t.isOpenOutOfStock=!0,t.outOfStockData=n.data,t.outOfReturnData=t.cartList,console.log(t.outOfReturnData))})()}submitLockOrder(t){var n=this;return(0,m.Z)(function*(){console.log(t);const i=yield(0,C.n)(n.checkoutService.submitLockOrder({sn:n.sn}));try{0==i.code&&(yield n.lockOrderPayment(t))}catch(a){n.toastError(a?.message)}})()}lockOrderPayment(t){var n=this;return(0,m.Z)(function*(){switch(n.selectedPaymentMethod){case l.Lt.BALANCE:const i=yield(0,C.n)(n.checkoutService.balancePayment({orderId:t}));switch(0!==i.code&&n.toastError(i?.message),i.code){case 0:yield(0,C.n)(n.cartService.getCartItem()),n.cartService.refresh=!0,n.userService.updateUserInfo(),n.toastSuccess("\u652f\u4ed8\u6210\u529f"),n.router.navigate(["/order/success"]);break;case 1008013:n.userService.updateUserInfo(),n.isOpenBalanceModal=!0;break;case 1008028:case 1008027:n.router.navigate(["/member/order/detail"],{queryParams:{id:t},replaceUrl:!0});break;case 4001013:case 1008015:n.router.navigate(["/order/success"],{replaceUrl:!0})}break;case l.Lt.CARD:n.methodsCard.confirm(t,l.ri.ORDER);break;case l.Lt.CRYPTO:n.methodsCrypto.confirm(t,l.ri.ORDER);break;case l.Lt.DOMESTIC:n.methodsDomestic.confirm(t,l.ri.ORDER)}})()}toastError(t){var n=this;return(0,m.Z)(function*(){yield n.presentToast({position:"bottom",message:t,icon:"alert-circle-outline",duration:1e3,color:"danger"})})()}toastSuccess(t){var n=this;return(0,m.Z)(function*(){yield n.presentToast({position:"bottom",message:t,duration:1e3,icon:"checkmark-circle-outline",color:"success"})})()}presentToast(t){var n=this;return(0,m.Z)(function*(){yield(yield n.toast.create(t)).present()})()}get profileModalContent(){return`\u8bf7\u5148\u7ed1\u5b9a${this.userInfo?.phone?"":"\u624b\u673a\u53f7"}${this.userInfo?.phone||this.userInfo?.email?"":"\u548c"}${this.userInfo?.email?"":"\u90ae\u7bb1"}`}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(_.gz),e.Y36(S.N),e.Y36(B.K),e.Y36(R.H),e.Y36(w.Z),e.Y36(j.s),e.Y36(c.yF),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-checkout-confirm"]],viewQuery:function(t,n){if(1&t&&(e.Gf(ge,5),e.Gf(xe,5),e.Gf(Ce,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.methodsCard=i.first),e.iGM(i=e.CRH())&&(n.methodsCrypto=i.first),e.iGM(i=e.CRH())&&(n.methodsDomestic=i.first)}},features:[e.qOj],decls:18,vars:16,consts:[["scrollTop","","fullscreen","true","scrollEvents","true","backToTopBtn","",3,"ionScroll"],["appOverflowVisible","",1,"sticky","top-0","shadow-lg","z-50","md:hidden"],["header",""],[3,"hideCart","hideSearch","hideLogo","hidePageName"],[1,"grey-bg","md:pt-4"],["class","tyqoon-container h-full flex flex-col",4,"ngIf"],["paymentMethod",""],[3,"currAddress","isOpen","onSuccess","isOpenChange",4,"ngIf"],[3,"selectedAddress","addressList","isOpen","addNewAddress","onSelected","isOpenChange",4,"ngIf"],[3,"isOpen","isOpenChange"],[3,"modalContent","isOpen","isOpenChange"],[3,"isOpen","res","getData","isOpenChange"],[1,"tyqoon-container","h-full","flex","flex-col"],[1,"flex","flex-wrap"],[1,"w-full","lg:w-8/12","lg:pr-4","my-2"],[1,"px-2","md:px-4","pt-4","pb-0","md:pb-4","md:rounded-xl","md:bg-white"],[1,"font-medium","text-2xl","hidden","md:flex","items-center"],[1,"border-b","border-[#dddddd]","mt-4","mb-2","hidden","md:block"],["class","mb-2 -mx-2 md:-mx-4 block bg-white",3,"readonly","cartItem",4,"ngFor","ngForOf","ngForTrackBy"],[1,"border-b","border-[#dddddd]","my-4","hidden","md:block"],[1,"hidden","md:flex","items-center","text-2xl","font-medium","flex-wrap"],[1,"mr-2"],[1,"flex","items-center"],[1,"yellow"],["src","assets/images/circle-credit-small.png","alt","",1,"ml-2","h-6"],[1,"px-2","md:px-4","py-4","md:rounded-xl","bg-white","mt-4","mb-10"],[1,"font-medium","text-2xl","flex","justify-center","md:justify-start","items-center"],["viewBox","0 0 12 16",1,"fill-[#3387FF]","icon-location-marker","h-6"],["d","M6 3.2c1.506 0 2.727 1.195 2.727 2.667 0 1.473-1.22 2.666-2.727 2.666S3.273 7.34 3.273 5.867C3.273 4.395 4.493 3.2 6 3.2zM0 6c0-3.315 2.686-6 6-6s6 2.685 6 6c0 2.498-1.964 5.742-6 9.933C1.613 11.743 0 8.498 0 6z","fill-rule","evenodd"],[1,"border-b","border-[#dddddd]","my-4"],[1,"flex"],[1,"w-10/12","sm:w-8/12"],[4,"ngIf","ngIfElse"],["noAddress",""],[1,"w-2/12","sm:w-4/12"],[1,"w-full","rounded-md","bg-[#dddddd]","py-3","mb-2","flex","justify-center","sm:justify-start","items-center","px-2",3,"disabled","click"],["src","assets/images/address-icon-edit.png","alt","",1,"h-4"],[1,"flex-1","text-center","font-bold","hidden","sm:block"],["src","assets/images/address-change.png","alt","",1,"h-4"],[1,"flex-1","font-bold","text-center","hidden","sm:block"],[1,"w-full","rounded-md","bg-[#dddddd]","py-3","flex","justify-center","sm:justify-start","items-center","px-2",3,"ngClass","click"],[1,"text-3xl","font-extrabold","leading-4"],[1,"w-full","lg:w-4/12","my-2"],[1,"px-2","md:px-4","py-4","md:rounded-xl","bg-white","mb-4","lg:sticky","top-4"],[1,"flex","items-center","justify-center","md:justify-end","mt-2"],[1,"mb-2","-mx-2","md:-mx-4","block","bg-white",3,"readonly","cartItem"],[1,"text-primary","font-medium","text-lg"],[1,"opacity-50"],[1,"text-center"],["src","assets/images/no-address-found.png","alt","",1,"h-24","opacity-10","m-auto","mb-2"],[1,"opacity-70"],[1,"flex","justify-between"],[1,"text-center","text-2xl","font-medium"],[1,"text-center","text-2xl"],[1,"border-b","border-[#dddddd]","my-1.5","md:my-4"],[1,"flex","justify-between","mb-2"],[1,"font-medium","opacity-60","text-base","sm:text-xl"],[1,"text-lg","sm:text-2xl","opacity-70","font-bold","whitespace-nowrap"],["class","text-lg sm:text-2xl opacity-70 font-bold whitespace-nowrap",4,"ngIf","ngIfElse"],["freight",""],[1,"text-lg","sm:text-2xl","yellow","font-bold","whitespace-nowrap","flex","items-center"],[1,"font-medium","text-xl","sm:text-3xl"],[1,"text-2xl","sm:text-3xl","font-medium","whitespace-nowrap"],[1,"border-b","border-[#dddddd]","mt-1.5","mb-3","md:!my-4"],[1,"text-center","text-xl","font-medium","mb-2"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center","mb-2",3,"click"],[1,"flex-1","xs:ml-2"],[1,"text-base"],[1,"font-bold","text-2xl","leading-7"],[1,"cavet","mr-2","hidden","xs:block"],["class","w-full bg-gradient-primary p-1.5 text-center text-white rounded-md flex items-center",3,"click",4,"ngIf"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center",3,"click"],[1,"flex","justify-center","items-center","h-7","overflow-hidden"],["class","h-6 flex-shrink","src","assets/images/payment-alipay-white-min.png","alt","",4,"ngIf"],["src","assets/images/payment-wechatpay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-alipay-white-min.png","alt","",1,"h-6","flex-shrink"],[1,"flex","mb-2"],[1,"flex","items-center","bg-[#dddddd]","rounded","py-1","px-2","cursor-pointer",3,"click"],[1,"back-cavet","mr-2","font-medium"],[3,"amount","confirm",4,"ngIf"],[3,"amount","select",4,"ngIf"],[3,"amount","confirm"],[3,"amount","select"],["methodsCrypto",""],["methodsCard",""],["methodsDomestic",""],[3,"currAddress","isOpen","onSuccess","isOpenChange"],[3,"selectedAddress","addressList","isOpen","addNewAddress","onSelected","isOpenChange"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0),e.NdJ("ionScroll",function(a){return n.onContentScroll(a)}),e._UZ(1,"app-global-customer-service"),e.TgZ(2,"ion-toolbar",1,2),e._UZ(4,"app-top-navbar",3)(5,"app-top-menu"),e.qZA(),e.TgZ(6,"div",4),e.YNc(7,we,57,32,"div",5),e.qZA()(),e.YNc(8,Ee,10,7,"ng-template",null,6,e.W1O),e.YNc(10,Be,1,2,"app-edit-address-modal",7),e.YNc(11,De,1,3,"app-change-address-modal",8),e.TgZ(12,"app-deposit-credit-modal",9),e.NdJ("isOpenChange",function(a){return n.isOpenDepositModal=a}),e.qZA(),e.TgZ(13,"app-bind-email-phone-modal",10),e.NdJ("isOpenChange",function(a){return n.isOpenProfileModal=a}),e.qZA(),e.TgZ(14,"app-insufficient-balance-modal",9),e.NdJ("isOpenChange",function(a){return n.isOpenBalanceModal=a}),e.qZA(),e.TgZ(15,"app-out-of-stock",11),e.NdJ("isOpenChange",function(a){return n.isOpenOutOfStock=a}),e.qZA(),e.TgZ(16,"app-verify-name",9),e.NdJ("isOpenChange",function(a){return n.isAuthModalShown=a})("isOpenChange",function(){return n.showVerification()}),e.qZA(),e.TgZ(17,"app-verification-modal",9),e.NdJ("isOpenChange",function(a){return n.isShown=a})("isOpenChange",function(){return n.goCart()}),e.qZA()),2&t&&(e.xp6(4),e.Q6J("hideCart",!0)("hideSearch",!0)("hideLogo",!0)("hidePageName",!1),e.xp6(3),e.Q6J("ngIf",n.cartList),e.xp6(3),e.Q6J("ngIf",n.isOpenEditAddressModal),e.xp6(1),e.Q6J("ngIf",n.isOpenChangeAddressModal),e.xp6(1),e.Q6J("isOpen",n.isOpenDepositModal),e.xp6(1),e.Q6J("modalContent",n.profileModalContent)("isOpen",n.isOpenProfileModal),e.xp6(1),e.Q6J("isOpen",n.isOpenBalanceModal),e.xp6(1),e.Q6J("isOpen",n.isOpenOutOfStock)("res",n.outOfStockData)("getData",n.outOfReturnData),e.xp6(1),e.Q6J("isOpen",n.isAuthModalShown),e.xp6(1),e.Q6J("isOpen",n.isShown))},dependencies:[Y.N,Q.t,X,ee.F,d.mk,d.sg,d.O5,te.p,ne.z,oe.V,ie.H,se.h,re.B,ae.Z,le,ue,me.E,c.W2,c.sr,U.n,N.c,E.u,x,O,fe,d.H9,h.X$],styles:["ion-content[_ngcontent-%COMP%]{--background: #F8F8F8}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.yellow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#f8ae02}.cavet[_ngcontent-%COMP%]{width:16px;height:16px;border-top:3px solid white;border-right:3px solid white;transform:rotate(45deg)}.address-btn[_ngcontent-%COMP%]{background-color:#fbdf45}button[disabled][_ngcontent-%COMP%]{opacity:.3}ion-toolbar[appOverflowVisible][_ngcontent-%COMP%]{contain:none}app-top-back-button[_ngcontent-%COMP%]{cursor:pointer}app-top-back-button[_ngcontent-%COMP%]     svg{height:36px}.back-cavet[_ngcontent-%COMP%]{width:12px;height:12px;border-top:3px solid black;border-right:3px solid black;transform:rotate(-135deg)}"]}),o})(),Je=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[A.g,d.ez,T.m,c.Pc,h.aw,U.n,N.c,E.u,x,O,_.Bz.forChild([{path:"",component:Ne}])]}),o})()},18215:(q,v,r)=>{r.d(v,{Z:()=>e});var d=r(94650),_=r(12163),c=r(54463);function h(g,p){if(1&g){const x=d.EpF();d.TgZ(0,"div",0)(1,"button",1),d.NdJ("click",function(){const A=d.CHM(x).method,T=d.oxw();return d.KtG(T.handleBtnClick(A))}),d._UZ(2,"img",2),d.TgZ(3,"div",3),d._uU(4),d.ALo(5,"translate"),d.qZA()()()}2&g&&(d.xp6(4),d.Oqu(d.lcZ(5,1,"toolkit-official-button")))}let e=(()=>{class g{constructor(){}handleBtnClick(x){x(this.additionalData)}}return g.\u0275fac=function(x){return new(x||g)},g.\u0275cmp=d.Xpm({type:g,selectors:[["app-global-customer-service"]],inputs:{additionalData:"additionalData"},decls:2,vars:0,consts:[[1,"hidden","md:block","rounded-l-2xl","border-y","border-l","border-solid","border-[#e9e9e9]","py-4","px-2","bg-white","shadow-xl","absolute","right-0","w-16","transform","-translate-y-1/2",2,"z-index","999"],[1,"inline",3,"click"],["src","assets/images/toolkit-item1.png","alt","",1,"m-auto","h-10","mb-1"],[1,"text-xs","font-light","text-center"]],template:function(x,k){1&x&&(d.TgZ(0,"app-customer-service"),d.YNc(1,h,6,3,"ng-template"),d.qZA())},dependencies:[_.M,c.X$],styles:["[_nghost-%COMP%]{position:sticky;top:50%;right:0;z-index:100;display:block}"]}),g})()},45210:(q,v,r)=>{r.d(v,{B:()=>h});var d=r(15861),_=r(24837),c=r(94650);let h=(()=>{class e{constructor(p){this.el=p,this.myValue=!0,this.content=p.nativeElement}ngAfterViewInit(){var p=this;return(0,d.Z)(function*(){_.Z.isServer||(p.btn=document.createElement("button"),p.btn.innerHTML='\n    <svg class="icon__arrow-up" viewBox="0 0 24 24">\n      <title>Back to top</title>\n      <path d="M18.71,11.71a1,1,0,0,1-1.42,0L13,7.41V19a1,1,0,0,1-2,0V7.41l-4.29,4.3a1,1,0,0,1-1.42-1.42l6-6a1,1,0,0,1,1.42,0l6,6A1,1,0,0,1,18.71,11.71Z"/>\n    </svg>',p.btn.classList.add("back-to-top-btn"),p.btn.addEventListener("click",()=>{p.content.scrollToTop(500)}),document.body.appendChild(p.btn),p.el.nativeElement.append(p.btn))})()}onScroll(p){p.detail.scrollTop>200?this.btn.classList.add("show-btn"):this.btn.classList.remove("show-btn")}}return e.\u0275fac=function(p){return new(p||e)(c.Y36(c.SBq))},e.\u0275dir=c.lG2({type:e,selectors:[["","backToTopBtn",""]],hostVars:1,hostBindings:function(p,x){1&p&&c.NdJ("ionScroll",function(O){return x.onScroll(O)}),2&p&&c.Ikx("overflow-scroll",x.myValue)}}),e})()}}]);