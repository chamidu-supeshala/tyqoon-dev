"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[244],{50244:(qo,C,s)=>{s.r(C),s.d(C,{AccountInfoModule:()=>No});var d=s(36895),w=s(7507),m=s(15861),U=s(80529),l=s(24006),A=s(50727),J=s(28746),M=s(82722),P=s(70262),y=s(39646),Z=s(6104),o=s(94650),p=s(95133),g=s(54463),O=s(8316);const S=function(){return{minSize:"50px",maxSize:"1000px"}};let v=(()=>{class n{constructor(){this.onLoadImg=new o.vpe,this.onRemove=new o.vpe,this.isEditing=!1,this.cropImg=null,this.data=""}ngOnInit(){var e=this;return(0,m.Z)(function*(){yield e.loadScript();const{profilePicture:t}=window;e.cropImg=new t(".drop-img-container",null,{onLoad:i=>{console.log("on load"),e.onLoadImg.emit()},onChange:i=>{console.log("on change")},onRemove:i=>{console.log("on remove"),e.onRemove.emit()},onError:function(i){console.log("Error type: "+i)},dropZone:!1})})()}getAsDataUrl(){return this.cropImg?this.cropImg.getAsDataURL():null}readFile(e){if(this.cropImg)return this.cropImg.removeImage(),this.cropImg.readFile(e)}loadScript(){return new Promise(e=>{(0,O.Z)({jquery:"assets/script/jquery.min.js"}).jquery.onLoad(()=>{(0,O.Z)({cropImage:"assets/script/crop-image.js?v=1.0.1"}).cropImage.onLoad(()=>{e(!0)})})})}abcd(){this.data=this.getAsDataUrl()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-crop-image"]],inputs:{initUrl:"initUrl"},outputs:{onLoadImg:"onLoadImg",onRemove:"onRemove"},standalone:!0,features:[o.jDz],decls:36,vars:17,consts:[[1,"drop-img-container","m-auto"],[1,"photo"],["type","file","accept","image/*"],[1,"photo__helper"],[1,"photo__frame","photo__frame--circle"],[1,"photo__canvas"],[1,"message","is-empty"],[1,"message--desktop"],[1,"message--mobile"],[1,"message","is-loading"],[1,"fa","fa-2x","fa-spin","fa-spinner"],[1,"message","is-dragover"],[1,"message","is-wrong-file-type","!text-red-500"],[1,"message","is-wrong-image-size","!text-red-500"],[1,"photo__options","hide"],[1,"photo__zoom","mt-3"],["type","range",1,"zoom-handler"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 64 64","fill","none","stroke","#000000",1,"remove","h-8","cursor-pointer"],["points","52 16 48 56 16 56 12 16"],["d","M20 16v-3.94A4.06 4.06 0 0 1 24.06 8h15.88A4.06 4.06 0 0 1 44 12.06V16"],["x1","8","y1","16","x2","56","y2","16"],["x1","24","y1","28","x2","40","y2","44"],["x1","40","y1","28","x2","24","y2","44"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0)(1,"div",1),o._UZ(2,"input",2),o.TgZ(3,"div",3)(4,"div",4),o._UZ(5,"canvas",5),o.TgZ(6,"div",6)(7,"p",7),o._uU(8),o.ALo(9,"translate"),o.qZA(),o.TgZ(10,"p",8),o._uU(11),o.ALo(12,"translate"),o.qZA()(),o.TgZ(13,"div",9),o._UZ(14,"i",10),o.qZA(),o.TgZ(15,"div",11)(16,"p"),o._uU(17),o.ALo(18,"translate"),o.qZA()(),o.TgZ(19,"div",12)(20,"p"),o._uU(21),o.ALo(22,"translate"),o.qZA()(),o.TgZ(23,"div",13)(24,"p"),o._uU(25),o.ALo(26,"translate"),o.qZA()()()(),o.TgZ(27,"div",14)(28,"div",15),o._UZ(29,"input",16),o.qZA(),o.O4$(),o.TgZ(30,"svg",17),o._UZ(31,"polyline",18)(32,"path",19)(33,"line",20)(34,"line",21)(35,"line",22),o.qZA()()()()),2&e&&(o.xp6(8),o.hij(" ",o.lcZ(9,5,"profile-drag-and-drop-avatar")," "),o.xp6(3),o.Oqu(o.lcZ(12,7,"profile-drag-and-drop-avatar")),o.xp6(6),o.Oqu(o.lcZ(18,9,"profile-drag-and-drop-avatar")),o.xp6(4),o.Oqu(o.lcZ(22,11,"image-upload-error-filetype")),o.xp6(4),o.Oqu(o.xi3(26,13,"profile-avatar-size-error",o.DdM(16,S))))},dependencies:[d.ez,p.Pc,g.aw,g.X$],styles:["[_nghost-%COMP%]     canvas{image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor}[_nghost-%COMP%]     .hide{display:none!important}[_nghost-%COMP%]     *{box-sizing:border-box}[_nghost-%COMP%]     .photo__zoom{position:relative;padding-left:22px;padding-right:22px}[_nghost-%COMP%]     .photo__zoom input[type=range]{-webkit-appearance:none;width:100%;background:transparent;height:18px}[_nghost-%COMP%]     .photo__zoom input[type=range]::-webkit-slider-thumb{-webkit-appearance:none}[_nghost-%COMP%]     .photo__zoom input[type=range]:focus{outline:none}[_nghost-%COMP%]     .photo__zoom input[type=range]::-ms-track{width:100%;cursor:pointer;background:transparent;border-color:transparent;color:transparent}[_nghost-%COMP%]     .photo__zoom input[type=range]:focus::-ms-thumb{border-color:#268eff;background:#268eff;box-shadow:0 0 1px #268eff}[_nghost-%COMP%]     .photo__zoom input[type=range]:focus::-moz-range-thumb{border-color:#268eff;background:#268eff;box-shadow:0 0 1px #268eff}[_nghost-%COMP%]     .photo__zoom input[type=range]:focus::-webkit-slider-thumb{border-color:#268eff;background:#268eff;box-shadow:0 0 1px #268eff}[_nghost-%COMP%]     .photo__zoom input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;margin-top:-9px;box-sizing:border-box;cursor:pointer;width:18px;height:18px;display:block;border-radius:50%;background:#268eff;border:1px solid #ddd}[_nghost-%COMP%]     .photo__zoom input[type=range]::-webkit-slider-thumb:hover{border-color:#c1c1c1}[_nghost-%COMP%]     .photo__zoom input[type=range]::-ms-thumb{margin-top:0;box-sizing:border-box;cursor:pointer;width:18px;height:18px;display:block;border-radius:50%;background:#eee;border:1px solid #ddd}[_nghost-%COMP%]     .photo__zoom input[type=range]::-ms-thumb:hover{border-color:#c1c1c1}[_nghost-%COMP%]     .photo__zoom input[type=range]::-moz-range-thumb{margin-top:0;box-sizing:border-box;cursor:pointer;width:18px;height:18px;display:block;border-radius:50%;background:#eee;border:1px solid #ddd}[_nghost-%COMP%]     .photo__zoom input[type=range]::-moz-range-thumb:hover{border-color:#c1c1c1}[_nghost-%COMP%]     .photo__zoom input[type=range]::-webkit-slider-runnable-track{width:100%;height:1px;cursor:pointer;background:#eee;border:0}[_nghost-%COMP%]     .photo__zoom input[type=range]::-moz-range-track{width:100%;height:1px;cursor:pointer;background:#eee;border:0}[_nghost-%COMP%]     .photo__zoom input[type=range]::-ms-track{width:100%;height:1px;cursor:pointer;background:#eee;border:0}[_nghost-%COMP%]     .photo__zoom input[type=range].zoom--minValue:before, [_nghost-%COMP%]     .photo__zoom input[type=range].zoom--maxValue:after{color:#f8f8f8}[_nghost-%COMP%]     .photo__zoom input[type=range]:before{font-size:14px;left:4px;top:4px}[_nghost-%COMP%]     .photo__frame--circle{border:1px solid #e2e2e2;border-radius:50%}[_nghost-%COMP%]     .photo__helper{position:relative;background-repeat:no-repeat;background-color:transparent;padding:15px 0}[_nghost-%COMP%]     .photo__helper .canvas--helper{position:absolute;top:0;left:0}[_nghost-%COMP%]     .photo__frame img, [_nghost-%COMP%]     .photo__helper{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .drop-img-container{position:relative;font-size:85%;width:300px}[_nghost-%COMP%]     .photo{text-align:center}[_nghost-%COMP%]     .photo input[type=file]{display:none}[_nghost-%COMP%]     .photo__options{position:relative;text-align:left}[_nghost-%COMP%]     .photo__options .remove{padding:0;display:inline-block;text-decoration:none;color:#ddd;font-size:18px;width:20%;text-align:center;vertical-align:middle}[_nghost-%COMP%]     .photo__options .remove:hover{color:#000}[_nghost-%COMP%]     .photo__zoom{vertical-align:middle;width:80%;display:inline-block}[_nghost-%COMP%]     .photo__frame{cursor:move;overflow:hidden;position:relative;display:inline-block;width:160px;height:160px}[_nghost-%COMP%]     .photo__frame img, [_nghost-%COMP%]     .photo__helper img{position:relative}[_nghost-%COMP%]     .photo__frame .message{position:absolute;left:5px;right:5px;top:50%;transform:translateY(-50%);display:inline-block;color:#268eff;z-index:3}[_nghost-%COMP%]     .photo__frame .is-dragover{display:none}[_nghost-%COMP%]     .message p{font-size:.9em}[_nghost-%COMP%]     .photo__options{list-style:none}[_nghost-%COMP%]     .photo__options li{display:inline-block;text-align:center;width:50%}[_nghost-%COMP%]     .photo--empty .photo__frame{cursor:pointer}[_nghost-%COMP%]     .drop-img-container.is-dragover .photo__frame img, [_nghost-%COMP%]     .photo--empty img, [_nghost-%COMP%]     .photo--error img, [_nghost-%COMP%]     .photo--error--file-type img, [_nghost-%COMP%]     .photo--error--image-size img, [_nghost-%COMP%]     .photo--loading img{display:none}[_nghost-%COMP%]     .message--desktop, [_nghost-%COMP%]     .message--mobile{display:none}[_nghost-%COMP%]     .is-mobile .message--mobile{display:inline-block}[_nghost-%COMP%]     .is-mobile .message--desktop{display:none}[_nghost-%COMP%]     .is-desktop .message--desktop{display:inline-block}[_nghost-%COMP%]     .is-desktop .message--mobile{display:none}[_nghost-%COMP%]     .message.is-empty, [_nghost-%COMP%]     .message.is-loading, [_nghost-%COMP%]     .message.is-wrong-file-type, [_nghost-%COMP%]     .message.is-wrong-image-size, [_nghost-%COMP%]     .message.is-something-wrong, [_nghost-%COMP%]     .message.is-dragover{display:none}[_nghost-%COMP%]     .photo--empty .photo__options{display:none}[_nghost-%COMP%]     .photo--empty .message.is-empty{display:inline-block}[_nghost-%COMP%]     .photo--empty .photo__frame:hover{background:#268eff}[_nghost-%COMP%]     .photo--empty .photo__frame:hover .message{color:#fff}[_nghost-%COMP%]     .photo--loading .message.is-loading{display:inline-block}[_nghost-%COMP%]     .photo--loading .message.is-empty, [_nghost-%COMP%]     .photo--loading .message.is-wrong-file-type, [_nghost-%COMP%]     .photo--loading .message.is-dragover, [_nghost-%COMP%]     .photo--loading .message.is-wrong-image-size, [_nghost-%COMP%]     .photo--loading .photo__options{display:none}[_nghost-%COMP%]     .photo--error .message.is-empty, [_nghost-%COMP%]     .photo--error .message.is-loading, [_nghost-%COMP%]     .photo--error .message.is-dragover, [_nghost-%COMP%]     .photo--error .message.is-wrong-image-size, [_nghost-%COMP%]     .photo--error .photo__options{display:none}[_nghost-%COMP%]     .photo--error .message.is-something-wrong{display:inline-block}[_nghost-%COMP%]     .photo--error--file-type .message.is-empty, [_nghost-%COMP%]     .photo--error--file-type .message.is-loading, [_nghost-%COMP%]     .photo--error--file-type .message.is-dragover, [_nghost-%COMP%]     .photo--error--file-type .message.is-wrong-image-size, [_nghost-%COMP%]     .photo--error--file-type .photo__options{display:none}[_nghost-%COMP%]     .photo--error--file-type .message.is-wrong-file-type{display:inline-block}[_nghost-%COMP%]     .photo--error--image-size .message.is-empty, [_nghost-%COMP%]     .photo--error--image-size .message.is-loading, [_nghost-%COMP%]     .photo--error--image-size .message.is-dragover, [_nghost-%COMP%]     .photo--error--image-size .message.is-wrong-file-type, [_nghost-%COMP%]     .photo--error--image-size .photo__options{display:none}[_nghost-%COMP%]     .photo--error--image-size .message.is-wrong-image-size{display:inline-block}[_nghost-%COMP%]     .drop-img-container.is-dragover .photo__frame{background-color:#268eff;color:#fff!important}[_nghost-%COMP%]     .drop-img-container.is-dragover .message{color:#fff!important}[_nghost-%COMP%]     .drop-img-container.is-dragover .photo__frame .is-dragover{display:inline-block}[_nghost-%COMP%]     .drop-img-container.is-dragover .message.is-empty, [_nghost-%COMP%]     .drop-img-container.is-dragover .message.is-loading, [_nghost-%COMP%]     .drop-img-container.is-dragover .message.is-wrong-file-type, [_nghost-%COMP%]     .drop-img-container.is-dragover .message.is-wrong-image-size{display:none}"]}),n})();var b=s(79445),L=s(5565),I=s(18110),N=s(53246),f=s(45329),q=s(84007),F=s(23372);let Q=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-edit-icon"]],decls:2,vars:0,consts:[["viewBox","64 64 896 896","focusable","false","fill","currentColor","width","1em","height","1em","data-icon","edit","aria-hidden","true"],["d","M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"]],template:function(e,t){1&e&&(o.O4$(),o.TgZ(0,"svg",0),o._UZ(1,"path",1),o.qZA())},encapsulation:2}),n})();var j=s(75073),Y=s(84620),T=s(93883),E=s(3479),_=s(26704),x=s(60312),k=s(90147);function B(n,a){1&n&&(o.TgZ(0,"ion-note",9),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"edit-email-fill-in")," "))}function R(n,a){1&n&&(o.TgZ(0,"ion-note",9),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"edit-email-fill-in-correct")," "))}function D(n,a){if(1&n&&(o.ynx(0),o.YNc(1,B,3,3,"ion-note",8),o.YNc(2,R,3,3,"ion-note",8),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",null==e.newEmail?null:e.newEmail.hasError("required")),o.xp6(1),o.Q6J("ngIf",null==e.newEmail?null:e.newEmail.hasError("email"))}}function G(n,a){if(1&n&&(o.TgZ(0,"span",12),o._uU(1),o.qZA()),2&n){const e=o.oxw().ngLet;o.xp6(1),o.hij("",e,"s")}}function $(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"ion-button",10),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.sendVerificationCode())}),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.YNc(4,G,2,1,"span",11),o.qZA()}if(2&n){const e=a.ngLet,t=o.oxw();o.Q6J("disabled",!(null!=t.newEmail&&t.newEmail.valid)||e>0),o.xp6(1),o.ekj("invisible",e),o.xp6(1),o.Oqu(o.lcZ(3,5,"login-page-get-verification-code")),o.xp6(2),o.Q6J("ngIf",e)}}function K(n,a){1&n&&(o.TgZ(0,"ion-note",9),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"edit-email-fill-in-verification-code")," "))}function H(n,a){if(1&n&&(o.ynx(0),o.YNc(1,K,3,3,"ion-note",8),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",null==e.verificationCode?null:e.verificationCode.hasError("required"))}}let V=(()=>{class n{constructor(e,t,i){this.toastController=e,this._formBuilder=t,this.userService=i,this.email="",this.confirmEmailAction=new o.vpe,this.emailForm=this._formBuilder.group({email:[this.email,[l.kI.required,l.kI.email]],code:[null,l.kI.required]})}ngOnInit(){this.userService.initVerificationTimer()}ngOnDestroy(){this.userService.clearVerificationTimer(_.R4.Email)}get newEmail(){return this.emailForm.get("email")}get verificationCode(){return this.emailForm.get("code")}sendVerificationCode(){this.newEmail?.valid&&this.userService.sendChangeEmailCode(this.newEmail.value).subscribe(t=>{0===t.code?(this.showMessage(`\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u5230${this.newEmail?.value}\u4e0a\uff0c\\n\u8bf7\u6ce8\u610f\u67e5\u6536`,3e3,"top"),this.userService.startVerificationTimer(_.R4.Email,60,!0)):this.showMessage(t.message,3e3,"top")})}onEditEmail(e){if(!e)return void this.confirmEmailAction.emit({action:e});if(!this.emailForm.valid)return;const t=this.emailForm.get("code")?.value,i=this.newEmail?.value;this.userService.changeEmail(t,i).subscribe({next:r=>{this.userService.updateUserInfo(),this.showMessage(0===r?.code?"\u4fee\u6539\u6210\u529f":r?.message,3e3,"top")},error:r=>{console.error(r.message),this.showMessage(r.message,3e3,"top")}}),this.confirmEmailAction.emit({email:this.newEmail?.value,action:e})}showMessage(e,t,i){var r=this;return(0,m.Z)(function*(){yield(yield r.toastController.create({message:e,duration:t,position:i})).present()})()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(p.yF),o.Y36(l.qu),o.Y36(f.K))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-edit-email-modal"]],inputs:{isOpen:"isOpen",email:"email"},outputs:{confirmEmailAction:"confirmEmailAction"},decls:14,vars:16,consts:[[3,"title","isOpen","modalAction"],[1,"p-6"],[1,"flex","flex-col","gap-y-6",3,"formGroup"],["lines","none","shape","rounded",1,"p-0"],["type","email","formControlName","email","email","",3,"placeholder"],[4,"ngIf"],["fill","outline","slot","end","class","relative !ml-1 verification-btn",3,"disabled","click",4,"ngLet"],["formControlName","code",3,"placeholder"],["slot","error",4,"ngIf"],["slot","error"],["fill","outline","slot","end",1,"relative","!ml-1","verification-btn",3,"disabled","click"],["class","absolute left-0 right-0 top-0 bottom-0 flex items-center justify-center lowercase font-medium text-base",4,"ngIf"],[1,"absolute","left-0","right-0","top-0","bottom-0","flex","items-center","justify-center","lowercase","font-medium","text-base"]],template:function(e,t){1&e&&(o.TgZ(0,"app-modal",0),o.NdJ("modalAction",function(r){return t.onEditEmail(r)}),o.ALo(1,"translate"),o.TgZ(2,"div",1)(3,"form",2)(4,"ion-item",3),o._UZ(5,"ion-input",4),o.ALo(6,"translate"),o.YNc(7,D,3,2,"ng-container",5),o.YNc(8,$,5,7,"ion-button",6),o.ALo(9,"async"),o.qZA(),o.TgZ(10,"ion-item",3),o._UZ(11,"ion-input",7),o.ALo(12,"translate"),o.YNc(13,H,2,1,"ng-container",5),o.qZA()()()()),2&e&&(o.s9C("title",o.lcZ(1,8,"Modify-Email")),o.Q6J("isOpen",t.isOpen),o.xp6(3),o.Q6J("formGroup",t.emailForm),o.xp6(2),o.s9C("placeholder",o.lcZ(6,10,"edit-email-fill-in")),o.xp6(2),o.Q6J("ngIf",null==t.newEmail?null:t.newEmail.touched),o.xp6(1),o.Q6J("ngLet",o.lcZ(9,12,t.userService.emailTimeRemaining$)),o.xp6(3),o.s9C("placeholder",o.lcZ(12,14,"edit-email-fill-in-correct-code")),o.xp6(2),o.Q6J("ngIf",null==t.verificationCode?null:t.verificationCode.touched))},dependencies:[d.O5,l._Y,l.JJ,l.JL,l.on,l.sg,l.u,p.YG,p.pK,p.Ie,p.uN,p.j9,x.z,k.h,d.Ov,g.X$],styles:["ion-item[_ngcontent-%COMP%]{--padding-start: 0px;--inner-padding-end: 0px}ion-input[_ngcontent-%COMP%]{border:1px solid #d9d9d9;border-radius:.5rem;--padding-start: .5rem !important}ion-input[_ngcontent-%COMP%]:hover{border-color:#ffa73b}ion-input.has-focus[_ngcontent-%COMP%]{border-color:#ffa73b!important;box-shadow:0 0 0 2px #fb881133;border-right-width:1px!important;outline:0}ion-input.ion-invalid[_ngcontent-%COMP%]:not(.ion-untouched){border-color:red!important}ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;height:100%;cursor:pointer;--border-width: 1px;--border-radius: .5rem;--border-color: #ffa73b;--color: #ffa73b;--color-hover: #f7b96d}ion-item[_ngcontent-%COMP%]   ion-button.verification-btn.button-disabled[_ngcontent-%COMP%]{--color: #777777;background:rgba(237,235,235,.5);--border-color: #aaaaaa}"]}),n})();var X=s(32482);function W(n,a){1&n&&(o.TgZ(0,"ion-note",9),o._uU(1," \u8bf7\u586b\u5199\u9a8c\u8bc1\u7801 "),o.qZA())}function oo(n,a){if(1&n&&(o.ynx(0),o.YNc(1,W,2,0,"ion-note",8),o.BQk()),2&n){const e=o.oxw();o.xp6(1),o.Q6J("ngIf",null==e.verificationCode?null:e.verificationCode.hasError("required"))}}function eo(n,a){if(1&n&&(o.TgZ(0,"span",12),o._uU(1),o.qZA()),2&n){const e=o.oxw().ngLet;o.xp6(1),o.hij("",e,"s")}}function no(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"ion-button",10),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.sendVerificationCode())}),o.TgZ(1,"span"),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.YNc(4,eo,2,1,"span",11),o.qZA()}if(2&n){const e=a.ngLet,t=o.oxw();o.Q6J("disabled",!(null!=t.newMobile&&t.newMobile.valid)||e>0),o.xp6(1),o.ekj("invisible",e),o.xp6(1),o.Oqu(o.lcZ(3,5,"login-page-get-verification-code")),o.xp6(2),o.Q6J("ngIf",e)}}let to=(()=>{class n{constructor(e,t,i){this.toastController=e,this._formBuilder=t,this.userService=i,this.mobileArea="+86",this.mobile="",this.confirmPhoneAction=new o.vpe,this.userInfo=null,this.subscriptions=new A.w0,this.mobileForm=this._formBuilder.group({mobileArea:[this.mobileArea],mobile:["",[l.kI.required]],code:[null,l.kI.required]})}ngOnInit(){this.subscriptions.add(this.userService.userInfo$.subscribe(e=>{e&&(this.userInfo=e,console.log(e))})),this.userService.initVerificationTimer()}ngOnDestroy(){this.userService.clearVerificationTimer(_.R4.Email)}get newMobileArea(){return this.mobileForm.get("mobileArea")}get newMobile(){return this.mobileForm.get("mobile")}get verificationCode(){return this.mobileForm.get("code")}onSelectPhoneCountry(e){e&&this.mobileForm.get("mobileArea")?.patchValue(e)}onPhoneNumberChange(e){this.mobileForm.get("mobile")?.patchValue(e)}sendVerificationCode(){if(!this.newMobile?.valid||!this.newMobileArea?.valid)return;const e=this.newMobileArea?.value?this.newMobileArea.value:this.userInfo?.mobileArea,t=this.newMobile.value;this.userService.sendChangeMobileSMS(e,t).subscribe(i=>{0===i?.code?(this.showMessage(`\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u5230${e}${t}\u4e0a\n\u8bf7\u6ce8\u610f\u67e5\u6536`,3e3,"top"),this.userService.startVerificationTimer(_.R4.SMS,60,!0)):this.showMessage(i.message,3e3,"top")})}onEditMobile(e){var t=this;if(!e)return void this.confirmPhoneAction.emit({action:e});if(!this.mobileForm.valid)return;const i=this.mobileForm.get("code")?.value,r=this.newMobileArea?.value?this.newMobileArea?.value:this.userInfo?.mobileArea,c=this.newMobile?.value;var u;console.log(i,r,c),this.userService.changeMobile(r,c,i).subscribe({next:(u=(0,m.Z)(function*(h){t.userService.updateUserInfo(),0===h?.code?(t.showMessage("\u4fee\u6539\u6210\u529f",3e3,"top"),t.confirmPhoneAction.emit({mobileArea:t.mobileArea,mobile:t.mobile,action:e})):t.showMessage(h?.message,3e3,"top")}),function(Qo){return u.apply(this,arguments)}),error:u=>{console.error(u.message),this.showMessage(u.message,3e3,"top"),this.confirmPhoneAction.emit({mobileArea:this.mobileArea,mobile:this.mobile,action:e})}})}showMessage(e,t,i){var r=this;return(0,m.Z)(function*(){yield(yield r.toastController.create({message:e,duration:t,position:i})).present()})()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(p.yF),o.Y36(l.qu),o.Y36(f.K))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-edit-phone-modal"]],inputs:{isOpen:"isOpen",mobileArea:"mobileArea",mobile:"mobile"},outputs:{confirmPhoneAction:"confirmPhoneAction"},decls:9,vars:6,consts:[["title","\u4fee\u6539\u624b\u673a\u53f7",3,"isOpen","modalAction"],[1,"p-6"],[1,"flex","flex-col",3,"formGroup"],[1,"z-10",3,"onSelectPhoneCountry","onPhoneNumberChange"],["lines","none","shape","rounded",1,"p-0"],["placeholder","\u9a8c\u8bc1\u7801","formControlName","code"],[4,"ngIf"],["fill","outline","slot","end","class","!ml-1 verification-btn",3,"disabled","click",4,"ngLet"],["slot","error",4,"ngIf"],["slot","error"],["fill","outline","slot","end",1,"!ml-1","verification-btn",3,"disabled","click"],["class","absolute left-0 right-0 top-0 bottom-0 flex items-center justify-center lowercase font-medium text-base",4,"ngIf"],[1,"absolute","left-0","right-0","top-0","bottom-0","flex","items-center","justify-center","lowercase","font-medium","text-base"]],template:function(e,t){1&e&&(o.TgZ(0,"app-modal",0),o.NdJ("modalAction",function(r){return t.onEditMobile(r)}),o.TgZ(1,"div",1)(2,"form",2)(3,"app-phone-control",3),o.NdJ("onSelectPhoneCountry",function(r){return t.onSelectPhoneCountry(r)})("onPhoneNumberChange",function(r){return t.onPhoneNumberChange(r)}),o.qZA(),o.TgZ(4,"ion-item",4),o._UZ(5,"ion-input",5),o.YNc(6,oo,2,1,"ng-container",6),o.YNc(7,no,5,7,"ion-button",7),o.ALo(8,"async"),o.qZA()()()()),2&e&&(o.Q6J("isOpen",t.isOpen),o.xp6(2),o.Q6J("formGroup",t.mobileForm),o.xp6(4),o.Q6J("ngIf",null==t.verificationCode?null:t.verificationCode.touched),o.xp6(1),o.Q6J("ngLet",o.lcZ(8,4,t.userService.smsTimeRemaining$)))},dependencies:[d.O5,l._Y,l.JJ,l.JL,l.sg,l.u,X.b,p.YG,p.pK,p.Ie,p.uN,p.j9,x.z,k.h,d.Ov,g.X$],styles:["ion-item[_ngcontent-%COMP%]{--padding-start: 0px;--inner-padding-end: 0px}ion-input[_ngcontent-%COMP%]{border:1px solid #d9d9d9;border-radius:.5rem;--padding-start: .5rem !important}ion-input[_ngcontent-%COMP%]:hover{border-color:#ffa73b}ion-input.has-focus[_ngcontent-%COMP%]{border-color:#ffa73b!important;box-shadow:0 0 0 2px #fb881133;border-right-width:1px!important;outline:0}ion-input.ion-invalid[_ngcontent-%COMP%]:not(.ion-untouched){border-color:red!important}ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;height:100%;cursor:pointer;--border-width: 1px;--border-radius: .5rem;--border-color: #ffa73b;--color: #ffa73b;--color-hover: #f7b96d}ion-item[_ngcontent-%COMP%]   ion-button.verification-btn.button-disabled[_ngcontent-%COMP%]{--color: #777777;background:rgba(237,235,235,.5);--border-color: #aaaaaa}[_nghost-%COMP%]     #modal-body{overflow:visible}"]}),n})();var io=s(77579),z=s(49769);function ro(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1," \u8bf7\u8f93\u5165\u5f53\u524d\u5bc6\u7801 "),o.qZA())}function ao(n,a){if(1&n&&(o.TgZ(0,"div",14),o.YNc(1,ro,2,0,"div",15),o.qZA()),2&n){const e=o.oxw();let t;o.xp6(1),o.Q6J("ngIf",null==(t=e.form.get("oldPassword"))||null==t.errors?null:t.errors.required)}}function so(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1," \u8bf7\u8f93\u5165\u5bc6\u7801 "),o.qZA())}function lo(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1," \u5bc6\u7801\u5fc5\u987b\u7531\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7279\u6b8a\u7b26\u53f7\u4e2d\u76842\u79cd\u53ca\u4ee5\u4e0a\u7c7b\u578b\u7ec4\u6210! "),o.qZA())}function co(n,a){if(1&n&&(o.TgZ(0,"div",14),o.YNc(1,so,2,0,"div",15),o.YNc(2,lo,2,0,"div",15),o.qZA()),2&n){const e=o.oxw();let t,i;o.xp6(1),o.Q6J("ngIf",null==(t=e.form.get("newPassword"))||null==t.errors?null:t.errors.required),o.xp6(1),o.Q6J("ngIf",null==(i=e.form.get("newPassword"))||null==i.errors?null:i.errors.error)}}function po(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1," \u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801 "),o.qZA())}function uo(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1," \u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4 "),o.qZA())}function mo(n,a){if(1&n&&(o.TgZ(0,"div",14),o.YNc(1,po,2,0,"div",15),o.YNc(2,uo,2,0,"div",15),o.qZA()),2&n){const e=o.oxw();let t,i;o.xp6(1),o.Q6J("ngIf",null==(t=e.form.get("confirmNewPassword"))||null==t.errors?null:t.errors.required),o.xp6(1),o.Q6J("ngIf",null==(i=e.form.get("confirmNewPassword"))||null==i.errors?null:i.errors.confirm)}}function go(n,a){if(1&n&&(o.TgZ(0,"div",16),o._uU(1),o.qZA()),2&n){const e=o.oxw();o.xp6(1),o.hij(" ",e.message," ")}}let ho=(()=>{class n{constructor(e,t,i){this.fb=e,this.toastController=t,this.userService=i,this.changePasswordAction=new o.vpe,this.busy=!1,this.$active=new io.x,this.confirmationValidator=r=>r.value?r.value!==this.form.get("newPassword")?.value?{confirm:!0,error:!0}:{}:{required:!0}}ngOnInit(){this.initForm()}ngOnDestroy(){this.$active.next(),this.$active.complete()}onAction(e){e?this.form.invalid||(this.busy=!0,this.message=null,this.userService.changePassword(z(this.form.get("oldPassword")?.value).toString(),z(this.form.get("newPassword")?.value).toString()).pipe((0,M.R)(this.$active),(0,P.K)(()=>(0,y.of)(null))).subscribe(t=>{this.busy=!1,t?.code>0?this.message=t.message:(this.showMessage("\u4fee\u6539\u5bc6\u7801\u6210\u529f",3e3,"top","success"),this.changePasswordAction.emit(!1))})):this.changePasswordAction.emit({action:e})}showMessage(e,t,i,r){var c=this;return(0,m.Z)(function*(){yield(yield c.toastController.create({message:e,duration:t,position:i,color:r})).present()})()}initForm(){this.form=this.fb.group({oldPassword:[null,[l.kI.required]],newPassword:[null,[l.kI.required,this.validatePassword]],confirmNewPassword:[null,[l.kI.required,this.confirmationValidator]]})}validatePassword(e){return e.value?/(?![A-Z]*$)(?![a-z]*$)(?![0-9]*$)(?![^a-zA-Z0-9]*$)/.test(e.value)?e.value.trim().length<6?{length:!0}:{}:{error:!0}:{required:!0}}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(l.qu),o.Y36(p.yF),o.Y36(f.K))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-change-password-modal"]],inputs:{isOpen:"isOpen"},outputs:{changePasswordAction:"changePasswordAction"},decls:30,vars:18,consts:[[3,"title","isOpen","modalAction"],[1,"flex","flex-col","h-full","overflow-y-auto","overflow-x-hidden"],[1,"group","relative","flex","flex-col","my-8","md:my-0","px-4","lg:px-0","pt-4","md:p-4","lg:mb-0","rounded-xl","bg-white","md:border","border-gray-400","border-opacity-25"],[1,"m-auto","pt-4","px-4","w-full",3,"formGroup"],[1,"mb-6"],[1,"flex","items-center","relative"],[1,"flex","items-center","absolute","icon"],["viewBox","64 64 896 896","focusable","false","fill","currentColor","width","1em","height","1em","data-icon","lock","aria-hidden","true"],["d","M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"],["formControlName","oldPassword","type","password",1,"form-input","w-full","py-2.5","pl-10","pr-3","rounded-md","border","focus:outline-none",3,"placeholder"],["class","validation-error mt-3 text-red-600",4,"ngIf"],["formControlName","newPassword","type","password",1,"form-input","w-full","py-2.5","pl-10","pr-3","rounded-md","border","focus:outline-none",3,"placeholder"],["formControlName","confirmNewPassword","type","password",1,"form-input","w-full","py-2.5","pl-10","pr-3","rounded-md","border","focus:outline-none",3,"placeholder"],["class","text-center w-full mt-3 text-red-600",4,"ngIf"],[1,"validation-error","mt-3","text-red-600"],[4,"ngIf"],[1,"text-center","w-full","mt-3","text-red-600"]],template:function(e,t){if(1&e&&(o.TgZ(0,"app-modal",0),o.NdJ("modalAction",function(r){return t.onAction(r)}),o.ALo(1,"translate"),o.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"span",6),o.O4$(),o.TgZ(8,"svg",7),o._UZ(9,"path",8),o.qZA()(),o.kcU(),o._UZ(10,"input",9),o.ALo(11,"translate"),o.qZA(),o.YNc(12,ao,2,1,"div",10),o.qZA(),o.TgZ(13,"div",4)(14,"div",5)(15,"span",6),o.O4$(),o.TgZ(16,"svg",7),o._UZ(17,"path",8),o.qZA()(),o.kcU(),o._UZ(18,"input",11),o.ALo(19,"translate"),o.qZA(),o.YNc(20,co,3,2,"div",10),o.qZA(),o.TgZ(21,"div",4)(22,"div",5)(23,"span",6),o.O4$(),o.TgZ(24,"svg",7),o._UZ(25,"path",8),o.qZA()(),o.kcU(),o._UZ(26,"input",12),o.ALo(27,"translate"),o.qZA(),o.YNc(28,mo,3,2,"div",10),o.qZA(),o.YNc(29,go,2,1,"div",13),o.qZA()()()()),2&e){let i,r,c;o.s9C("title",o.lcZ(1,10,"account-change-password-page-title")),o.Q6J("isOpen",t.isOpen),o.xp6(4),o.Q6J("formGroup",t.form),o.xp6(6),o.Q6J("placeholder",o.lcZ(11,12,"account-change-password-current")),o.xp6(2),o.Q6J("ngIf",(null==(i=t.form.get("oldPassword"))?null:i.invalid)&&(null==(i=t.form.get("oldPassword"))?null:i.touched)),o.xp6(6),o.Q6J("placeholder",o.lcZ(19,14,"account-change-password-new-password")),o.xp6(2),o.Q6J("ngIf",(null==(r=t.form.get("newPassword"))?null:r.invalid)&&(null==(r=t.form.get("newPassword"))?null:r.touched)),o.xp6(6),o.Q6J("placeholder",o.lcZ(27,16,"account-change-password-new-password-confirm")),o.xp6(2),o.Q6J("ngIf",(null==(c=t.form.get("confirmNewPassword"))?null:c.invalid)&&(null==(c=t.form.get("confirmNewPassword"))?null:c.touched)),o.xp6(1),o.Q6J("ngIf",t.message)}},dependencies:[d.O5,l.Fj,l.JJ,l.JL,l.sg,l.u,x.z,g.X$],styles:[".form-input[_ngcontent-%COMP%]{border-color:#d9d9d9}.form-input[_ngcontent-%COMP%]:focus{border-color:#ffa73b;box-shadow:0 10px 15px -3px #fb881133,0 4px 6px -4px #fb881133}.icon[_ngcontent-%COMP%]{left:11px}"]}),n})(),fo=(()=>{class n{constructor(){}transform(e,t){const[i,r,c]=[e.slice(0,1),e.slice(1,-1),e.slice(-1)];return`${i}${t?"*".repeat(r.length<6?r.length:6):r}${c}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=o.Yjl({name:"encrypt",type:n,pure:!1}),n})();function _o(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"app-crop-image",39),o.NdJ("onLoadImg",function(){o.CHM(e);const i=o.oxw(2);return o.KtG(i.handleLoadImg())})("onRemove",function(){o.CHM(e);const i=o.oxw(2);return o.KtG(i.handleRemoveImg())}),o.qZA()}}function vo(n,a){1&n&&o._UZ(0,"app-loading-spinner",48)}function bo(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"div",40)(1,"input",41,42),o.NdJ("change",function(i){o.CHM(e);const r=o.oxw(2);return o.KtG(r.fileBrowseHandler(i))}),o.qZA(),o.TgZ(3,"label",43),o._UZ(4,"img",44),o.qZA(),o.YNc(5,vo,1,0,"app-loading-spinner",45),o.TgZ(6,"ion-fab-button",46),o.NdJ("click",function(){o.CHM(e);const i=o.MAs(2);return o.KtG(i.click())}),o._UZ(7,"ion-icon",47),o.qZA()()}if(2&n){const e=o.oxw(2);o.xp6(1),o.Q6J("formControl",e.uploadControl),o.xp6(3),o.Q6J("src",e.userInfo.avatar||"/assets/images/sign-up-user.svg",o.LSH),o.xp6(1),o.Q6J("ngIf",e.uploadProgress||e.isLoadingInfo)}}function xo(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"image-upload-error-filesize")," "))}function Co(n,a){1&n&&(o.TgZ(0,"div"),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"image-upload-error-filetype")," "))}function wo(n,a){1&n&&o._UZ(0,"div")}function Ao(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"div",49)(1,"button",50),o.NdJ("click",function(){o.CHM(e);const i=o.oxw(2);return o.KtG(i.isEditingPhoto=!1)}),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"button",51),o.NdJ("click",function(){o.CHM(e);const i=o.oxw(2);return o.KtG(i.saveProfilePicture())}),o._uU(5),o.ALo(6,"translate"),o.qZA()()}if(2&n){const e=o.oxw(2);o.xp6(2),o.Oqu(o.lcZ(3,3,"cancel")),o.xp6(2),o.Q6J("disabled",!e.isLoadedImg),o.xp6(1),o.Oqu(o.lcZ(6,5,"save"))}}function Mo(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"ion-button",52),o.NdJ("click",function(){o.CHM(e);const i=o.oxw(2);return o.KtG(i.isAuthModalShown=!0)}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"modal-Authentication")," "))}function Po(n,a){1&n&&o._UZ(0,"ion-icon",57)}function yo(n,a){1&n&&o._UZ(0,"ion-icon",58)}function Zo(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"div",53),o.NdJ("click",function(){const r=o.CHM(e).$implicit,c=o.oxw(2);return o.KtG(c.onOpenSocialAccount(r))}),o.YNc(1,Po,1,0,"ion-icon",54),o.YNc(2,yo,1,0,"ng-template",null,55,o.W1O),o._UZ(4,"img",56),o.qZA()}if(2&n){const e=a.$implicit,t=o.MAs(3);o.xp6(1),o.Q6J("ngIf",e.hasConnectedAccount)("ngIfElse",t),o.xp6(3),o.Q6J("src",e.logo,o.LSH)}}const Oo=function(n){return{"h-48 lg:h-56 ":n}};function Io(n,a){if(1&n){const e=o.EpF();o.ynx(0),o.TgZ(1,"div",7)(2,"div",8)(3,"h3",9),o._uU(4),o.ALo(5,"translate"),o.qZA()(),o.TgZ(6,"div",10),o.NdJ("fileDropped",function(i){o.CHM(e);const r=o.oxw();return o.KtG(r.onFileDropped(i))}),o.TgZ(7,"div",11),o.YNc(8,_o,1,0,"app-crop-image",12),o.YNc(9,bo,8,3,"div",13),o.TgZ(10,"div",14)(11,"div",15),o._UZ(12,"app-upload-anim-icon"),o.TgZ(13,"p",16),o._uU(14),o.ALo(15,"translate"),o.qZA()()(),o.TgZ(16,"div",17),o.YNc(17,xo,3,3,"div",18),o.YNc(18,Co,3,3,"div",18),o.YNc(19,wo,1,0,"div",19),o.qZA()(),o.YNc(20,Ao,7,7,"div",20),o.TgZ(21,"div",21)(22,"div",22),o._uU(23),o.ALo(24,"translate"),o.qZA(),o.TgZ(25,"div",23)(26,"span",24),o._uU(27),o.ALo(28,"encrypt"),o.qZA(),o.TgZ(29,"div",25),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.bEncryptName=!i.bEncryptName)}),o._UZ(30,"ion-icon",26),o.qZA()(),o.TgZ(31,"div",22),o._uU(32),o.ALo(33,"translate"),o.qZA(),o.TgZ(34,"div",27)(35,"ion-button",28),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.isChangePasswordModalShown=!0)}),o._uU(36),o.ALo(37,"translate"),o.qZA()(),o.TgZ(38,"div",22),o._uU(39),o.ALo(40,"translate"),o.qZA(),o.TgZ(41,"div",23)(42,"span",29),o._uU(43),o.ALo(44,"encrypt"),o.qZA(),o.TgZ(45,"div",25),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.isEmailModalShown=!0)}),o._UZ(46,"app-edit-icon"),o.qZA()(),o.TgZ(47,"div",22),o._uU(48),o.ALo(49,"translate"),o.qZA(),o.TgZ(50,"div",23)(51,"span",30),o._uU(52),o.ALo(53,"encrypt"),o.qZA(),o.TgZ(54,"div",25),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.isPhoneModalShown=!0)}),o._UZ(55,"app-edit-icon"),o.qZA()(),o.TgZ(56,"div",22),o._uU(57),o.ALo(58,"translate"),o.qZA(),o.TgZ(59,"div",23)(60,"span",30),o._uU(61),o.ALo(62,"translate"),o.qZA()(),o.TgZ(63,"div",22),o._uU(64),o.ALo(65,"translate"),o.qZA(),o.TgZ(66,"div",23)(67,"span",31),o._uU(68),o.ALo(69,"translate"),o.ALo(70,"dict"),o.qZA(),o.YNc(71,Mo,3,3,"ion-button",32),o.qZA(),o.TgZ(72,"div",22),o._uU(73),o.ALo(74,"translate"),o.qZA(),o.TgZ(75,"div",33)(76,"span",30),o._uU(77),o.qZA(),o.TgZ(78,"ion-button",34),o.NdJ("click",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.isInviteModalShown=!0)}),o._uU(79),o.ALo(80,"translate"),o.qZA()()(),o.TgZ(81,"div",35)(82,"div",36),o._uU(83),o.ALo(84,"translate"),o.qZA(),o.TgZ(85,"div",37),o.YNc(86,Zo,5,3,"div",38),o.qZA()()()(),o.BQk()}if(2&n){const e=o.oxw();o.xp6(4),o.hij(" ",o.lcZ(5,31,"account-info-page-title")," "),o.xp6(3),o.Q6J("ngClass",o.VKq(72,Oo,!e.isEditingPhoto)),o.xp6(1),o.Q6J("ngIf",e.isEditingPhoto&&e.userInfo),o.xp6(1),o.Q6J("ngIf",!e.isEditingPhoto),o.xp6(5),o.hij(" ",o.lcZ(15,33,"Drag&Drop your profile image here")," "),o.xp6(2),o.Q6J("ngSwitch",e.uploadError),o.xp6(1),o.Q6J("ngSwitchCase","filesize"),o.xp6(1),o.Q6J("ngSwitchCase","filetype"),o.xp6(2),o.Q6J("ngIf",e.isEditingPhoto),o.xp6(3),o.hij(" ",o.lcZ(24,35,"account-info-username"),": "),o.xp6(4),o.hij(" ",o.xi3(28,37,e.userInfo.username,e.bEncryptName)," "),o.xp6(3),o.Q6J("name",e.bEncryptName?"eye-outline":"eye-off-outline"),o.xp6(2),o.hij(" ",o.lcZ(33,40,"login-page-password"),": "),o.xp6(4),o.hij(" ",o.lcZ(37,42,"account-menu-password"),""),o.xp6(3),o.hij(" ",o.lcZ(40,44,"account-info-email"),": "),o.xp6(4),o.hij(" ",o.xi3(44,46,e.userInfo.email||"",e.bEncryptEmail)," "),o.xp6(5),o.hij(" ",o.lcZ(49,49,"account-info-phone"),": "),o.xp6(4),o.AsE(" ",e.userInfo.mobileArea||" "," ",o.xi3(53,51,e.userInfo.mobile||"",e.bEncryptMobile)," "),o.xp6(5),o.hij(" ",o.lcZ(58,54,"account-info-referrer"),": "),o.xp6(4),o.hij(" ",e.userInfo.pid||o.lcZ(62,56,"account-info-referrer-unbound")," "),o.xp6(3),o.hij(" ",o.lcZ(65,58,"modal-Real-Name-Authentication"),": "),o.xp6(4),o.hij(" ",o.lcZ(69,60,o.Dn7(70,62,e.userInfo.isIdentify,e.DictKey.Auth_STATUS,"label"))," "),o.xp6(3),o.Q6J("ngIf",0===e.userInfo.isIdentify||3===e.userInfo.isIdentify),o.xp6(2),o.hij(" ",o.lcZ(74,66,"account-info-referrer-my-invitation-code"),": "),o.xp6(4),o.hij(" ",e.userInfo.id," "),o.xp6(2),o.hij(" ",o.lcZ(80,68,"shop-product-page-share")," "),o.xp6(4),o.lnq(" ",o.lcZ(84,70,"social-connect")," (",e.connectedAccounts.length,"/",e.socialAccounts.length,") "),o.xp6(3),o.Q6J("ngForOf",e.socialAccounts)}}function To(n,a){1&n&&o._UZ(0,"div",59)}function Eo(n,a){if(1&n){const e=o.EpF();o.TgZ(0,"app-connect-social-modal",60),o.NdJ("isOpenChange",function(i){o.CHM(e);const r=o.oxw();return o.KtG(r.isOpenConnectSocialModal=i)})("onRefreshAccount",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.refreshAccounts())}),o.qZA()}if(2&n){const e=o.oxw();o.Q6J("isOpen",e.isOpenConnectSocialModal)("socialAccount",e.selectedSocialAccount)}}const ko=[{path:"",component:(()=>{class n extends L.V{constructor(e,t){super(),this.shortVideoChallengeService=e,this._userService=t,this.userInfo=null,this.bEncryptName=!0,this.bEncryptEmail=!0,this.bEncryptMobile=!0,this.uploadControl=new l.NI,this.isLoadingInfo=!1,this.isInviteModalShown=!1,this.isEmailModalShown=!1,this.isPhoneModalShown=!1,this.isAuthModalShown=!1,this.isChangePasswordModalShown=!1,this.DictKey=Z.f,this.isEditingPhoto=!1,this.connectedAccounts=[],this.socialAccounts=[],this.isOpenConnectSocialModal=!1,this.subscriptions=new A.w0,this.isLoadedImg=!1,this.subscriptions.add(this._userService.userInfo$.subscribe(i=>{i&&(this.userInfo=i,this.isLoadingInfo=!1)}))}ngOnInit(){this.refreshAccounts()}ngOnDestroy(){super.ngOnDestroy(),this.subscriptions.unsubscribe(),this.uploadSub?.unsubscribe()}onFileDropped(e){this.isEditingPhoto=!0,setTimeout(()=>{this.cropImg.readFile(e[0])},150)}fileBrowseHandler(e){!e.target.files.length||(this.isEditingPhoto=!0,setTimeout(()=>{this.cropImg.readFile(e.target.files[0])},150))}uploadAvatar(e){this.uploadError="",this.userInfo&&(this.userInfo.avatar=""),e.type.slice(0,5),this.isEditingPhoto=!1,this.uploadProgress=0,this.uploadSub=this._userService.uploadAvatar(e).pipe((0,J.x)(()=>this.uploadFinished())).subscribe(i=>{i.type===U.dt.UploadProgress&&i.total&&(this.uploadProgress=Math.round(i.loaded/i.total*100))})}uploadFinished(){this.uploadProgress=null,this.uploadSub=null,this.isLoadingInfo=!0,this._userService.updateUserInfo(),this.isLoadedImg=!1}showInviteModal(){this.isInviteModalShown=!0}onConfirmEmail(e){this.isEmailModalShown=!1}onConfirmPhone(e){this.isPhoneModalShown=!1,e.action||(this.isPhoneModalShown=!1)}onChangePassword(e){e.action||(this.isChangePasswordModalShown=!1)}saveProfilePicture(){if(!this.isLoadedImg)return;const e=this.cropImg.getAsDataUrl();if(!e)return;const t=this.dataURLtoBlob(e);if(!t)return;const i=new File([t],"avatar.png",{type:"image/png",lastModified:Date.now()});this.uploadAvatar(i)}dataURLtoBlob(e){let t=e.split(",");if(!t||!t[0])return null;let i=t[0].match(/:(.*?);/)?.[1],r=atob(t[1]),c=r.length,u=new Uint8Array(c);for(;c--;)u[c]=r.charCodeAt(c);return new Blob([u],{type:i})}handleLoadImg(){this.isLoadedImg=!0}handleRemoveImg(){this.isLoadedImg=!1}refreshAccounts(){var e=this;return(0,m.Z)(function*(){e.shortVideoChallengeService.queryAccounts().pipe((0,M.R)(e.destroyStream$),(0,P.K)(t=>(0,y.of)(t))).subscribe(function(){var t=(0,m.Z)(function*(i){if(i?.data){const r=b.QT.map(c=>c.accountType);e.connectedAccounts=i.data.filter(c=>r.includes(c.accountType)).map(c=>{const u=b.QT.find(h=>h.accountType===c.accountType);return{...u,id:c.id,username:c.accountName,profileUrl:c.accountLink,screenshot:e.getParsedScreenshots(c.image),isValidUrl:u.validateProfileUrl&&(0,I.jv)(c.accountLink)}})}e.socialAccounts=b.QT.map(r=>({...r,hasConnectedAccount:e.connectedAccounts.some(c=>c.accountType===r.accountType)}))});return function(i){return t.apply(this,arguments)}}())})()}getParsedScreenshots(e){if(!e)return[];try{return JSON.parse(e)}catch{return(0,I.jv)(e)?[e]:[]}}onOpenSocialAccount(e){const t=this.connectedAccounts.find(i=>i.accountType===e.accountType);this.selectedSocialAccount={...e,id:t?.id,username:t?.username,profileUrl:t?.profileUrl,screenshot:t?.screenshot},this.isOpenConnectSocialModal=!0}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(N.y),o.Y36(f.K))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-account-info"]],viewQuery:function(e,t){if(1&e&&o.Gf(v,5),2&e){let i;o.iGM(i=o.CRH())&&(t.cropImg=i.first)}},features:[o.qOj],decls:9,vars:11,consts:[[4,"ngIf","ngIfElse"],["placeholderView",""],[3,"isOpen","isOpenChange"],[3,"isOpen","email","confirmEmailAction"],[3,"isOpen","mobileArea","mobile","confirmPhoneAction"],[3,"isOpen","changePasswordAction"],[3,"isOpen","socialAccount","isOpenChange","onRefreshAccount",4,"ngIf"],[1,"flex","flex-col","h-full","overflow-y-auto","overflow-x-hidden"],[1,"mb-2","sm:mb-3","flex","justify-between"],[1,"text-2xl","font-semi-bold","hidden","md:flex"],["appDragAndDrop","",1,"group","relative","flex","flex-col","pt-4","md:p-4","lg:mb-0","rounded-xl","bg-white","md:border","border-gray-400","border-opacity-25",3,"fileDropped"],[1,"profile-avatar","relative","flex","flex-col","items-center","justify-center",3,"ngClass"],[3,"onLoadImg","onRemove",4,"ngIf"],["class","relative w-36 h-36 sm:w-40 sm:h-40 lg:w-44 lg:h-44 group-[.fileover]:hidden z-40",4,"ngIf"],[1,"invisible","opacity-0","drop-zone-container","absolute","flex","items-center","justify-center","flex-none","group-[.fileover]:visible","group-[.fileover]:opacity-100","w-3/4","sm:2/3","lg:w-1/2","2xl:w-2/5","h-full","rounded-md","z-50","pointer-events-none"],[1,"drop-zone","w-full","h-full","bg-white","flex","flex-col","items-center","justify-center","rounded-md"],[1,"mx-4","text-center"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","flex justify-center mr-2 mb-4",4,"ngIf"],[1,"account-info","grid","grid-cols-8","sm:grid-cols-2","items-center","leading-normal","text-black","text-opacity-90","text-base"],[1,"col-span-3","sm:col-span-1","font-medium","text-right","py-2","lg:py-3","pr-2","sm:pr-5"],[1,"col-span-5","sm:col-span-1","flex","items-center","pl-5"],[1,"text-right","mr-2"],[1,"flex","items-center","justify-center","w-8","h-8","border","rounded-sm","px-1","duration-150","hover:text-primary","z-40",3,"click"],[1,"w-full","h-full",3,"name"],[1,"col-span-5","sm:col-span-1","flex","items-center","pl-5","change-password","z-40"],["color","light",1,"change-password-btn","normal-case","font-semibold",3,"click"],[1,"text-center","mr-2","break-all"],[1,"text-center","mr-2"],[1,"text-center","mr-2","whitespace-nowrap"],["class","normal-case share-btn z-40 whitespace-pre-wrap px-2",3,"click",4,"ngIf"],[1,"col-span-5","sm:col-span-1","flex","flex-col","sm:flex-row","items-start","sm:items-center","pl-5"],[1,"normal-case","share-btn","h-8","z-40",3,"click"],[1,"social-connect","flex","items-center","flex-col","justify-center","border-t-2","m-auto","w-full","pt-2","mt-2","pb-2"],[1,"text-xl","font-bold"],[1,"social-accounts","flex","gap-5","pt-3","flex-wrap"],["class","social-account rounded-xl border-2 border-white relative cursor-pointer",3,"click",4,"ngFor","ngForOf"],[3,"onLoadImg","onRemove"],[1,"relative","w-36","h-36","sm:w-40","sm:h-40","lg:w-44","lg:h-44","group-[.fileover]:hidden","z-40"],["id","upload-avatar","type","file","accept","image/*","multiple","false",1,"hidden",3,"formControl","change"],["file",""],["for","upload-avatar",1,"upload","flex","w-full","h-full","rounded-full","overflow-hidden","border-2","cursor-pointer","z-40"],["alt","User avatar","width","100%","height","100%",1,"object-cover","object-center","!w-full","!h-full",3,"src"],["class","absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2","text","loading",4,"ngIf"],["size","small",1,"absolute","top-0","right-0","m-0","z-40",3,"click"],["name","pencil-sharp"],["text","loading",1,"absolute","left-1/2","top-1/2","-translate-x-1/2","-translate-y-1/2"],[1,"flex","justify-center","mr-2","mb-4"],[1,"py-2","font-bold","capitalize","mr-2","opacity-30",3,"click"],[1,"py-2","ml-2","font-bold","bg-[#0087ff]","rounded-lg","px-3","text-white","capitalize",3,"disabled","click"],[1,"normal-case","share-btn","z-40","whitespace-pre-wrap","px-2",3,"click"],[1,"social-account","rounded-xl","border-2","border-white","relative","cursor-pointer",3,"click"],["name","checkmark-outline","class","absolute -top-2 -left-2 connected text-white rounded-full w-5 h-5 p-0.5",4,"ngIf","ngIfElse"],["notConnected",""],[1,"social-img",3,"src"],["name","checkmark-outline",1,"absolute","-top-2","-left-2","connected","text-white","rounded-full","w-5","h-5","p-0.5"],["name","add-outline",1,"absolute","-top-2","-left-2","not-connected","text-white","rounded-full","w-5","h-5","p-0.5"],[1,"flex","flex-col","w-full","min-h-[600px]","overflow-y-auto","overflow-x-hidden","bg-white","rounded-xl","pulSate"],[3,"isOpen","socialAccount","isOpenChange","onRefreshAccount"]],template:function(e,t){if(1&e&&(o.YNc(0,Io,87,74,"ng-container",0),o.YNc(1,To,1,0,"ng-template",null,1,o.W1O),o.TgZ(3,"app-invite-modal",2),o.NdJ("isOpenChange",function(r){return t.isInviteModalShown=r}),o.qZA(),o.TgZ(4,"app-verification-modal",2),o.NdJ("isOpenChange",function(r){return t.isAuthModalShown=r}),o.qZA(),o.TgZ(5,"app-edit-email-modal",3),o.NdJ("confirmEmailAction",function(r){return t.onConfirmEmail(r)}),o.qZA(),o.TgZ(6,"app-edit-phone-modal",4),o.NdJ("confirmPhoneAction",function(r){return t.onConfirmPhone(r)}),o.qZA(),o.TgZ(7,"app-change-password-modal",5),o.NdJ("changePasswordAction",function(r){return t.onChangePassword(r)}),o.qZA(),o.YNc(8,Eo,1,2,"app-connect-social-modal",6)),2&e){const i=o.MAs(2);o.Q6J("ngIf",t.userInfo)("ngIfElse",i),o.xp6(3),o.Q6J("isOpen",t.isInviteModalShown),o.xp6(1),o.Q6J("isOpen",t.isAuthModalShown),o.xp6(1),o.Q6J("isOpen",t.isEmailModalShown)("email",(null==t.userInfo?null:t.userInfo.email)||""),o.xp6(1),o.Q6J("isOpen",t.isPhoneModalShown)("mobileArea",(null==t.userInfo?null:t.userInfo.mobileArea)||"")("mobile",(null==t.userInfo?null:t.userInfo.mobile)||""),o.xp6(1),o.Q6J("isOpen",t.isChangePasswordModalShown),o.xp6(1),o.Q6J("ngIf",t.isOpenConnectSocialModal)}},dependencies:[d.mk,d.sg,d.O5,d.RF,d.n9,d.ED,l.Fj,l.JJ,q.a,l.oH,p.YG,p.W4,p.gu,F.g,Q,j.z,Y.E,v,T.t,E.a,V,to,ho,g.X$,Z.e,fo],styles:['ion-button[_ngcontent-%COMP%]{--box-shadow: none}ion-button.change-password-btn[_ngcontent-%COMP%]{--border-color: #c7c7c790;--border-width: 1px;--border-style: solid}.profile-avatar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: .75rem;--transition: background-color .4s ease, color .4s ease, border-color .4s ease;--padding-top: 0;--padding-bottom: 0;--background: #fb8811}.share-btn[_ngcontent-%COMP%]{--background: #fb8811;--border-radius: 5px;height:33px}div[appDragAndDrop][_ngcontent-%COMP%]:before{position:fixed;inset:0;z-index:50;background-color:#00000015;opacity:0;content:"";transition-duration:.2s;pointer-events:none}div[appDragAndDrop].fileover[_ngcontent-%COMP%]:before{opacity:1}div.drop-zone-container[_ngcontent-%COMP%]{background:linear-gradient(90deg,#3880ff 50%,transparent 0) repeat-x,linear-gradient(90deg,#3880ff 50%,transparent 0) repeat-x,linear-gradient(0deg,#3880ff 50%,transparent 0) repeat-y,linear-gradient(0deg,#3880ff 50%,transparent 0) repeat-y;background-size:16px 3px,16px 3px,3px 16px,3px 16px;background-position:0 0,0 100%,0 0,100% 0;animation:linearGradientMove .3s infinite linear}div.drop-zone-container[_ngcontent-%COMP%]   div.drop-zone[_ngcontent-%COMP%]{width:calc(100% - 6px);height:calc(100% - 6px)}div.drop-zone-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none}@keyframes linearGradientMove{to{background-position:16px 0,-16px 100%,0 -16px,100% 16px}}.password-box-outer[_ngcontent-%COMP%]{height:40px;width:160px}.password-box-outer[_ngcontent-%COMP%]   .password-box-inner[_ngcontent-%COMP%]{height:30px;width:150px}.password-box-outer[_ngcontent-%COMP%]:hover   .password-box-inner[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity));transition:all .3s}.bevel[_ngcontent-%COMP%]{clip-path:polygon(15% 0%,85% 0%,100% 20%,100% 80%,85% 100%,15% 100%,0% 80%,0% 20%)}button[disabled][_ngcontent-%COMP%]{opacity:.3}.social-connect[_ngcontent-%COMP%]{max-width:550px;border-color:#ededed}.social-connect[_ngcontent-%COMP%]   .social-account[_ngcontent-%COMP%]:hover{border-color:#0187ff;box-shadow:0 0 1px 1px #0187ff}.social-connect[_ngcontent-%COMP%]   .social-account[_ngcontent-%COMP%]   .not-connected[_ngcontent-%COMP%]{background:#0187ff;--ionicon-stroke-width: 60}.social-connect[_ngcontent-%COMP%]   .social-account[_ngcontent-%COMP%]   .connected[_ngcontent-%COMP%]{background:#19e479;--ionicon-stroke-width: 60}.social-connect[_ngcontent-%COMP%]   .social-account[_ngcontent-%COMP%]   .social-img[_ngcontent-%COMP%]{width:60px;height:60px}']}),n})()}];let zo=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[w.Bz.forChild(ko),w.Bz]}),n})();var Uo=s(44466),Jo=s(7492),So=s(16424),Lo=s(65433);let No=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[d.ez,l.u5,So.g,l.UX,zo,Jo.R,p.Pc,g.aw,Uo.m,v,T.t,Lo.kb,E.a]}),n})()}}]);