"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[4620],{14754:(x,f,r)=>{r.d(f,{s:()=>h});var s=r(92340),t=r(54004),u=r(94650),p=r(80529);let h=(()=>{class d{constructor(a){this.http=a}getAfterSales(a){return this.http.get(`${s.N.BASE_URL}/user/afterSales/getAfterSalesList`,{params:a}).pipe((0,t.U)(({data:c})=>c))}getAfterSalesDetails(a){return this.http.get(`${s.N.BASE_URL}/user/afterSales/getAfterSalesDetails`,{params:a}).pipe((0,t.U)(({data:c})=>c))}getAfterSalesGuaranteeV2(a){return this.http.get(`${s.N.BASE_URL}/user/afterSales/getAfterSalesGuaranteeV2`,{params:a})}applyPickup(a){return this.http.post(`${s.N.BASE_URL}/user/afterSales/applyPickup`,a)}saveAfterSales(a){return this.http.post(`${s.N.BASE_URL}/user/afterSales/saveAfterSales`,a)}uploadAction(a){const c=new FormData;return c.append("dir","aftersales"),c.append("file",a),this.http.post(`${s.N.BASE_URL}/shop/storage/fileStore`,c)}}return d.\u0275fac=function(a){return new(a||d)(u.LFG(p.eN))},d.\u0275prov=u.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},84620:(x,f,r)=>{r.d(f,{E:()=>S});var s=r(15861),t=r(94650),u=r(54004),p=r(82722),h=r(40866),d=r(75604),g=r(24499),a=r(24006),c=r(94830),v=r(54463),M=r(14754),m=r(95133),C=r(36895),A=r(38461),E=r(18006);function O(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.MAs(5).click(),t.KtG(o.CARD=1)}),t.TgZ(1,"p",17),t._uU(2),t.ALo(3,"translate"),t.qZA()()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Upload-front-ID-information")," "))}function D(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.MAs(5).click(),t.KtG(o.CARD=1)}),t._UZ(1,"img",19),t.qZA()}if(2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("src",e.frontIDCard,t.LSH)}}function T(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",16),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.MAs(5).click(),t.KtG(o.CARD=2)}),t.TgZ(1,"p",17),t._uU(2),t.ALo(3,"translate"),t.qZA()()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Upload-reverse-side-information")," "))}function I(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.MAs(5).click(),t.KtG(o.CARD=2)}),t._UZ(1,"img",19),t.qZA()}if(2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("src",e.behindIDCard,t.LSH)}}function Z(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div"),t.YNc(1,O,4,3,"div",12),t.YNc(2,D,2,1,"div",13),t.YNc(3,T,4,3,"div",12),t.YNc(4,I,2,1,"div",13),t.TgZ(5,"div",14)(6,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.upload())}),t._uU(7),t.ALo(8,"translate"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.frontIDCard),t.xp6(1),t.Q6J("ngIf",e.frontIDCard),t.xp6(1),t.Q6J("ngIf",!e.behindIDCard),t.xp6(1),t.Q6J("ngIf",e.behindIDCard),t.xp6(3),t.hij(" ",t.lcZ(8,5,"account-info-upload-photo")," ")}}function b(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",20)(1,"form",21)(2,"div",22)(3,"div",23)(4,"sup",24),t._uU(5,"*"),t.qZA(),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",25),t._UZ(9,"ion-input",26),t.qZA()(),t.TgZ(10,"div",22)(11,"div",23)(12,"sup",24),t._uU(13,"*"),t.qZA(),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"div",25),t._UZ(17,"ion-input",27),t.qZA()(),t.TgZ(18,"p",28),t._uU(19),t.ALo(20,"translate"),t.qZA()(),t.TgZ(21,"div",14)(22,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.FaceRecognition=!1)}),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"ion-button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.faceCheck())}),t._uU(26),t.ALo(27,"translate"),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("formGroup",e.authForm),t.xp6(5),t.hij(" ",t.lcZ(7,8,"auth-modal-name")," "),t.xp6(3),t.Q6J("disabled",!0),t.xp6(5),t.hij(" ",t.lcZ(15,10,"auth-modal-ID-card")," "),t.xp6(3),t.Q6J("disabled",!0),t.xp6(2),t.hij(" ",t.lcZ(20,12,"Please-check-ID-information")," "),t.xp6(4),t.hij(" ",t.lcZ(24,14,"user-return-upload")," "),t.xp6(3),t.hij(" ",t.lcZ(27,16,"auth-modal-Face-Recognition")," ")}}function P(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",5)(2,"p",6),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",7),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return o.isOpenChange.emit(!1),t.KtG(o.FaceRecognition=!1)}),t._UZ(6,"app-close-icon",8),t.qZA()(),t.TgZ(7,"div",9),t.YNc(8,Z,9,7,"div",10),t.YNc(9,b,28,18,"ng-template",null,11,t.W1O),t.qZA()()}if(2&i){const e=t.MAs(10),n=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,3,"modal-Real-Name-Authentication")," "),t.xp6(5),t.Q6J("ngIf",!n.FaceRecognition)("ngIfElse",e)}}function L(i,_){if(1&i){const e=t.EpF();t.TgZ(0,"app-invite-qr-modal",29),t.NdJ("isOpenChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.isQRModalShown=o)}),t.qZA()}if(2&i){const e=_.ngIf,n=t.oxw();t.Q6J("isOpen",n.isQRModalShown)("shareLink",e)}}let S=(()=>{class i extends g.c{constructor(e,n,o,l,U,R,k){super(e,n),this.userService=o,this.translate=l,this.fb=U,this.AfterSalesService=R,this.toast=k,this.isOpenChange=new t.vpe,this.inviteText=d.f,this.inviteTextKey="share-meta-content",this.domainName=location.origin,this.FaceRecognition=!1,this.fileList=[],this.frontIDCard="",this.behindIDCard="",this.shareLink="",this.CARD=1}ngOnInit(){var e=this;return(0,s.Z)(function*(){yield e.createForm(),e.userInfo$=e.userService.userInfo$,e.shareLinkText$=e.userService.userInfo$.pipe((0,u.U)(n=>`${h.R}/invite?recommenderId=${n?.id}`)),e.translate.get(e.inviteTextKey).subscribe(n=>{!n||(e.inviteText=n)}),console.log(window.getMetaInfo())})()}toastError(e){var n=this;return(0,s.Z)(function*(){yield n.presentToast({position:"bottom",message:e,icon:"alert-circle-outline",duration:1e3,color:"danger"})})()}toastSuccess(e){var n=this;return(0,s.Z)(function*(){yield n.presentToast({position:"bottom",message:e,duration:1e3,icon:"checkmark-circle-outline",color:"success"})})()}presentToast(e){var n=this;return(0,s.Z)(function*(){yield(yield n.toast.create(e)).present()})()}createForm(){var e=this;return(0,s.Z)(function*(){e.authForm=e.fb.group({idCard:["",[a.kI.required]],name:["",[a.kI.required]]})})()}upload(){this.frontIDCard&&this.behindIDCard?this.userService.upload({frontImage:this.frontIDCard,backImage:this.behindIDCard}).pipe((0,p.R)(this.destroyStream$)).subscribe(n=>{if(Object.is(n.code,0))return this.authForm.get("name")?.patchValue(n.data.name),this.authForm.get("idCard")?.patchValue(n.data.idCard),this.toastSuccess("\u4e0a\u4f20\u6210\u529f"),void(this.FaceRecognition=!0);this.toastError(n.message)},n=>{}):this.toastError("\u8bf7\u4e0a\u4f20\u5b8c\u6574\u5f97\u6b63\u53cd\u9762\u7167\u7247")}openQrModal(){this.isQRModalShown=!0}faceCheck(){if(!this.authForm.get("name")?.valid&&this.authForm.get("idCard")?.valid)return void this.toastError("\u8bf7\u586b\u5199\u5b8c\u6574");const e={name:this.authForm.get("name")?.value,idCard:this.authForm.get("idCard")?.value,metaInfo:JSON.stringify(window.getMetaInfo())};console.log(e),this.userService.faceVerify(e).pipe((0,p.R)(this.destroyStream$)).subscribe(n=>{0===n.code?(console.log(n.data),window.location.href=n.data,this.toastSuccess("\u4e0a\u4f20\u6210\u529f")):this.toastError(n.message)},n=>{this.toastError(n.message)})}fileBrowseHandler(e){const n=e.target.files;!n.length||(this.fileList=n,this.AfterSalesService.uploadAction(this.fileList[0]).pipe((0,p.R)(this.destroyStream$)).subscribe(o=>{switch(console.log(o.data[0]),this.CARD){case 1:this.frontIDCard=o.data[0];break;case 2:this.behindIDCard=o.data[0]}console.log(this.frontIDCard,this.behindIDCard),this.toastSuccess("\u4e0a\u4f20\u6210\u529f")},o=>{this.toastError(o.message)}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(c.K),t.Y36(v.sK),t.Y36(a.qu),t.Y36(M.s),t.Y36(m.yF))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-verification-modal"]],inputs:{isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange"},features:[t.qOj],decls:6,vars:4,consts:[[3,"isOpen","didDismiss"],[3,"isOpen","shareLink","isOpenChange",4,"ngIf"],["id","upload-avatar","type","file","accept","image/*",1,"hidden",3,"change"],["file",""],[1,"invite-modal","flex","flex-col","rounded-[12px]","overflow-hidden"],["id","modal-header",1,"flex","items-center","bg-[#f4f4f4]","p-2","rounded-t-[12px]","w-full"],[1,"font-medium","text-2xl","mr-4","tracking-tighter"],[1,"rounded-[5px]","bg-[#ff2145]","p-1","ml-auto","w-[36px]","h-[36px]","flex","items-center","justify-center","outline-none",3,"click"],[1,"w-[24px]","text-white"],["id","modal-body",1,"bg-white","w-full","rounded-b-[12px]","h-full","overflow-y-auto","shadow-scroll","px-4","py-3"],[4,"ngIf","ngIfElse"],["face",""],["class","img_box",3,"click",4,"ngIf"],["class","upload_img",3,"click",4,"ngIf"],[1,"upload_btn"],[1,"normal-case","share-btn","h-8","z-40",3,"click"],[1,"img_box",3,"click"],[1,"font-bold","tracking-tighter","mb-2","text-[20px]"],[1,"upload_img",3,"click"],[3,"src"],[1,"p-4"],[3,"formGroup"],[1,"form-group-control","mb-6","flex","items-center"],[1,"form-label"],[1,"text-red-500",2,"top","-0.15em"],[1,"form-input"],["formControlName","name","name","",3,"disabled"],["formControlName","idCard","idCard","",3,"disabled"],[1,"tracking-tighter","mb-4","text-[10px]","flex","items-center","justify-center"],[3,"isOpen","shareLink","isOpenChange"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-modal",0),t.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),t.YNc(1,P,11,5,"ng-template"),t.qZA(),t.YNc(2,L,1,2,"app-invite-qr-modal",1),t.ALo(3,"async"),t.TgZ(4,"input",2,3),t.NdJ("change",function(l){return n.fileBrowseHandler(l)}),t.qZA()),2&e&&(t.Q6J("isOpen",n.isOpen),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,2,n.shareLinkText$)))},dependencies:[C.O5,a._Y,a.JJ,a.JL,a.sg,a.u,m.YG,m.pK,m.ki,m.j9,A.D,E.a,C.Ov,v.X$],styles:[".invite-modal[_ngcontent-%COMP%]{width:414px;max-height:95vh;max-width:95vw}.invite-modal__icon[_ngcontent-%COMP%]{width:56px;height:56px}.invite-modal__copy-url[_ngcontent-%COMP%]{background:#cbcbcb;border:1px solid #406899}.invite-modal[_ngcontent-%COMP%]   .upload_img[_ngcontent-%COMP%]{cursor:pointer;width:100%;margin-bottom:20px;height:130px}.invite-modal[_ngcontent-%COMP%]   .upload_img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:5px}.invite-modal[_ngcontent-%COMP%]   .img_box[_ngcontent-%COMP%]{cursor:pointer;border:1px dashed #333333;padding:50px;border-radius:3%;display:flex;justify-content:center;align-items:center;margin-bottom:20px}.invite-modal[_ngcontent-%COMP%]   .share-btn[_ngcontent-%COMP%]{--background: #fb8811;--border-radius: 5px;--min-height: 20px}.invite-modal[_ngcontent-%COMP%]   .upload_btn[_ngcontent-%COMP%]{text-align:center}"]}),i})()}}]);