"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[117],{75604:(P,x,s)=>{s.d(x,{f:()=>u,v:()=>_});const u="Tyqoon: The Next Generation of Digital Commerce",_=[{title:"game-board-shop-manager",description:"game-board-month-sale-volume",level:"1",isStar:!1,franchiseImage:"assets/images/shop.png",plusAmount:"1"},{title:"game-board-shop-manager",description:"game-board-month-sale-volume",level:"2",isStar:!1,franchiseImage:"assets/images/mini-mart.png",plusAmount:"1"},{title:"game-board-shop-manager",description:"game-board-month-sale-volume",level:"3",isStar:!1,franchiseImage:"assets/images/supermarket.png",plusAmount:"1"},{title:"game-board-shop-manager",description:"game-board-month-sale-volume",level:"4",isStar:!0,franchiseImage:"assets/images/mall.png",plusAmount:"2"},{title:"game-board-shop-manager",description:"game-board-month-sale-volume",level:"5",isStar:!1,franchiseImage:"assets/images/mini-mart.png",plusAmount:"1"}]},73055:(P,x,s)=>{s.r(x),s.d(x,{CheckoutConfirmModule:()=>Qe});var u=s(36895),_=s(81212),c=s(95133),h=s(54463),e=s(94650);const O=function(){return["/member","profile"]};function d(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"\u624b\u673a\u53f7\u3001\u90ae\u7bb1\u7ed1\u5b9a"),e.qZA(),e.TgZ(4,"ion-buttons",2)(5,"ion-button",3),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(6,"\u2715"),e.qZA()()()(),e.TgZ(7,"div",4),e._uU(8),e.qZA(),e._UZ(9,"div",5),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(15),e.ALo(16,"translate"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(8),e.hij(" ",t.modalContent," "),e.xp6(4),e.Oqu(e.lcZ(13,4,"cancel")),e.xp6(2),e.Q6J("routerLink",e.DdM(8,O)),e.xp6(1),e.Oqu(e.lcZ(16,6,"ok"))}}let b=(()=>{class i{constructor(t,n){this.translate=t,this.router=n,this.isOpenChange=new e.vpe,this.dismissModal=o=>{this.modal.dismiss(o)},this.handleOk=()=>{this.router.navigate(["/auth/login"],{queryParams:{back:encodeURIComponent(this.router.url)}}),this.dismissModal("ok")}}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.sK),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-bind-email-phone-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(c.ki,5),2&t){let o;e.iGM(o=e.CRH())&&(n.modal=o.first)}},inputs:{isOpen:"isOpen",modalContent:"modalContent"},outputs:{isOpenChange:"isOpenChange"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[[1,"profile-modal",3,"isOpen","didDismiss"],["profileModal",""],["slot","end"],[3,"click"],[1,"p-4"],[1,"border-b","border-[#dddddd]"],[1,"flex","justify-end","p-4"],[1,"border","border-[#dddddd]","py-2","px-4","capitalize",3,"click"],[1,"bg-primary","rounded","text-white","py-2","px-4","capitalize",3,"routerLink","click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0,1),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(2,d,17,9,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.Pc,c.YG,c.Sm,c.Gu,c.wd,c.sr,c.ki,c.YI,u.ez,h.aw,h.X$,_.Bz,_.rH],styles:[".profile-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 8px;--width: 400px}"]}),i})();function w(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"\u4f59\u989d\u4e0d\u8db3"),e.qZA(),e.TgZ(4,"ion-buttons",2)(5,"ion-button",3),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(6,"\u2715"),e.qZA()()()(),e.TgZ(7,"div",4),e._uU(8," \u8bf7\u5148\u5145\u503c\u4f59\u989d\u6216\u9009\u62e9\u5728\u7ebf\u652f\u4ed8 "),e.qZA(),e._UZ(9,"div",5),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(1);return e.KtG(o.dismiss())}),e._uU(15),e.ALo(16,"translate"),e.qZA()()}2&i&&(e.xp6(12),e.Oqu(e.lcZ(13,2,"\u4f59\u989d\u5145\u503c")),e.xp6(3),e.Oqu(e.lcZ(16,4,"\u5728\u7ebf\u652f\u4ed8")))}let Z=(()=>{class i{constructor(t,n){this.translate=t,this.router=n,this.isOpenChange=new e.vpe}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.sK),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-insufficient-balance-modal"]],viewQuery:function(t,n){if(1&t&&e.Gf(c.ki,5),2&t){let o;e.iGM(o=e.CRH())&&(n.modal=o.first)}},inputs:{isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[[1,"profile-modal",3,"isOpen","didDismiss"],["modal",""],["slot","end"],[3,"click"],[1,"p-4"],[1,"border-b","border-[#dddddd]"],[1,"flex","justify-end","p-4"],[1,"border","border-[#dddddd]","py-2","px-4","capitalize",3,"click"],[1,"bg-primary","rounded","text-white","py-2","px-4","capitalize",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0,1),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(2,w,17,6,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.Pc,c.YG,c.Sm,c.Gu,c.wd,c.sr,c.ki,u.ez,h.aw,h.X$,_.Bz],styles:[".profile-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 8px;--width: 400px}"]}),i})();var E=s(16424),F=s(44466),S=s(98389),I=s(48910),m=s(15861),v=s(82722),g=s(49808),N=s(24499),k=s(51304),B=s(24837),l=s(11781),J=s(18110),A=s(94128),L=s(45329),D=s(52186),R=s(80164),Q=s(35482),Y=s(56889),j=s(13194),G=s(81189),z=s(16016),H=s(99355),K=s(71346),V=s(70957),$=s(49127),W=s(45210),X=s(18215);function ee(i,r){if(1&i&&(e.TgZ(0,"div")(1,"div",10),e._UZ(2,"img",11),e.TgZ(3,"div",12),e._uU(4),e.qZA()(),e.TgZ(5,"div",13),e._uU(6),e.qZA()()),2&i){const t=r.$implicit;e.xp6(2),e.Q6J("src",null==t?null:t.cover,e.LSH),e.xp6(2),e.Oqu(null==t?null:t.productName),e.xp6(2),e.Oqu(t.message)}}function te(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"div",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"img",5)(7,"img",6),e.qZA(),e.TgZ(8,"div",7),e.YNc(9,ee,7,3,"div",8),e.qZA(),e.TgZ(10,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getVouchers())}),e._uU(11),e.ALo(12,"translate"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,3,"tip-sorry-title")),e.xp6(5),e.Q6J("ngForOf",t.dealData),e.xp6(2),e.Oqu(e.lcZ(12,5,"backto-my-cart"))}}new e.OlP("ModalData");let ne=(()=>{class i{constructor(t,n){this.cartService=t,this.router=n,this.isOpenChange=new e.vpe,this.confirm=new e.vpe}get dealData(){let t=[];return this.res.forEach(n=>{this.getData.forEach(o=>{n.shop_sku_id==o.skuId&&t.push({cover:o.productImages[0].thumbnail,productName:o.productName,message:n.remarks,code:n.err_code})})}),console.log(this.getData),console.log(t),t}getVoucher(){this.isOpenChange.emit(!1)}getVouchers(){this.isOpenChange.emit(!1),setTimeout(()=>{this.router.navigate(["cart"],{replaceUrl:!0})},800)}handleConfirm(){this.confirm.emit()}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(A.N),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-out-of-stock"]],inputs:{isOpen:"isOpen",getData:"getData",res:"res",realCashback:"realCashback",totalCashback:"totalCashback"},outputs:{isOpenChange:"isOpenChange",confirm:"confirm"},decls:2,vars:1,consts:[[3,"isOpen","didDismiss"],[1,"p-6"],[1,"flex","justify-center","items-center","mb-8","md:mb-10"],["src","assets/images/cart-stop.png","alt","",1,"h-14","md:h-20"],[1,"ml-2","text-4xl","md:text-6xl","font-extrabold","whitespace-nowrap"],["src","assets/images/shape.png","alt","",1,"-ml-10"],["src","assets/images/mascot-stop.png","alt","",1,"h-14","md:h-20"],[1,"content","maxbg"],[4,"ngFor","ngForOf"],[1,"btn-continue","text-white-500","text-xl","md:text-2xl","py-2","font-bold","block","m-auto",2,"color","#FFFFFF!important",3,"click"],[1,"flex"],["alt","shape",2,"width","100px","height","100px",3,"src"],[1,"flex","justify-center","items-center",2,"width","100%"],[1,"text-16px","block","line-clamp-1","font-bold",2,"padding","5px","color","red"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(1,te,13,7,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[u.sg,c.ki,h.X$],styles:["ion-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 15px;--max-width: 550px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f5f5f5;-webkit-box-shadow:inset 0 0 3px rgba(0,0,0,.1);border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-button{background-color:#eee;display:none}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:#000}.content[_ngcontent-%COMP%]{padding:32px 35px;text-align:center;max-height:500px;overflow-x:hidden;overflow-y:scroll}.content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#000;line-height:22px}.content[_ngcontent-%COMP%]   .text.text3[_ngcontent-%COMP%]{margin-top:20px}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:26px;color:#1cb980;padding:12px 0;font-weight:700}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;margin-left:12px}.content[_ngcontent-%COMP%]   .btn-get-vouchers[_ngcontent-%COMP%]{display:block;margin:30px auto 0;width:318px;height:76px;line-height:76px;background:#008AFF;border-radius:16px;font-size:36px;font-weight:700;color:#fff}.content[_ngcontent-%COMP%]   .btn-continue[_ngcontent-%COMP%]{cursor:pointer;font-size:22px;font-weight:700;color:red;line-height:60px;text-align:center}.title[_ngcontent-%COMP%]{font-size:50px}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.btn-get-vouchers[_ngcontent-%COMP%]{background-color:#008aff}.btn-continue[_ngcontent-%COMP%]{border:1px solid #f3f3f3;border-radius:10px;padding:5px 10px;background:linear-gradient(270deg,#ff6009 0%,#ff8340 100%);color:#fff;margin-top:20px}"]}),i})();function oe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"div",4),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"img",5)(7,"img",6),e.qZA(),e.TgZ(8,"div",7)(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"button",8),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.getVouchers())}),e._uU(13),e.ALo(14,"translate"),e.qZA()()}2&i&&(e.xp6(4),e.Oqu(e.lcZ(5,3,"tip-sorry-title")),e.xp6(6),e.Oqu(e.lcZ(11,5,"verify-name-before-shopping")),e.xp6(3),e.Oqu(e.lcZ(14,7,"Now-certified")))}new e.OlP("ModalData");let ie=(()=>{class i{constructor(t,n){this.cartService=t,this.router=n,this.isOpenChange=new e.vpe,this.confirm=new e.vpe}getVouchers(){this.isOpen=!1,this.isOpenChange.emit(!1)}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(A.N),e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-verify-name"]],inputs:{isOpen:"isOpen",getData:"getData",res:"res",realCashback:"realCashback",totalCashback:"totalCashback"},outputs:{isOpenChange:"isOpenChange",confirm:"confirm"},decls:2,vars:1,consts:[[3,"isOpen","didDismiss"],[1,"p-6"],[1,"flex","justify-center","items-center","mb-8","md:mb-10"],["src","assets/images/cart-stop.png","alt","",1,"h-14","md:h-20"],[1,"ml-2","text-4xl","md:text-6xl","font-extrabold","whitespace-nowrap"],["src","assets/images/shape.png","alt","",1,"-ml-10"],["src","assets/images/mascot-stop.png","alt","",1,"h-14","md:h-20"],[1,"content"],[1,"btn-continue","text-white-500","text-xl","md:text-2xl","py-2","font-bold","block","m-auto",2,"color","#FFFFFF!important",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-modal",0),e.NdJ("didDismiss",function(){return n.isOpenChange.emit(!1)}),e.YNc(1,oe,15,9,"ng-template"),e.qZA()),2&t&&e.Q6J("isOpen",n.isOpen)},dependencies:[c.ki,h.X$],styles:["ion-modal[_ngcontent-%COMP%]{--background: white;--border-radius: 15px;--max-width: 550px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f5f5f5;-webkit-box-shadow:inset 0 0 3px rgba(0,0,0,.1);border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#0003;border-radius:5px}[_ngcontent-%COMP%]::-webkit-scrollbar-button{background-color:#eee;display:none}[_ngcontent-%COMP%]::-webkit-scrollbar-corner{background-color:#000}.content[_ngcontent-%COMP%]{padding:32px 35px;text-align:center;max-height:500px;overflow:hidden}.content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#000;line-height:22px}.content[_ngcontent-%COMP%]   .text.text3[_ngcontent-%COMP%]{margin-top:20px}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:26px;color:#1cb980;padding:12px 0;font-weight:700}.content[_ngcontent-%COMP%]   .cashback[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:28px;margin-left:12px}.content[_ngcontent-%COMP%]   .btn-get-vouchers[_ngcontent-%COMP%]{display:block;margin:30px auto 0;width:318px;height:76px;line-height:76px;background:#008AFF;border-radius:16px;font-size:36px;font-weight:700;color:#fff}.content[_ngcontent-%COMP%]   .btn-continue[_ngcontent-%COMP%]{cursor:pointer;font-size:22px;font-weight:700;color:red;line-height:60px;text-align:center}.title[_ngcontent-%COMP%]{font-size:50px}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.btn-get-vouchers[_ngcontent-%COMP%]{background-color:#008aff}.btn-continue[_ngcontent-%COMP%]{border:1px solid #f3f3f3;border-radius:10px;padding:5px 10px;background:linear-gradient(270deg,#ff6009 0%,#ff8340 100%);color:#fff;margin-top:20px}"]}),i})();var re=s(84620),se=s(90147),ae=s(71832),U=s(39172),q=s(1470),ce=s(82123),de=s(93774),le=s(11691),pe=s(5565);function ue(i,r){1&i&&(e.TgZ(0,"ion-list")(1,"ion-item",2)(2,"ion-label")(3,"h3"),e._UZ(4,"ion-skeleton-text",3)(5,"ion-skeleton-text",4),e.qZA(),e.TgZ(6,"p"),e._UZ(7,"ion-skeleton-text",5),e.qZA(),e.TgZ(8,"p"),e._UZ(9,"ion-skeleton-text",5),e.qZA(),e.TgZ(10,"p"),e._UZ(11,"ion-skeleton-text",5),e.qZA(),e.TgZ(12,"p"),e._UZ(13,"ion-skeleton-text",5),e.qZA()()()()),2&i&&(e.xp6(4),e.Q6J("animated",!0),e.xp6(1),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0),e.xp6(2),e.Q6J("animated",!0))}function me(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8)(5,"div",9),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",10),e._uU(9),e.ALo(10,"currency"),e.qZA()(),e.TgZ(11,"div",11),e._uU(12),e.ALo(13,"translate"),e.qZA(),e._UZ(14,"div",12),e.TgZ(15,"div",13)(16,"div",14),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div",15),e._uU(20),e.ALo(21,"currency"),e.qZA()(),e.TgZ(22,"div",13)(23,"div",14),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",15),e._uU(27),e.ALo(28,"currency"),e.qZA()(),e._UZ(29,"div",12),e.TgZ(30,"div",13)(31,"div",14),e._uU(32),e.ALo(33,"translate"),e.qZA(),e.TgZ(34,"div",16),e._uU(35),e.ALo(36,"currency"),e.qZA()(),e.TgZ(37,"button",17),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.pay())}),e._uU(38),e.ALo(39,"translate"),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,11,"store-credit")," "),e.xp6(4),e.hij(" ",e.lcZ(7,13,"store-credit-my-credit")," "),e.xp6(3),e.Oqu(e.lcZ(10,15,null==t.user?null:t.user.balance)),e.xp6(3),e.hij(" ",e.lcZ(13,17,"checkout-payment-methods-balance")," "),e.xp6(5),e.Oqu(e.lcZ(18,19,"balance-details-current-balance")),e.xp6(3),e.Oqu(e.lcZ(21,21,null==t.user?null:t.user.balance)),e.xp6(4),e.Oqu(e.lcZ(25,23,"checkout-balance-use")),e.xp6(3),e.Oqu(e.lcZ(28,25,t.amount)),e.xp6(5),e.Oqu(e.lcZ(33,27,"checkout-balance-remaining")),e.xp6(3),e.Oqu(e.lcZ(36,29,t.remaining)),e.xp6(3),e.Oqu(e.lcZ(39,31,"checkout-balance-confirm"))}}let _e=(()=>{class i extends pe.V{constructor(t){super(),this.userService=t,this.confirm=new e.vpe,this.loading={pay:!1}}ngOnInit(){this.userService.userInfo$.pipe((0,v.R)(this.destroyStream$)).subscribe(t=>{this.user=t})}get remaining(){return(this.user?.balance||0)-(this.amount||0)}get cannotPay(){return this.remaining<0}pay(){this.confirm.emit(),this.loading.pay=!0}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(L.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-pay-by-balance"]],inputs:{amount:"amount"},outputs:{confirm:"confirm"},features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["unloading",""],["lines","none"],[2,"width","30%","height","15px",3,"animated"],[2,"width","100%","height","45px",3,"animated"],[2,"width","100%","height","15px",3,"animated"],[1,""],[1,"font-bold","text-3xl"],[1,"border-2","border-black","p-2","rounded-lg","text-center","my-2"],[1,"mb-2","font-bold"],[1,"text-3xl","font-bold"],[1,"text-2xl","font-bold"],[1,"border-b","border-[#dddddd]","my-2"],[1,"flex","justify-between","items-center"],[1,"font-medium","opacity-60","text-base","sm:text-xl","mr-2"],[1,"text-lg","sm:text-2xl","opacity-70","font-bold","whitespace-nowrap"],[1,"text-2xl","sm:text-3xl","font-medium","whitespace-nowrap"],[1,"text-4xl","font-bold","py-4","w-full","text-center","rounded-md","mt-4",3,"click"]],template:function(t,n){if(1&t&&(e.YNc(0,ue,14,6,"ion-list",0),e.YNc(1,me,40,33,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(2);e.Q6J("ngIf",n.loading.pay)("ngIfElse",o)}},dependencies:[u.O5,c.Ie,c.Q$,c.q_,c.CK,u.H9,h.X$],styles:["button[_ngcontent-%COMP%]{background-color:#fbdf45}button[disabled][_ngcontent-%COMP%]{opacity:.5}"]}),i})();const he=["methodsCard"],ge=["methodsCrypto"],fe=["methodsDomestic"];function Ce(i,r){if(1&i&&e._UZ(0,"app-cart-item",43),2&i){const t=r.$implicit;e.Q6J("readonly",!0)("cartItem",t)}}function xe(i,r){1&i&&e._UZ(0,"div",44)}function ve(i,r){if(1&i&&(e.TgZ(0,"div",45)(1,"div",24),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",46)(5,"span",47),e._uU(6),e.ALo(7,"currency"),e.qZA(),e._UZ(8,"img",48),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(2),e.hij(" ",e.lcZ(3,2,"tqc-total-discount-credits-v1-1"),": "),e.xp6(4),e.hij("-",e.lcZ(7,4,null==t.orderSum?null:t.orderSum.toTalTQC),"")}}function be(i,r){if(1&i&&(e.TgZ(0,"div")(1,"div",49),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"div",50),e._uU(8),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(2),e.hij(" ",t.selectedReceiver.consignee," "),e.xp6(2),e.Oqu(t.selectedReceiver.phone),e.xp6(2),e.Oqu(t.selectedReceiver.address),e.xp6(2),e.Oqu(t.selectedReceiver.zipCode)}}function ye(i,r){1&i&&(e.TgZ(0,"div",51),e._UZ(1,"img",52),e.TgZ(2,"div",53),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&i&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"checkout-shipping-empty-tips")," "))}function Oe(i,r){1&i&&(e.TgZ(0,"div",69),e._UZ(1,"app-text-jumping",70),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Q6J("text",e.lcZ(2,1,"checkout-statistics-shipping-free")))}function Ze(i,r){if(1&i&&(e.TgZ(0,"div",60),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t.orderSum?null:t.orderSum.totalSumFreight)," ")}}function ke(i,r){if(1&i&&(e.TgZ(0,"div",58)(1,"div",59),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",71)(5,"span"),e._uU(6),e.ALo(7,"currency"),e.qZA(),e._UZ(8,"img",48),e.qZA()()),2&i){const t=e.oxw(4);e.xp6(2),e.hij(" ",e.lcZ(3,2,"tqc-discount-credits-v1-1")," "),e.xp6(4),e.hij("-",e.lcZ(7,4,null==t.orderSum?null:t.orderSum.toTalTQC),"")}}function Ae(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",78),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.handlePayUsingBalanceClick(o.paymentMethodsEnum.CARD))}),e.TgZ(1,"div",73)(2,"div",74),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",79),e._UZ(6,"img",80)(7,"img",81),e.qZA()(),e._UZ(8,"div",76),e.qZA()}2&i&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"checkout-payment-methods-card")," "))}function Te(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",78),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(5);return e.KtG(o.handlePayUsingBalanceClick(o.paymentMethodsEnum.DOMESTIC))}),e.TgZ(1,"div",73)(2,"div",74),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",79),e._UZ(6,"img",80),e.qZA()(),e._UZ(7,"div",76),e.qZA()}2&i&&(e.xp6(3),e.hij(" ",e.lcZ(4,1,"Online Payment")," "))}function Me(i,r){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",72),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.handlePayUsingBalanceClick(o.paymentMethodsEnum.BALANCE))}),e.TgZ(2,"div",73)(3,"div",74),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",75),e._uU(7),e.ALo(8,"currency"),e.qZA()(),e._UZ(9,"div",76),e.qZA(),e.YNc(10,Ae,9,3,"button",77),e.YNc(11,Te,8,3,"button",77),e.BQk()}if(2&i){const t=e.oxw(4);e.xp6(4),e.hij(" ",e.lcZ(5,4,"checkout-payment-methods-balance")," "),e.xp6(3),e.hij(" ",e.lcZ(8,6,null==t.userInfo?null:t.userInfo.balance)," "),e.xp6(3),e.Q6J("ngIf",!t.isShowDomesticPaymentMethods),e.xp6(1),e.Q6J("ngIf",t.isShowDomesticPaymentMethods)}}function Pe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"button",82),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(4);return e.KtG(o.handleClaimPrizes())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const t=e.oxw(4);e.Q6J("disabled",t.isLoadingClaimPrize),e.xp6(1),e.hij(" ",e.lcZ(2,2,"claim-prize")," ")}}function we(i,r){if(1&i&&(e.TgZ(0,"div")(1,"div",54)(2,"div",55),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",56),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e._UZ(8,"div",57),e.TgZ(9,"div",58)(10,"div",59),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",60),e._uU(14),e.ALo(15,"currency"),e.qZA()(),e.TgZ(16,"div",58)(17,"div",59),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.YNc(20,Oe,3,3,"div",61),e.YNc(21,Ze,3,3,"ng-template",null,62,e.W1O),e.qZA(),e.YNc(23,ke,9,6,"div",63),e.TgZ(24,"div",58)(25,"div",64),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"div",65),e._uU(29),e.ALo(30,"currency"),e.qZA()(),e._UZ(31,"div",66),e.TgZ(32,"div",67),e._uU(33),e.ALo(34,"translate"),e.qZA(),e.YNc(35,Me,12,8,"ng-container",30),e.YNc(36,Pe,3,4,"ng-template",null,68,e.W1O),e.qZA()),2&i){const t=e.MAs(22),n=e.MAs(37),o=e.oxw(2).ngLet,a=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,14,"checkout-order-total")," "),e.xp6(3),e.AsE(" ",a.cartList.length||0," ",e.lcZ(7,16,"checkout-items")," "),e.xp6(5),e.hij(" ",e.lcZ(12,18,"checkout-statistics-subtotal")," "),e.xp6(3),e.hij(" ",e.lcZ(15,20,null==a.orderSum?null:a.orderSum.originalPrice)," "),e.xp6(4),e.hij(" ",e.lcZ(19,22,"checkout-statistics-shipping")," "),e.xp6(2),e.Q6J("ngIf",0===(null==a.orderSum?null:a.orderSum.totalSumFreight))("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",!o),e.xp6(3),e.hij(" ",e.lcZ(27,24,"checkout-statistics-total"),": "),e.xp6(3),e.hij(" ",e.lcZ(30,26,null==a.orderSum?null:a.orderSum.totalSumPrice)," "),e.xp6(4),e.hij(" ",e.lcZ(34,28,"checkout-select-payment-methods")," "),e.xp6(2),e.Q6J("ngIf",!a.isFromPrize&&!a.isFromFreeGift)("ngIfElse",n)}}const Se=function(i){return{"address-btn":i}};function Ie(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16)(4,"h1",17),e._UZ(5,"app-top-back-button"),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e._UZ(9,"div",18),e.YNc(10,Ce,1,2,"app-cart-item",19),e._UZ(11,"div"),e.YNc(12,xe,1,0,"div",20),e.YNc(13,ve,9,6,"div",21),e.qZA(),e.TgZ(14,"div",22)(15,"div",23)(16,"div",24),e.O4$(),e.TgZ(17,"svg",25),e._UZ(18,"path",26),e.qZA()(),e.kcU(),e.TgZ(19,"div"),e._uU(20),e.ALo(21,"translate"),e.qZA()(),e._UZ(22,"div",27),e.TgZ(23,"div",28)(24,"div",29),e.YNc(25,be,9,4,"div",30),e.YNc(26,ye,5,3,"ng-template",null,31,e.W1O),e.qZA(),e.TgZ(28,"div",32)(29,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openEditAddressModal())}),e._UZ(30,"img",34),e.TgZ(31,"div",35),e._uU(32),e.ALo(33,"translate"),e.qZA()(),e.TgZ(34,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.isOpenChangeAddressModal=!0)}),e._UZ(35,"img",36),e.TgZ(36,"div",37),e._uU(37),e.ALo(38,"translate"),e.qZA()(),e.TgZ(39,"button",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.openCreateAddressModal())}),e.TgZ(40,"div",39),e._uU(41,"+"),e.qZA(),e.TgZ(42,"div",35),e._uU(43),e.ALo(44,"translate"),e.qZA()()()()()(),e.TgZ(45,"div",40)(46,"div",41),e.YNc(47,we,38,30,"div",30),e.qZA()()(),e._UZ(48,"div",42),e.qZA()}if(2&i){const t=e.MAs(27),n=e.oxw().ngLet,o=e.oxw(),a=e.MAs(10);e.xp6(7),e.Oqu(e.lcZ(8,16,"checkout-page-title")),e.xp6(3),e.Q6J("ngForOf",o.cartList)("ngForTrackBy",o.identify),e.xp6(2),e.Q6J("ngIf",!n),e.xp6(1),e.Q6J("ngIf",!n),e.xp6(7),e.hij(" ",e.lcZ(21,18,"checkout-shipping")," "),e.xp6(5),e.Q6J("ngIf",o.selectedReceiver)("ngIfElse",t),e.xp6(4),e.Q6J("disabled",!o.selectedAddress),e.xp6(3),e.hij(" ",e.lcZ(33,20,"checkout-shipping-edit")," "),e.xp6(2),e.Q6J("disabled",!(null!=o.shippingAddrs&&o.shippingAddrs.length)),e.xp6(3),e.hij(" ",e.lcZ(38,22,"checkout-shipping-change")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(26,Se,!o.selectedAddress)),e.xp6(4),e.hij(" ",e.lcZ(44,24,"checkout-shipping-add")," "),e.xp6(4),e.Q6J("ngIf",!o.selectedPaymentMethod)("ngIfElse",a)}}function Le(i,r){if(1&i&&(e.TgZ(0,"div",11),e.YNc(1,Ie,49,28,"div",12),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.cartList)}}function Ue(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-pay-by-balance",89),e.NdJ("confirm",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.confirmOrder())}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function qe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-payment-methods-crypto",90,91),e.NdJ("select",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.payWithCrypto())}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Ee(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-payment-methods-card",92,93),e.NdJ("select",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.payWithCard())})("onCloseAll",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onCloseAll())})("onRetry",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.selectedPaymentMethod=null)}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Fe(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-payment-methods-domestic",90,94),e.NdJ("select",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.payWithDomestic())}),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("amount",null==t.orderSum?null:t.orderSum.totalSumPrice)}}function Ne(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",83)(1,"div",84),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedPaymentMethod=null)}),e._UZ(2,"div",85),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"translate"),e.qZA()()(),e.YNc(6,Ue,1,1,"app-pay-by-balance",86),e.YNc(7,qe,2,1,"app-payment-methods-crypto",87),e.YNc(8,Ee,2,1,"app-payment-methods-card",88),e.YNc(9,Fe,2,1,"app-payment-methods-domestic",87)}if(2&i){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,5,"checkout-payment-methods-change")),e.xp6(2),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.BALANCE),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.CRYPTO),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.CARD),e.xp6(1),e.Q6J("ngIf",t.selectedPaymentMethod===t.paymentType.DOMESTIC)}}function Be(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-edit-address-modal",95),e.NdJ("onSuccess",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.handleSubmitAddressSuccess())})("isOpenChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.isOpenEditAddressModal=o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("currAddress",t.currAddress)("isOpen",t.isOpenEditAddressModal)}}function Je(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"app-change-address-modal",96),e.NdJ("addNewAddress",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openCreateAddressModal())})("onSelected",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.handleSelectAddress(o))})("isOpenChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.isOpenChangeAddressModal=o)}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("selectedAddress",t.selectedReceiver||null)("addressList",t.shippingAddrs)("isOpen",t.isOpenChangeAddressModal)}}let De=(()=>{class i extends N.c{constructor(t,n,o,a,C,p,f,y,T,M,Ye,je,Ge,ze){super(t,n),this.route=o,this.cartService=a,this.userService=C,this.voucherService=p,this.checkoutService=f,this.productService=y,this.toast=T,this.router=M,this.location=Ye,this.biddingService=je,this.i18n=Ge,this.freeGiftService=ze,this.payMethodId="52",this.isOpenEditAddressModal=!1,this.isOpenBalanceModal=!1,this.isOpenChangeAddressModal=!1,this.isOpenDepositModal=!1,this.selectedItems={},this.pointStatistic=null,this.cartList=[],this.originalCartList=null,this.userInfo=null,this.shippingAddrs=null,this.selectedAddress=null,this.currAddress=null,this.orderSum=null,this.paymentType=l.Lt,this.isOpenProfileModal=!1,this.stores=[],this.productList=[],this.paymentMethodsEnum=l.Lt,this.selectedPlatformCode=this.paymentType.BALANCE,this.isOpenOutOfStock=!1,this.isAuthModalShown=!1,this.isShown=!1,this.isShowDomesticPaymentMethods=!1,this.isWechat=!1,this.isFromCart=!1,this.isFromPrize=!1,this.isFromFreeGift=!1,this.isLoadingClaimPrize=!1}ngOnInit(){var t=this;return(0,m.Z)(function*(){t.isWechat=(0,J.IS)(),B.Z.isServer||(t.route.queryParams.pipe((0,v.R)(t.destroyStream$)).subscribe(n=>{"true"==n.fromCart||"true"==n.fromPrize?(t.isFromCart="true"==n.fromCart,t.isFromPrize="true"==n.fromPrize,t.selectedItems=JSON.parse(decodeURIComponent(atob(n.o))),console.log(898898,t.selectedItems),t.filterCartList()):"true"==n.fromFreeGift?(t.isFromFreeGift=!1,t.cartList=JSON.parse(decodeURIComponent(atob(n.o)))):(t.isFromCart=!1,t.productList=JSON.parse(decodeURIComponent(atob(n.o))),t.reorderProduct())}),"true"==t.route.snapshot.queryParams.fromCart&&(t.isFromCart=!0,t.cartService.cartList$.pipe((0,v.R)(t.destroyStream$)).subscribe(n=>{t.originalCartList=n,t.filterCartList()})),"true"==t.route.snapshot.queryParams.fromPrize&&(t.isFromPrize=!0,t.biddingService.myPrizes$.pipe((0,v.R)(t.destroyStream$)).subscribe(n=>{t.originalCartList=n,console.log(n),t.filterCartList()})),"true"==t.route.snapshot.queryParams.fromFreeGift&&(t.isFromFreeGift=!0,t.cartList=JSON.parse(decodeURIComponent(atob(t.route.snapshot.queryParams.o)))),t.userService.pointStatistic$.pipe((0,v.R)(t.destroyStream$)).subscribe(n=>{t.pointStatistic=n}),t.userService.userInfo$.pipe((0,v.R)(t.destroyStream$)).subscribe(n=>{t.userInfo=n}),yield t.getShippingAddress())})()}get productOrder(){return this.productList instanceof Array?this.productList.reduce((t,n)=>(t.push(...n.productOrder.map(o=>({skuId:o.skuId,quantity:o.quantity}))),t),[]):[]}get selectedReceiver(){if(this.receiverId)return this.shippingAddrs.find(t=>Object.is(t.id,this.receiverId))}reorderProduct(){var t=this;return(0,m.Z)(function*(){t.productService.getSkuById(t.productOrder.map(n=>n.skuId)).pipe().subscribe(n=>{t.productList.forEach(a=>{a.productOrder.forEach(C=>{const p=n.find(y=>Object.is(y.id,C.skuId));if(!p)return;const f=JSON.parse(p.specificationValues||"[]");Object.assign(C,{...p,productImages:[{thumbnail:C.cover}],skuPrice:p.price,skuStock:p.stock,skuSpec:f&&f.length>0?f.reduce((y,T,M)=>`${y+T.value}${Object.is(f.length-1,M)?"]":","}`,"["):""})})});const o=[];t.productList[0].productOrder.forEach(a=>{o.push(a)}),t.productList=o,t.cartList=t.productList,t.getOrderSum()})})()}getShippingAddress(t){var n=this;return(0,m.Z)(function*(){if(n.shippingAddrs=(yield(0,g.n)(n.checkoutService.getShippingAddress()))?.data?.rows||null,n.shippingAddrs?.length){n.selectedAddress=n.shippingAddrs[n.shippingAddrs.length-1];const o=n.shippingAddrs.find(a=>a.isDefault)||n.shippingAddrs[0];if(t)return void(n.receiverId=n.shippingAddrs[n.shippingAddrs.length-1].id);n.receiverId=n.editAddressId?n.editAddressId:o.id}n.getOrderSum()})()}showVerification(){this.isShown=!0}goCart(){this.isShown=!1,setTimeout(()=>{this.router.navigate(["/cart"])},500)}getOrderSumPrize(){this.orderSum={isIdentify:!1,isOpenUpDomesticPaymentMethods:!1,originalPrice:0,toTalTQC:0,totalSumDiscount:0,totalSumFreight:0,totalSumPoint:0,totalSumPrice:0,totalSumQuantity:1}}getOrderSum(){var t=this;return(0,m.Z)(function*(){t.isFromPrize||t.isFromFreeGift?t.getOrderSumPrize():!t.cartList?.length||!t.selectedReceiver||(t.orderSum=yield(0,g.n)(t.checkoutService.getOrderSum({address:t.selectedReceiver?.address||"",areaId:t.selectedReceiver?.areaId||"0",productOrder:t.cartList?.map(n=>({skuId:n.skuId,quantity:n.quantity}))||[],useBalance:!1,usePoint:!1,receiverId:t.selectedReceiver?.id||"0"})),console.log(t.orderSum),t.orderSum.isIdentify&&(t.isAuthModalShown=!0),t.isShowDomesticPaymentMethods=t.orderSum.isOpenUpDomesticPaymentMethods)})()}get idField(){return this.isFromPrize||this.isFromFreeGift?"id":"cartItemId"}filterCartList(){var t=this;return(0,m.Z)(function*(){if(!t.isFromCart&&!t.isFromPrize)return;if(!t.originalCartList||!t.selectedItems)return void(t.cartList=[]);const n=t.originalCartList?.filter(p=>t.selectedItems[p[t.idField]])||null;let o=n.map(p=>p.skuId);const C=(yield(0,g.n)(t.productService.getSkuById(o||[]))).reduce((p,f)=>(p[f.id]=f,p),{});t.cartList=n.map(p=>({...p,...C[p.skuId]||{}})),t.getOrderSum()})()}identify(t,n){return n[this.idField]}openEditAddressModal(){this.currAddress=this.selectedReceiver,this.isOpenEditAddressModal=!0}openCreateAddressModal(){this.currAddress=null,this.isCreateAddress=!0,this.isOpenEditAddressModal=!0}handleSubmitAddressSuccess(){var t=this;return(0,m.Z)(function*(){if(t.isCreateAddress)return yield t.getShippingAddress(!0),yield t.getOrderSum(),t.isOpenEditAddressModal=!1,void(t.isCreateAddress=!1);t.editAddressId=t.receiverId,yield t.getShippingAddress(),t.isOpenEditAddressModal=!1,t.editAddressId=""})()}handleSelectAddress(t){this.receiverId=t.id,this.getOrderSum()}get showReceiver(){return this.cartList?.some(t=>[k.k.ShopProductTypeByGeneral,k.k.ShopProductTypeByExchange,k.k.ShopProductTypeByGiftP].includes(t.productType))}get productOrderDetail(){return this.stores.reduce((t,n)=>(t.push(...n.productOrder.map(o=>({skuId:o.skuId,quantity:o.quantity,productName:o.productName,cover:o.cover}))),t),[])}handleClaimPrizes(){var t=this;return(0,m.Z)(function*(){if(t.userInfo?.email&&t.userInfo?.mobile)if(t.selectedReceiver){t.isLoadingClaimPrize=!0;try{let n;t.isFromPrize?n=yield(0,g.n)(t.biddingService.claimProductByTickets(t.cartList[0]?.groupBuyingId,t.receiverId)):t.isFromFreeGift&&(n=yield(0,g.n)(t.freeGiftService.claimFreeGift(t.cartList[0]?.id,parseInt(t.receiverId)))),0==n.code?(t.userService.updateUserInfo(),t.biddingService.getPrizes().subscribe(),t.router.navigate(["/order/claim-success"])):t.toastError(n.message)}catch(n){console.log(n),t.toastError(n.message)}t.isLoadingClaimPrize=!1}else{const n=t.i18n.instant((t.shippingAddrs?.length||0)<3?"add-address-warning":"select-address-warning");t.toastError(n)}else t.isOpenProfileModal=!0})()}handlePayUsingBalanceClick(t){if(this.userInfo?.email&&this.userInfo?.mobile)if(!this.showReceiver||this.selectedReceiver)t==this.paymentMethodsEnum.BALANCE&&this.orderSum?.totalSumPrice-(this.userInfo?.balance||0)>0||t==this.paymentMethodsEnum.CRYPTO?this.isOpenDepositModal=!0:this.changePaymentMethods(t);else{const o=this.i18n.instant((this.shippingAddrs?.length||0)<3?"add-address-warning":"select-address-warning");this.toastError(o)}else this.isOpenProfileModal=!0}changePaymentMethods(t){if(!this.showReceiver||this.selectedReceiver)switch(this.selectedPaymentMethod=t,t){case l.Lt.BALANCE:this.selectedPaymentMethods=l.mJ.BALANCE;break;case l.Lt.CARD:this.selectedPaymentMethods=l.mJ.CARD;break;case l.Lt.CRYPTO:this.selectedPaymentMethods=l.mJ.CRYPTO}else this.openCreateAddressModal()}payWithCard(){this.selectedPlatformCode=this.paymentMethodsEnum.CARD,this.confirmOrder()}payWithCrypto(){this.selectedPlatformCode=this.paymentMethodsEnum.CRYPTO,this.confirmOrder()}payWithDomestic(){this.selectedPlatformCode=this.paymentMethodsEnum.DOMESTIC,this.confirmOrder()}confirmOrder(){var t=this;return(0,m.Z)(function*(){const n=yield(0,g.n)(t.checkoutService.lockOrder({shippingMethodId:"1",receiverId:t.selectedReceiver?.id||"0",payMethodId:t.payMethodId,fapiao:null,productOrder:t.cartList?.map(o=>({skuId:o.skuId,quantity:o.quantity}))||[],usePoint:!1,useBalance:t.selectedPaymentMethod===l.Lt.BALANCE,memo:""}));try{0===n.code?(console.log(n),0===n.code?(t.sn=n.data,t.queryLockOrder()):1001035===n.code||1001036===n.code||1001037===n.code?t.isAuthModalShown=!0:t.toastError(n?.message)):t.toastError(n?.message)}catch{}})()}queryLockOrder(){var t=this;return(0,m.Z)(function*(){clearTimeout(t.queryLockOrderSetTimeout);const n=yield(0,g.n)(t.checkoutService.queryLockOrder(t.sn));try{if(n)switch(console.log(n),n.data.status){case l.g1.Pending:t.queryLockOrderSetTimeout=setTimeout(()=>{t.queryLockOrder()},2e3);break;case l.g1.Success:t.submitLockOrder(n.data.id.toString());break;case l.g1.Fail:t.querysubmitOrder()}}catch(o){t.toastError(o?.message)}})()}querysubmitOrder(){var t=this;return(0,m.Z)(function*(){const n=yield(0,g.n)(t.checkoutService.querySubmitOrder(t.sn));n&&(t.isOpenOutOfStock=!0,t.outOfStockData=n.data,t.outOfReturnData=t.cartList,console.log(t.outOfReturnData))})()}submitLockOrder(t){var n=this;return(0,m.Z)(function*(){console.log(t);const o=yield(0,g.n)(n.checkoutService.submitLockOrder({sn:n.sn}));try{0==o.code&&(yield n.lockOrderPayment(t))}catch(a){n.toastError(a?.message)}})()}lockOrderPayment(t){var n=this;return(0,m.Z)(function*(){switch(n.selectedPaymentMethod){case l.Lt.BALANCE:const o=yield(0,g.n)(n.checkoutService.balancePayment({orderId:t}));switch(0!==o.code&&n.toastError(o?.message),o.code){case 0:yield(0,g.n)(n.cartService.getCartItem()),n.cartService.refresh=!0,n.userService.updateUserInfo(),n.toastSuccess("\u652f\u4ed8\u6210\u529f"),n.router.navigate(["/order/success"]);break;case 1008013:n.userService.updateUserInfo(),n.isOpenBalanceModal=!0;break;case 1008028:case 1008027:n.router.navigate(["/member/order/detail"],{queryParams:{id:t},replaceUrl:!0});break;case 4001013:case 1008015:n.router.navigate(["/order/success"],{replaceUrl:!0})}break;case l.Lt.CARD:n.methodsCard.confirm(t,l.ri.ORDER);break;case l.Lt.CRYPTO:n.methodsCrypto.confirm(t,l.ri.ORDER);break;case l.Lt.DOMESTIC:n.methodsDomestic.confirm(t,l.ri.ORDER)}})()}toastError(t){var n=this;return(0,m.Z)(function*(){yield n.presentToast({position:"bottom",message:t,icon:"alert-circle-outline",duration:1e3,color:"danger"})})()}toastSuccess(t){var n=this;return(0,m.Z)(function*(){yield n.presentToast({position:"bottom",message:t,duration:1e3,icon:"checkmark-circle-outline",color:"success"})})()}presentToast(t){var n=this;return(0,m.Z)(function*(){yield(yield n.toast.create(t)).present()})()}get profileModalContent(){return`\u8bf7\u5148\u7ed1\u5b9a${this.userInfo?.phone?"":"\u624b\u673a\u53f7"}${this.userInfo?.phone||this.userInfo?.email?"":"\u548c"}${this.userInfo?.email?"":"\u90ae\u7bb1"}`}onCloseAll(){this.router.navigated?this.location.back():this.router.navigate(["/"],{replaceUrl:!0})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(_.gz),e.Y36(A.N),e.Y36(L.K),e.Y36(D.H),e.Y36(R.Z),e.Y36(Q.s),e.Y36(c.yF),e.Y36(_.F0),e.Y36(u.Ye),e.Y36(Y.g),e.Y36(h.sK),e.Y36(j.d))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-checkout-confirm"]],viewQuery:function(t,n){if(1&t&&(e.Gf(he,5),e.Gf(ge,5),e.Gf(fe,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.methodsCard=o.first),e.iGM(o=e.CRH())&&(n.methodsCrypto=o.first),e.iGM(o=e.CRH())&&(n.methodsDomestic=o.first)}},features:[e.qOj],decls:19,vars:18,consts:[["scrollTop","","fullscreen","true","scrollEvents","true","backToTopBtn","",3,"ionScroll"],["appOverflowVisible","",1,"sticky","top-0","shadow-lg","z-50","md:hidden"],["header",""],[3,"hideCart","hideSearch","hideLogo","hidePageName"],["class","grey-bg md:pt-4",4,"ngLet"],["paymentMethod",""],[3,"currAddress","isOpen","onSuccess","isOpenChange",4,"ngIf"],[3,"selectedAddress","addressList","isOpen","addNewAddress","onSelected","isOpenChange",4,"ngIf"],[3,"isOpen","isOpenChange"],[3,"modalContent","isOpen","isOpenChange"],[3,"isOpen","res","getData","isOpenChange"],[1,"grey-bg","md:pt-4"],["class","tyqoon-container h-full flex flex-col",4,"ngIf"],[1,"tyqoon-container","h-full","flex","flex-col"],[1,"flex","flex-wrap"],[1,"w-full","lg:w-8/12","lg:pr-4","my-2"],[1,"px-2","md:px-4","pt-4","pb-0","md:pb-4","md:rounded-xl","md:bg-white"],[1,"font-medium","text-2xl","hidden","md:flex","items-center"],[1,"border-b","border-[#dddddd]","mt-4","mb-2","hidden","md:block"],["class","mb-2 -mx-2 md:-mx-4 block bg-white",3,"readonly","cartItem",4,"ngFor","ngForOf","ngForTrackBy"],["class","border-b border-[#dddddd] my-4 hidden md:block",4,"ngIf"],["class","hidden md:flex items-center text-2xl font-medium flex-wrap",4,"ngIf"],[1,"px-2","md:px-4","py-4","md:rounded-xl","bg-white","mt-4","mb-10"],[1,"font-medium","text-2xl","flex","justify-center","md:justify-start","items-center"],[1,"mr-2"],["viewBox","0 0 12 16",1,"fill-[#3387FF]","icon-location-marker","h-6"],["d","M6 3.2c1.506 0 2.727 1.195 2.727 2.667 0 1.473-1.22 2.666-2.727 2.666S3.273 7.34 3.273 5.867C3.273 4.395 4.493 3.2 6 3.2zM0 6c0-3.315 2.686-6 6-6s6 2.685 6 6c0 2.498-1.964 5.742-6 9.933C1.613 11.743 0 8.498 0 6z","fill-rule","evenodd"],[1,"border-b","border-[#dddddd]","my-4"],[1,"flex"],[1,"w-10/12","sm:w-8/12"],[4,"ngIf","ngIfElse"],["noAddress",""],[1,"w-2/12","sm:w-4/12"],[1,"w-full","rounded-md","bg-[#dddddd]","py-3","mb-2","flex","justify-center","sm:justify-start","items-center","px-2",3,"disabled","click"],["src","assets/images/address-icon-edit.png","alt","",1,"h-4"],[1,"flex-1","text-center","font-bold","hidden","sm:block"],["src","assets/images/address-change.png","alt","",1,"h-4"],[1,"flex-1","font-bold","text-center","hidden","sm:block"],[1,"w-full","rounded-md","bg-[#dddddd]","py-3","flex","justify-center","sm:justify-start","items-center","px-2",3,"ngClass","click"],[1,"text-3xl","font-extrabold","leading-4"],[1,"w-full","lg:w-4/12","my-2"],[1,"px-2","md:px-4","py-4","md:rounded-xl","bg-white","mb-4","lg:sticky","top-4"],[1,"flex","items-center","justify-center","md:justify-end","mt-2"],[1,"mb-2","-mx-2","md:-mx-4","block","bg-white",3,"readonly","cartItem"],[1,"border-b","border-[#dddddd]","my-4","hidden","md:block"],[1,"hidden","md:flex","items-center","text-2xl","font-medium","flex-wrap"],[1,"flex","items-center"],[1,"yellow"],["src","assets/images/circle-credit-small.png","alt","",1,"ml-2","h-6"],[1,"text-primary","font-medium","text-lg"],[1,"opacity-50"],[1,"text-center"],["src","assets/images/no-address-found.png","alt","",1,"h-24","opacity-10","m-auto","mb-2"],[1,"opacity-70"],[1,"flex","justify-between"],[1,"text-center","text-2xl","font-medium"],[1,"text-center","text-2xl"],[1,"border-b","border-[#dddddd]","my-1.5","md:my-4"],[1,"flex","justify-between","mb-2"],[1,"font-medium","opacity-60","text-base","sm:text-xl"],[1,"text-lg","sm:text-2xl","opacity-70","font-bold","whitespace-nowrap"],["class","free-shipping font-bold whitespace-nowrap bg-yellow-400 text-white px-2 sm:py-0.5 rounded-md",4,"ngIf","ngIfElse"],["freight",""],["class","flex justify-between mb-2",4,"ngIf"],[1,"font-medium","text-xl","sm:text-3xl"],[1,"text-2xl","sm:text-3xl","font-medium","whitespace-nowrap"],[1,"border-b","border-[#dddddd]","mt-1.5","mb-3","md:!my-4"],[1,"text-center","text-xl","font-medium","mb-2"],["claimPrizesBtn",""],[1,"free-shipping","font-bold","whitespace-nowrap","bg-yellow-400","text-white","px-2","sm:py-0.5","rounded-md"],[3,"text"],[1,"text-lg","sm:text-2xl","yellow","font-bold","whitespace-nowrap","flex","items-center"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center","mb-2",3,"click"],[1,"flex-1","xs:ml-2"],[1,"text-base"],[1,"font-bold","text-2xl","leading-7"],[1,"cavet","mr-2","hidden","xs:block"],["class","w-full bg-gradient-primary p-1.5 text-center text-white rounded-md flex items-center",3,"click",4,"ngIf"],[1,"w-full","bg-gradient-primary","p-1.5","text-center","text-white","rounded-md","flex","items-center",3,"click"],[1,"flex","justify-center","items-center","h-7","overflow-hidden"],["src","assets/images/payment-wechatpay-white-min.png","alt","",1,"h-6","flex-shrink"],["src","assets/images/payment-vise-master-amex-min.png","alt","",1,"h-6","flex-shrink"],[1,"w-full","bg-gradient-primary","py-3","text-center","text-white","rounded-md","text-3xl","font-medium",3,"disabled","click"],[1,"flex","mb-2"],[1,"flex","items-center","bg-[#dddddd]","rounded","py-1","px-2","cursor-pointer",3,"click"],[1,"back-cavet","mr-2","font-medium"],[3,"amount","confirm",4,"ngIf"],[3,"amount","select",4,"ngIf"],[3,"amount","select","onCloseAll","onRetry",4,"ngIf"],[3,"amount","confirm"],[3,"amount","select"],["methodsCrypto",""],[3,"amount","select","onCloseAll","onRetry"],["methodsCard",""],["methodsDomestic",""],[3,"currAddress","isOpen","onSuccess","isOpenChange"],[3,"selectedAddress","addressList","isOpen","addNewAddress","onSelected","isOpenChange"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0),e.NdJ("ionScroll",function(a){return n.onContentScroll(a)}),e._UZ(1,"app-global-customer-service"),e.TgZ(2,"ion-toolbar",1,2),e._UZ(4,"app-top-navbar",3)(5,"app-top-menu"),e.qZA(),e.YNc(6,Le,2,1,"div",4),e.ALo(7,"async"),e._UZ(8,"app-new-year-dragons"),e.qZA(),e.YNc(9,Ne,10,7,"ng-template",null,5,e.W1O),e.YNc(11,Be,1,2,"app-edit-address-modal",6),e.YNc(12,Je,1,3,"app-change-address-modal",7),e.TgZ(13,"app-deposit-credit-modal",8),e.NdJ("isOpenChange",function(a){return n.isOpenDepositModal=a}),e.qZA(),e.TgZ(14,"app-bind-email-phone-modal",9),e.NdJ("isOpenChange",function(a){return n.isOpenProfileModal=a}),e.qZA(),e.TgZ(15,"app-insufficient-balance-modal",8),e.NdJ("isOpenChange",function(a){return n.isOpenBalanceModal=a}),e.qZA(),e.TgZ(16,"app-out-of-stock",10),e.NdJ("isOpenChange",function(a){return n.isOpenOutOfStock=a}),e.qZA(),e.TgZ(17,"app-verify-name",8),e.NdJ("isOpenChange",function(a){return n.isAuthModalShown=a})("isOpenChange",function(){return n.showVerification()}),e.qZA(),e.TgZ(18,"app-verification-modal",8),e.NdJ("isOpenChange",function(a){return n.isShown=a})("isOpenChange",function(){return n.goCart()}),e.qZA()),2&t&&(e.xp6(4),e.Q6J("hideCart",!0)("hideSearch",!0)("hideLogo",!0)("hidePageName",!1),e.xp6(2),e.Q6J("ngLet",e.lcZ(7,16,n.biddingService.isBiddingMode$)),e.xp6(5),e.Q6J("ngIf",n.isOpenEditAddressModal),e.xp6(1),e.Q6J("ngIf",n.isOpenChangeAddressModal),e.xp6(1),e.Q6J("isOpen",n.isOpenDepositModal),e.xp6(1),e.Q6J("modalContent",n.profileModalContent)("isOpen",n.isOpenProfileModal),e.xp6(1),e.Q6J("isOpen",n.isOpenBalanceModal),e.xp6(1),e.Q6J("isOpen",n.isOpenOutOfStock)("res",n.outOfStockData)("getData",n.outOfReturnData),e.xp6(1),e.Q6J("isOpen",n.isAuthModalShown),e.xp6(1),e.Q6J("isOpen",n.isShown))},dependencies:[G.N,z.t,H.v,K.F,u.mk,u.sg,u.O5,V.V,$.H,W.B,X.Z,ne,ie,re.E,se.h,ae.Y,c.W2,c.sr,S.n,U.c,I.u,b,Z,q.P,ce.p,de.z,le.h,_e,u.Ov,u.H9,h.X$],styles:["ion-content[_ngcontent-%COMP%]{--background: #F8F8F8}.yellow[_ngcontent-%COMP%]{color:#f8ae02}.yellow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#f8ae02}.cavet[_ngcontent-%COMP%]{width:16px;height:16px;border-top:3px solid white;border-right:3px solid white;transform:rotate(45deg)}.address-btn[_ngcontent-%COMP%]{background-color:#fbdf45}button[disabled][_ngcontent-%COMP%]{opacity:.3}ion-toolbar[appOverflowVisible][_ngcontent-%COMP%]{contain:none}app-top-back-button[_ngcontent-%COMP%]{cursor:pointer}app-top-back-button[_ngcontent-%COMP%]     svg{height:36px}.back-cavet[_ngcontent-%COMP%]{width:12px;height:12px;border-top:3px solid black;border-right:3px solid black;transform:rotate(-135deg)}button.bg-gradient-primary[disabled][_ngcontent-%COMP%]{opacity:.3;background:black;color:#fff}.free-shipping[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1.75rem}@media (min-width: 640px){.free-shipping[_ngcontent-%COMP%]{font-size:22px}}"]}),i})();var Re=s(1241);let Qe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[E.g,u.ez,F.m,c.Pc,h.aw,S.n,U.c,I.u,b,Z,q.P,_.Bz.forChild([{path:"",component:De}]),Re.x]}),i})()},45210:(P,x,s)=>{s.d(x,{B:()=>h});var u=s(15861),_=s(24837),c=s(94650);let h=(()=>{class e{constructor(d){this.el=d,this.myValue=!0,this.content=d.nativeElement}ngAfterViewInit(){var d=this;return(0,u.Z)(function*(){_.Z.isServer||(d.btn=document.createElement("button"),d.btn.innerHTML='\n    <svg class="icon__arrow-up" viewBox="0 0 24 24">\n      <title>Back to top</title>\n      <path d="M18.71,11.71a1,1,0,0,1-1.42,0L13,7.41V19a1,1,0,0,1-2,0V7.41l-4.29,4.3a1,1,0,0,1-1.42-1.42l6-6a1,1,0,0,1,1.42,0l6,6A1,1,0,0,1,18.71,11.71Z"/>\n    </svg>',d.btn.classList.add("back-to-top-btn"),d.btn.addEventListener("click",()=>{d.content.scrollToTop(500)}),document.body.appendChild(d.btn),d.el.nativeElement.append(d.btn))})()}onScroll(d){d.detail.scrollTop>200?this.btn.classList.add("show-btn"):this.btn.classList.remove("show-btn")}}return e.\u0275fac=function(d){return new(d||e)(c.Y36(c.SBq))},e.\u0275dir=c.lG2({type:e,selectors:[["","backToTopBtn",""]],hostVars:1,hostBindings:function(d,b){1&d&&c.NdJ("ionScroll",function(Z){return b.onScroll(Z)}),2&d&&c.Ikx("overflow-scroll",b.myValue)}}),e})()}}]);