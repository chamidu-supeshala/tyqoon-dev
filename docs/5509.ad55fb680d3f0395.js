"use strict";(self.webpackChunkangular_tyqoon_client=self.webpackChunkangular_tyqoon_client||[]).push([[5509],{85898:(W,y,i)=>{i.d(y,{b:()=>F});var c=i(15861),f=i(77579),u=i(82722),_=i(59468),t=i(49808),h=i(24837),S=i(95133),x=i(54463),v=i(36895),E=i(44466),O=i(59809),w=i(5565),R=i(18110),r=i(94650),I=i(35482),T=i(94830),P=i(56889),A=i(23284),C=i(90147);function B(l,m){if(1&l&&r._UZ(0,"app-product-card",5),2&l){const n=m.$implicit,p=r.oxw().ngLet,M=r.oxw().ngLet;r.Q6J("product",n)("isBiddingMode",!!p)("isLogin",!!M)}}function Z(l,m){1&l&&r._UZ(0,"app-product-card-skeleton",7)}const D=function(){return[]};function L(l,m){if(1&l&&(r.ynx(0),r.YNc(1,Z,1,0,"app-product-card-skeleton",6),r.BQk()),2&l){const n=r.oxw(3);r.xp6(1),r.Q6J("ngForOf",r.DdM(2,D).constructor(n.pageSize).fill(1))("ngForTrackBy",n.trackByFn2)}}function b(l,m){if(1&l&&(r.TgZ(0,"div",2),r.YNc(1,B,1,3,"app-product-card",3),r.YNc(2,L,2,3,"ng-container",4),r.qZA()),2&l){const n=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",n.products)("ngForTrackBy",n.trackByFn),r.xp6(1),r.Q6J("ngIf",n.isLoading)}}function U(l,m){if(1&l&&(r.TgZ(0,"div"),r.YNc(1,b,3,3,"div",1),r.ALo(2,"async"),r.qZA()),2&l){const n=r.oxw();r.xp6(1),r.Q6J("ngLet",r.lcZ(2,1,n.biddingService.isBiddingMode$))}}let F=(()=>{class l extends w.V{constructor(n,p,M,K){super(),this.productService=n,this.userService=p,this.biddingService=M,this.cdr=K,this.pageSize=20,this.offsetScroll=2e3,this.additionalParams={},this.isSSR=!1,this.biddingProductsSortOrder=0,this.throttleScroll=new f.x,this.page=-1,this.isLoading=!1,this.total=0,this.products=[],this.isBiddingMode=!1}ngOnInit(){console.log(8787878,this.biddingProductsSortOrder),!this.isSSR&&h.Z.isServer?this.isLoading=!0:this.biddingService.isBiddingMode$.pipe((0,u.R)(this.destroyStream$)).subscribe(n=>{this.isBiddingMode=n,this.refreshProducts()})}ngAfterViewInit(){var n=this;return(0,c.Z)(function*(){h.Z.isServer||n.scrollContainer&&(n.scrollElement=yield n.scrollContainer.getScrollElement(),n.scrollContainer.ionScroll.pipe((0,u.R)(n.destroyStream$)).subscribe(p=>{n.scrollElement.scrollHeight-p.detail.scrollTop<n.offsetScroll&&n.throttleScroll.next(1)}),n.throttleScroll.pipe((0,_.p)(300),(0,u.R)(n.destroyStream$)).subscribe(()=>{n.fetchData()}))})()}ngOnChanges(n){}refreshProducts(){this.page=-1,this.total=0,this.products=[],this.fetchData()}fetchData(){var n=this;return(0,c.Z)(function*(){if(!n.isLoading&&(-1===n.page||n.products.length<n.total)){n.isLoading=!0,n.page++,n.cdr.markForCheck();const p=n.isBiddingMode?yield(0,t.n)(n.biddingService.getProductsWithPoolInfo({page:n.page,rows:n.pageSize,sortType:n.biddingProductsSortOrder,isRecommended:!0,...n.additionalParams})):yield(0,t.n)(n.productService.getProductsByMetaParamsV2({page:n.page,rows:n.pageSize,traceId:n.userService.traceId,isRecommended:!0,...n.additionalParams}));console.log(p),p.rows=(0,R.DI)(p.rows||[]),n.products=[...n.products,...p.rows||[]],n.total=p.total,n.isLoading=!1,n.cdr.markForCheck()}})()}clear(){this.page=-1,this.isLoading=!1,this.total=0,this.products=[]}trackByFn(n,p){return p.id}trackByFn2(n){return n}}return l.\u0275fac=function(n){return new(n||l)(r.Y36(I.s),r.Y36(T.K),r.Y36(P.g),r.Y36(r.sBO))},l.\u0275cmp=r.Xpm({type:l,selectors:[["app-products-infinite-scroll"]],inputs:{pageSize:"pageSize",scrollContainer:"scrollContainer",offsetScroll:"offsetScroll",additionalParams:"additionalParams",isSSR:"isSSR",biddingProductsSortOrder:"biddingProductsSortOrder"},standalone:!0,features:[r.qOj,r.TTD,r.jDz],decls:2,vars:3,consts:[[4,"ngLet"],["class","grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-x-2 gap-y-6",4,"ngLet"],[1,"grid","grid-cols-2","xs:grid-cols-3","sm:grid-cols-4","md:grid-cols-5","lg:grid-cols-6","gap-x-2","gap-y-6"],["class","block",3,"product","isBiddingMode","isLogin",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"block",3,"product","isBiddingMode","isLogin"],["class","block",4,"ngFor","ngForOf","ngForTrackBy"],[1,"block"]],template:function(n,p){1&n&&(r.YNc(0,U,3,3,"div",0),r.ALo(1,"async")),2&n&&r.Q6J("ngLet",r.lcZ(1,1,p.userService.userInfo$))},dependencies:[x.aw,v.ez,v.sg,v.O5,v.Ov,S.Pc,E.m,A.Y,C.h,O.I],changeDetection:0}),l})()},65509:(W,y,i)=>{i.r(y),i.d(y,{MartModule:()=>Q});var c=i(36895),f=i(7507),u=i(24499);const _=[{name:"mart-fresh-groceries",icon:"/assets/images/mart-fresh-groceries.png",activityId:"70833251"},{name:"category-beautiy-health",icon:"/assets/images/mart-category-beauty-min.png",activityId:"49845326"},{name:"category-FOOD-&-DINING",icon:"/assets/images/mart-category-food-min.png",activityId:"49846331"},{name:"mart-health-wellness",icon:"/assets/images/mart-category-health-min.png",activityId:"49846966"},{name:"mart-home-living",icon:"/assets/images/mart-category-home-living-min.png",activityId:"49847602"},{name:"mart-kids-babies",icon:"/assets/images/mart-category-kids-min.png",activityId:"49848814"}];var t=i(94650),h=i(95133),S=i(85898),x=i(81152),v=i(46032),E=i(8136),O=i(49127),w=i(45210),R=i(18215),r=i(54463);const I=function(o){return{activityId:o}};let T=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mart-category"]],inputs:{martCategory:"martCategory"},decls:6,vars:9,consts:[[1,"mart-category","flex","flex-col","items-center","justify-center","mx-2",3,"routerLink","queryParams"],[1,"mart-category__icon","rounded-full","mb-2"],[3,"src","alt"],[1,"mart-category__name","text-white","text-center"]],template:function(e,s){1&e&&(t.TgZ(0,"a",0)(1,"div",1),t._UZ(2,"img",2),t.qZA(),t.TgZ(3,"p",3),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&e&&(t.Q6J("routerLink","/product/search")("queryParams",t.VKq(7,I,s.martCategory.activityId)),t.xp6(2),t.Q6J("src",s.martCategory.icon,t.LSH)("alt",s.martCategory.name),t.xp6(2),t.hij(" ",t.lcZ(5,5,s.martCategory.name)," "))},dependencies:[f.yS,h.Fo,r.X$],styles:[".mart-category__icon[_ngcontent-%COMP%]{width:67px;height:67px;box-shadow:0 4px 16px #4a4af8}@media (min-width: 1024px){.mart-category__icon[_ngcontent-%COMP%]{width:77px;height:77px}}.mart-category__name[_ngcontent-%COMP%]{width:67px;font-size:11px;line-height:1.25}@media (min-width: 1024px){.mart-category__name[_ngcontent-%COMP%]{width:77px;font-size:12.5px}}"]}),o})();var P=i(24837),A=i(54968),C=i(99485);const B=["swiper"];function Z(o,d){if(1&o&&t._UZ(0,"app-mart-category",6),2&o){const e=t.oxw().$implicit;t.Q6J("martCategory",e)}}function D(o,d){1&o&&t.YNc(0,Z,1,1,"ng-template",5)}const L=function(o){return{"is-swiping":o}};function b(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",1),t.NdJ("touchstart",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleElementTouch())}),t.TgZ(1,"swiper",2,3),t.NdJ("init",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleInit())})("breakpoint",function(a){t.CHM(e);const g=t.oxw();return t.KtG(g.handleBreakPointChange(a))})("mouseenter",function(a){t.CHM(e);const g=t.oxw();return t.KtG(g.handleMouseEnter(a))})("mouseleave",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleMouseLeave())})("touchEnd",function(a){t.CHM(e);const g=t.oxw();return t.KtG(g.handleTouchEnd(a))})("transitionEnd",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.handleTransitionEnd())}),t.YNc(3,D,1,0,null,4),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(3,L,e.isSwiping))("config",e.slideOpts),t.xp6(2),t.Q6J("ngForOf",e.categories)}}let U=(()=>{class o{constructor(){this.categories=_,this.isInitalize=!1,this.slideOpts={speed:2e4,freeMode:!0,loop:!0,autoplay:!1,slidesPerView:"auto",breakpoints:{340:{speed:2e4},640:{speed:2e4}}},this.oneRoundWidth=0,this.isSwiping=!1,this.isMouseEnter=!1,this.handleTransitionEnd=()=>{if(this.isInitalize&&!this.isSwiping&&!this.isMouseEnter){const e=this.categorySwiper?.swiperRef,s=e?.getTranslate();s===this.end1RoundPosition?setTimeout(()=>{e?.translateTo(this.initPosition,0,!0,!1)},0):(s<this.end1RoundPosition&&e?.translateTo(this.initPosition+(s-this.end1RoundPosition),0,!1,!1),setTimeout(()=>{e?.translateTo(this.end1RoundPosition,Math.abs(this.end1RoundPosition-e.getTranslate())/this.oneRoundWidth*this.speed1Round,!0,!1)},0))}}}ngOnInit(){}ngOnDestroy(){this.subscription?.unsubscribe()}handleInit(){P.Z.isServer||this.setTranslate()}handleMouseEnter(e){this.isMouseEnter=!0;const s=this.categorySwiper?.swiperRef,a=s?.getTranslate();s?.translateTo(a-10,0,!1,!1)}handleElementTouch(){const e=this.categorySwiper?.swiperRef;this.isMouseEnter=!0;const s=e?.getTranslate();e?.translateTo(s-10,0,!1,!1)}handleTouchStart([e,s]){this.isSwiping=!0}handleTouchEnd([e,s]){this.isSwiping=!1,"mouse"!==s.pointerType&&(this.isMouseEnter=!1);const a=this.categorySwiper?.swiperRef;a&&setTimeout(()=>{const g=a.getTranslate();a.translateTo(g>=this.end1RoundPosition?g:this.initPosition+(g-this.end1RoundPosition),0,!1,!1)},0),setTimeout(()=>{this.resumeSlide()},10)}handleMouseLeave(){this.isMouseEnter=!1,setTimeout(()=>{this.resumeSlide()},10)}resumeSlide(){if(!this.isSwiping&&!this.isMouseEnter){const e=this.categorySwiper?.swiperRef;if(e){const s=e.getTranslate();s>=this.end1RoundPosition||e?.translateTo(this.initPosition+(s-this.end1RoundPosition),0,!1,!1),e.translateTo(this.end1RoundPosition,Math.abs(this.end1RoundPosition-s)/this.oneRoundWidth*this.speed1Round,!0,!1)}}}setTranslate(){setTimeout(()=>{const e=this.categorySwiper?.swiperRef;if(e){const s=e.wrapperEl.querySelector(".swiper-slide");this.oneRoundWidth=(s?.clientWidth||0)*this.categories.length,e.translateTo(this.end1RoundPosition,this.speed1Round,!0,!1),this.isInitalize=!0,this.subscription=(0,A.R)(e.wrapperEl,"transitionend").subscribe(this.handleTransitionEnd)}},2e3)}get speed1Round(){const e=this.categorySwiper?.swiperRef;return e?.params.breakpoints?.[e.currentBreakpoint]?.speed||e?.params.speed||0}get initPosition(){return-this.oneRoundWidth}get end1RoundPosition(){return 2*this.initPosition}handleBreakPointChange([e,s]){setTimeout(()=>{const g=this.categorySwiper?.swiperRef?.wrapperEl.querySelector(".swiper-slide");this.oneRoundWidth=(g?.clientWidth||0)*this.categories.length},100)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mart-category-slider"]],viewQuery:function(e,s){if(1&e&&t.Gf(B,5),2&e){let a;t.iGM(a=t.CRH())&&(s.categorySwiper=a.first)}},decls:1,vars:1,consts:[[3,"touchstart",4,"ngIf"],[3,"touchstart"],[1,"category-swiper",3,"ngClass","config","init","breakpoint","mouseenter","mouseleave","touchEnd","transitionEnd"],["swiper",""],[4,"ngFor","ngForOf"],["swiperSlide",""],[1,"w-full","h-full",3,"martCategory"]],template:function(e,s){1&e&&t.YNc(0,b,4,5,"div",0),2&e&&t.Q6J("ngIf",s.categories)},dependencies:[c.mk,c.sg,c.O5,C.nF,C.YC,T],styles:["swiper[_ngcontent-%COMP%]:not(.is-swiping)     .swiper-wrapper{transition-timing-function:linear!important}swiper[_ngcontent-%COMP%]     .swiper-wrapper{margin-left:-.25rem;margin-right:-.25rem}swiper[_ngcontent-%COMP%]     .swiper-slide{width:87px;padding:8px 4px 0;flex-shrink:0}@media (min-width: 1024px){swiper[_ngcontent-%COMP%]     .swiper-slide{width:97px}}"]}),o})();function F(o,d){1&o&&t._UZ(0,"app-mart-category",8),2&o&&t.Q6J("martCategory",d.$implicit)}let l=(()=>{class o{constructor(e){this.translateService=e,this.categories=_}ngOnInit(){}getTyqoonMartImageSm(){return"cn"===this.translateService.currentLang?"assets/images/tyqoon-mart-cn.png":"assets/images/tyqoon-mart.png"}getTyqoonMartImageLg(){switch(this.translateService.currentLang){case"cn":case"tr":return"assets/images/Tyqoon-mart-logo-cnv2-720px.png";default:return"assets/images/Tyqoon-mart-logo-720px-min.png"}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.sK))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mart-banner"]],decls:9,vars:3,consts:[[1,"mart-banner","w-full"],[1,"tyqoon-container","flex","flex-col","md:flex-row","md:items-center","py-6"],[1,"mart-logo","mb-4","md:mb-0"],["alt","Tyqoon mart mobile logo",1,"sm:hidden","h-full","object-contain",3,"src"],["alt","Tyqoon mart mobile logo",1,"hidden","sm:flex","h-full","object-contain",3,"src"],[1,"hidden","md:flex","flex-auto","justify-center","ml-4"],["class","h-full",3,"martCategory",4,"ngFor","ngForOf"],[1,"flex","md:hidden"],[1,"h-full",3,"martCategory"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"img",3)(4,"img",4),t.qZA(),t.TgZ(5,"div",5),t.YNc(6,F,1,1,"app-mart-category",6),t.qZA(),t.TgZ(7,"div",7),t._UZ(8,"app-mart-category-slider"),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("src",s.getTyqoonMartImageSm(),t.LSH),t.xp6(1),t.Q6J("src",s.getTyqoonMartImageLg(),t.LSH),t.xp6(2),t.Q6J("ngForOf",s.categories))},dependencies:[c.sg,T,U],styles:[".mart-banner[_ngcontent-%COMP%]{background-image:linear-gradient(to right,#0189ff,#013dff)}.mart-banner[_ngcontent-%COMP%]   .mart-logo[_ngcontent-%COMP%]{height:118px}@media (min-width: 640px){.mart-banner[_ngcontent-%COMP%]   .mart-logo[_ngcontent-%COMP%]{height:136px}}@media (min-width: 768px){.mart-banner[_ngcontent-%COMP%]   .mart-logo[_ngcontent-%COMP%]{height:236px}}"]}),o})();const m=function(o){return{isRecommended:!1,activityId:o}},p=[{path:"",component:(()=>{class o extends u.c{constructor(e,s){super(e,s),this.categories=_,this.defaultCategory=_[0].activityId}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.SBq),t.Y36(t.Qsj))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mart"]],features:[t.qOj],decls:12,vars:6,consts:[["fullscreen","true","scrollEvents","true","backToTopBtn","",3,"ionScroll"],["ionContent",""],["appOverflowVisible","",1,"sticky","top-0","shadow-lg","z-50"],["header",""],[3,"forceFullWidthSearch"],[1,"tyqoon-container","min-h-[50vh]","mt-4"],[3,"additionalParams","scrollContainer","isSSR"],[1,"mt-4","md:hidden"]],template:function(e,s){if(1&e&&(t.TgZ(0,"ion-content",0,1),t.NdJ("ionScroll",function(g){return s.onContentScroll(g)}),t._UZ(2,"app-global-customer-service"),t.TgZ(3,"ion-toolbar",2,3),t._UZ(5,"app-top-navbar",4)(6,"app-top-menu"),t.qZA(),t._UZ(7,"app-mart-banner"),t.TgZ(8,"div",5),t._UZ(9,"app-products-infinite-scroll",6),t.qZA()(),t.TgZ(10,"ion-footer",7),t._UZ(11,"app-bottom-navbar"),t.qZA()),2&e){const a=t.MAs(1);t.xp6(5),t.Q6J("forceFullWidthSearch",!0),t.xp6(4),t.Q6J("additionalParams",t.VKq(4,m,s.defaultCategory))("scrollContainer",a)("isSSR",!0)}},dependencies:[h.W2,h.fr,h.sr,S.b,x.p,v.K,E.z,O.H,w.B,R.Z,l]}),o})()}];let M=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[f.Bz.forChild(p),f.Bz]}),o})();var K=i(44466),J=i(1927);let Q=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.ez,M,h.Pc,r.aw,C.kz,S.b,K.m,J.n]}),o})()},59809:(W,y,i)=>{i.d(y,{I:()=>f});var c=i(94650);let f=(()=>{class u{}return u.\u0275fac=function(t){return new(t||u)},u.\u0275cmp=c.Xpm({type:u,selectors:[["app-product-card-skeleton"]],standalone:!0,features:[c.jDz],decls:9,vars:0,consts:[[1,"cursor-pointer","flex","flex-col","w-full","max-w-[246px]","lg:max-w-[220px]","xl:max-w-[245px]"],[1,"relative","w-full","mb-2",2,"padding-top","100%"],[1,"absolute","inset-0","pulSate","rounded-lg"],[1,"product-title","truncate","mb-1","pulSate","text-sm",2,"letter-spacing","20px"],[1,"text-xs","leading-3","text-center","pulSate",2,"letter-spacing","20px"],[1,"text-base","text-center","pulSate",2,"letter-spacing","20px"]],template:function(t,h){1&t&&(c.TgZ(0,"div",0)(1,"div",1),c._UZ(2,"div",2),c.qZA(),c.TgZ(3,"p",3),c._uU(4," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),c.qZA(),c.TgZ(5,"p",4),c._uU(6," \xa0\xa0 "),c.qZA(),c.TgZ(7,"p",5),c._uU(8," \xa0\xa0 "),c.qZA()())}}),u})()}}]);